/*! For license information please see main-fa968b87.a222d6ac0c2bf2a62724.js.LICENSE.txt */
"use strict";(self.webpackChunkpto_request_app=self.webpackChunkpto_request_app||[]).push([[286],{99:(e,r,t)=>{t.d(r,{A:()=>o});var a=t(6540),n=t(4848);function s(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,n,s,l,i=[],o=!0,c=!1;try{if(s=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;o=!1}else for(;!(o=(a=s.call(t)).done)&&(i.push(a.value),i.length!==r);o=!0);}catch(e){c=!0,n=e}finally{try{if(!o&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw n}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return l(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=Array(r);t<r;t++)a[t]=e[t];return a}var i=[{value:"all",label:"All Time"},{value:"current_year",label:"Current Year"},{value:"last_90_days",label:"Last 90 Days"},{value:"last_30_days",label:"Last 30 Days"},{value:"custom",label:"Custom Range"}];const o=function(e){var r=e.value,t=void 0===r?{preset:"all",from:"",to:""}:r,l=e.onChange,o=s((0,a.useState)(t.preset||"all"),2),c=o[0],d=o[1],u=s((0,a.useState)(t.from||""),2),m=u[0],f=u[1],v=s((0,a.useState)(t.to||""),2),h=v[0],p=v[1];return(0,a.useEffect)((function(){l("custom"!==c?{preset:c,from:"",to:""}:{preset:c,from:m,to:h})}),[c,m,h]),(0,n.jsxs)("div",{className:"date-range-filter",children:[(0,n.jsx)("select",{className:"form-control",value:c,onChange:function(e){return d(e.target.value)},children:i.map((function(e){return(0,n.jsx)("option",{value:e.value,children:e.label},e.value)}))}),"custom"===c&&(0,n.jsxs)("div",{className:"custom-range-fields",style:{display:"flex",gap:8,marginTop:8},children:[(0,n.jsx)("input",{type:"date",className:"form-control",value:m,onChange:function(e){return f(e.target.value)},max:h||void 0,placeholder:"From"}),(0,n.jsx)("span",{style:{alignSelf:"center"},children:"to"}),(0,n.jsx)("input",{type:"date",className:"form-control",value:h,onChange:function(e){return p(e.target.value)},min:m||void 0,placeholder:"To"})]})]})}},1098:(e,r,t)=>{t.d(r,{A:()=>n});t(6540);var a=t(4848);const n=function(e){var r=e.message,t=e.type,n=e.onClose;return(0,a.jsx)("div",{className:"fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ".concat("success"===t?"bg-green-500 text-white":"bg-red-500 text-white"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:r}),(0,a.jsx)("button",{onClick:n,className:"ml-4 text-white hover:text-gray-200",children:"√ó"})]})})}},2435:(e,r,t)=>{t.d(r,{A:()=>b});var a=t(6540),n=t(2321),s=t(8697),l=t(4471),i=t(418),o=t(4848);function c(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?c(Object(t),!0).forEach((function(r){u(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function u(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,r||"default");if("object"!=h(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==h(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function m(e){if(null!=e){var r=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],t=0;if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}throw new TypeError(h(e)+" is not iterable")}function f(){var e,r,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function s(t,a,n,s){var o=a&&a.prototype instanceof i?a:i,c=Object.create(o.prototype);return v(c,"_invoke",function(t,a,n){var s,i,o,c=0,d=n||[],u=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(r,t){return s=r,i=0,o=e,m.n=t,l}};function f(t,a){for(i=t,o=a,r=0;!u&&c&&!n&&r<d.length;r++){var n,s=d[r],f=m.p,v=s[2];t>3?(n=v===a)&&(o=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=f&&((n=t<2&&f<s[1])?(i=0,m.v=a,m.n=s[1]):f<v&&(n=t<3||s[0]>a||a>v)&&(s[4]=t,s[5]=a,m.n=v,i=0))}if(n||t>1)return l;throw u=!0,a}return function(n,d,v){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,v),i=d,o=v;(r=i<2?e:o)||!u;){s||(i?i<3?(i>1&&(m.n=-1),f(i,o)):m.n=o:m.v=o);try{if(c=2,s){if(i||(n="next"),r=s[n]){if(!(r=r.call(s,o)))throw TypeError("iterator result is not an object");if(!r.done)return r;o=r.value,i<2&&(i=0)}else 1===i&&(r=s.return)&&r.call(s),i<2&&(o=TypeError("The iterator does not provide a '"+n+"' method"),i=1);s=e}else if((r=(u=m.n<0)?o:t.call(a,m))!==l)break}catch(r){s=e,i=1,o=r}finally{c=1}}return{value:r,done:u}}}(t,n,s),!0),c}var l={};function i(){}function o(){}function c(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(v(r={},a,(function(){return this})),r),u=c.prototype=i.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,v(e,n,"GeneratorFunction")),e.prototype=Object.create(u),e}return o.prototype=c,v(u,"constructor",c),v(c,"constructor",o),o.displayName="GeneratorFunction",v(c,n,"GeneratorFunction"),v(u),v(u,n,"Generator"),v(u,a,(function(){return this})),v(u,"toString",(function(){return"[object Generator]"})),(f=function(){return{w:s,m}})()}function v(e,r,t,a){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}v=function(e,r,t,a){if(r)n?n(e,r,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[r]=t;else{var s=function(r,t){v(e,r,(function(e){return this._invoke(r,t,e)}))};s("next",0),s("throw",1),s("return",2)}},v(e,r,t,a)}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function p(e,r,t,a,n,s,l){try{var i=e[s](l),o=i.value}catch(e){return void t(e)}i.done?r(o):Promise.resolve(o).then(a,n)}function y(e){return function(){var r=this,t=arguments;return new Promise((function(a,n){var s=e.apply(r,t);function l(e){p(s,a,n,l,i,"next",e)}function i(e){p(s,a,n,l,i,"throw",e)}l(void 0)}))}}function g(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,n,s,l,i=[],o=!0,c=!1;try{if(s=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;o=!1}else for(;!(o=(a=s.call(t)).done)&&(i.push(a.value),i.length!==r);o=!0);}catch(e){c=!0,n=e}finally{try{if(!o&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw n}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return j(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?j(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=Array(r);t<r;t++)a[t]=e[t];return a}const b=function(e){var r,t,c,u,v,p,j,b,x,N=e.isOpen,S=e.onClose,D=e.currentUser,w=e.showNotification,O=e.onImportSuccess,A=g((0,a.useState)(null),2),k=A[0],T=A[1],_=g((0,a.useState)([]),2),P=_[0],U=_[1],C=g((0,a.useState)(null),2),I=C[0],E=C[1],R=g((0,a.useState)(!1),2),F=R[0],L=R[1],q=g((0,a.useState)(!1),2),G=q[0],V=q[1],B=g((0,a.useState)(null),2),Y=B[0],z=B[1],M=g((0,a.useState)(!1),2),H=M[0],$=M[1],J=function(){var e=y(f().m((function e(r){var t,a;return f().w((function(e){for(;;)switch(e.n){case 0:if(t=r.target.files[0],console.log("üîç DEBUG: File selected:",t),t){e.n=1;break}return console.log("üîç DEBUG: No file selected, resetting state"),T(null),U([]),E(null),e.a(2);case 1:T(t),E(null);try{(a=new FileReader).onload=function(){var e=y(f().m((function e(r){var t,a,n,s,l,i,o,c;return f().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,t=r.target.result,console.log("üîç DEBUG: CSV data type:",h(t)),console.log("üîç DEBUG: CSV data length:",t?t.length:"undefined"),t){e.n=1;break}throw new Error("No data read from file");case 1:if(a=t.split("\n"),console.log("üîç DEBUG: Rows after split:",a),console.log("üîç DEBUG: Rows length:",a?a.length:"undefined"),a&&0!==a.length){e.n=2;break}throw new Error("No rows found in CSV");case 2:if(n=a[0]?a[0].split(",").map((function(e){return e?e.trim():""})):[],console.log("üîç DEBUG: Headers:",n),console.log("üîç DEBUG: Headers length:",n?n.length:"undefined"),n&&0!==n.length){e.n=3;break}throw new Error("No headers found in CSV");case 3:if(s=[],!(a.length>1)){e.n=7;break}l=a.slice(1),console.log("üîç DEBUG: Data rows:",l),console.log("üîç DEBUG: Data rows length:",l?l.length:"undefined"),i=f().m((function e(){var r,t,a;return f().w((function(e){for(;;)switch(e.n){case 0:if(r=l[o],console.log("üîç DEBUG: Processing row ".concat(o,":"),r),r&&0!==r.trim().length){e.n=1;break}return console.log("üîç DEBUG: Skipping empty row ".concat(o)),e.a(2,1);case 1:try{t=r.split(",").map((function(e){return e?e.trim().replace(/^"|"$/g,""):""})),console.log("üîç DEBUG: Values for row ".concat(o,":"),t),a={},n.forEach((function(e,r){a[e]=r<t.length?t[r]:""})),console.log("üîç DEBUG: Record for row ".concat(o,":"),a),s.push(a)}catch(e){console.warn("üîç DEBUG: Error parsing row ".concat(o+2,":"),e)}case 2:return e.a(2)}}),e)})),o=0;case 4:if(!(o<l.length)){e.n=7;break}return e.d(m(i()),5);case 5:if(!e.v){e.n=6;break}return e.a(3,6);case 6:o++,e.n=4;break;case 7:if(console.log("üîç DEBUG: Final parsed data:",s),console.log("üîç DEBUG: Final parsed data length:",s?s.length:"undefined"),s&&0!==s.length){e.n=8;break}return w("No valid data found in CSV file","error"),U([]),e.a(2);case 8:U(s),w("CSV file loaded with ".concat(s.length,' records. Click "Validate Data" to proceed.')),e.n=10;break;case 9:e.p=9,c=e.v,console.error("üîç DEBUG: CSV parsing error:",c),w("Failed to parse CSV file: "+c.message,"error"),U([]);case 10:return e.a(2)}}),e,null,[[0,9]])})));return function(r){return e.apply(this,arguments)}}(),a.onerror=function(e){console.error("üîç DEBUG: FileReader error:",e),w("Failed to read file","error"),T(null),U([])},a.readAsText(t)}catch(e){console.error("üîç DEBUG: File reading error:",e),w("Failed to read file: "+e.message,"error"),T(null),U([])}case 2:return e.a(2)}}),e)})));return function(r){return e.apply(this,arguments)}}(),K=function(){var e=y(f().m((function e(){var r,t,a,s,l,i,o;return f().w((function(e){for(;;)switch(e.n){case 0:if(P&&Array.isArray(P)&&0!==P.length){e.n=1;break}return w("No data to validate","error"),e.a(2);case 1:if(!(P.length>50)){e.n=2;break}return w("Import size too large: ".concat(P.length," records. Please split into batches of 50 or fewer records."),"error"),e.a(2);case 2:return console.log("üîç Starting database validation process..."),L(!0),E({success:!0,data:{isComplete:!1,validationInProgress:!0},message:"Validating data format and looking up users in database..."}),e.p=3,e.n=4,(0,n.invoke)("validatePTOImportData",{importData:P,adminId:D.accountId,checkJiraUsers:!0,batchIndex:0,batchSize:50});case 4:t=e.v,E(t),L(!1),t.success&&null!==(r=t.data)&&void 0!==r&&r.validationComplete?(l=(null===(a=t.data.validation)||void 0===a||null===(a=a.validRecords)||void 0===a?void 0:a.length)||0,i=(null===(s=t.data.validation)||void 0===s?void 0:s.invalidRecords)||0,w("Database validation complete! ".concat(l," records ready for import. ").concat(i>0?"".concat(i," records have errors."):""))):w(t.message||"Validation failed","error"),e.n=6;break;case 5:e.p=5,o=e.v,console.error("Validation error:",o),E({success:!1,message:"Validation failed: "+o.message}),L(!1),w("Validation failed: "+o.message,"error");case 6:return e.a(2)}}),e,null,[[3,5]])})));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=y(f().m((function e(){var r,t,a,s,l,i,o,c,u,m,v,h,p;return f().w((function(e){for(;;)switch(e.n){case 0:if(null!=I&&I.success&&null!=I&&null!==(r=I.data)&&void 0!==r&&r.validationComplete){e.n=1;break}return w("Please complete validation before importing","error"),e.a(2);case 1:return V(!0),z({success:!0,inProgress:!0,message:"Starting import process...",data:{importedRecords:0,totalRecords:(null===(t=I.data.validation)||void 0===t?void 0:t.validRecordsCount)||0}}),e.p=2,w("Starting import process..."),console.log("üßπ Clearing any old stored validation data..."),e.n=3,(0,n.invoke)("clearImportValidationData",{adminId:D.accountId});case 3:return l=(null===(a=I.data.validation)||void 0===a?void 0:a.validRecords)||[],i=(null===(s=I.data.validation)||void 0===s?void 0:s.validRecordsCount)||l.length,console.log("üì• Importing ".concat(i," records directly (bypassing stored validation)")),e.n=4,(0,n.invoke)("importPTODailySchedules",{adminId:D.accountId,importData:l,skipValidation:!0,useStoredValidation:!1});case 4:o=e.v,z(d(d({},o),{},{inProgress:!1})),o.success?(v="Successfully imported ".concat((null===(c=o.data)||void 0===c?void 0:c.importedRecords)||0," PTO records"),w(v),O&&O(),(null===(u=o.data)||void 0===u?void 0:u.importedRecords)===(null===(m=o.data)||void 0===m?void 0:m.totalRecords)&&setTimeout((function(){S(),W()}),3e3)):w(o.message||"Import failed","error"),e.n=6;break;case 5:e.p=5,p=e.v,console.error("Import error:",p),h="Import failed: "+p.message,w(h,"error"),z({success:!1,inProgress:!1,message:h});case 6:return e.p=6,V(!1),e.f(6);case 7:return e.a(2)}}),e,null,[[2,5,6,7]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=y(f().m((function e(){var r,t;return f().w((function(e){for(;;)switch(e.n){case 0:if(T(null),U([]),E(null),z(null),L(!1),V(!1),e.p=1,!D||!D.accountId){e.n=3;break}return e.n=2,(0,n.invoke)("clearImportValidationData",{adminId:D.accountId});case 2:r=e.v,console.log("‚úÖ Backend validation data cleared:",r),e.n=4;break;case 3:return console.warn("‚ö†Ô∏è No current user available for cleanup"),e.n=4,(0,n.invoke)("clearImportValidationData",{});case 4:e.n=6;break;case 5:e.p=5,t=e.v,console.error("‚ùå Error clearing validation data:",t);case 6:return e.a(2)}}),e,null,[[1,5]])})));return function(){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){N||W()}),[N]),N?(0,o.jsx)("div",{className:"modal-overlay",children:(0,o.jsxs)("div",{className:"modal-content",children:[(0,o.jsxs)("div",{className:"modal-header",children:[(0,o.jsx)("h3",{className:"modal-title",children:"Import PTO Requests"}),(0,o.jsx)("button",{className:"modal-close",onClick:y(f().m((function e(){var r;return f().w((function(e){for(;;)switch(e.n){case 0:if(e.p=0,!(I&&I.success&&null!=D&&D.accountId)){e.n=1;break}return console.log("üßπ Cleaning up validation data from modal close"),e.n=1,(0,n.invoke)("clearImportValidationData",{adminId:D.accountId});case 1:e.n=3;break;case 2:e.p=2,r=e.v,console.error("‚ùå Error clearing data on close:",r);case 3:return S(),e.n=4,W();case 4:return e.a(2)}}),e,null,[[0,2]])}))),children:(0,o.jsx)(s.A,{size:20})})]}),(0,o.jsx)("div",{className:"modal-body",children:(0,o.jsxs)("div",{className:"import-pto-content",children:[(0,o.jsx)("p",{children:"Import PTO daily schedules from a CSV file. The CSV should have the following columns:"}),(0,o.jsxs)("ul",{className:"csv-columns-list",children:[(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"requester_email"})," - Email address of the employee"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"manager_email"})," - Email address of the manager"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"leave_type"})," - Type of leave (vacation, sick, personal, etc.)"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"date"})," - Date of PTO in YYYY-MM-DD format"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"status"})," - Status of the PTO (approved, pending, declined, cancelled)"]}),(0,o.jsx)("li",{children:"schedule_type - Optional: FULL_DAY or HALF_DAY (defaults to FULL_DAY)"}),(0,o.jsx)("li",{children:"hours - Optional: Number of hours (defaults to 8 for FULL_DAY, 4 for HALF_DAY)"}),(0,o.jsx)("li",{children:"created_at - Optional: Creation timestamp (defaults to current time)"})]}),(0,o.jsxs)("div",{className:"alert alert-info",children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Note:"})," The system will look up user account IDs from your existing user database based on email addresses."]}),(0,o.jsx)("p",{children:"Valid leave types: vacation, sick, personal, holiday, other leave type"}),(0,o.jsx)("p",{children:(0,o.jsx)("strong",{children:"Make sure the email addresses in your CSV match the emails in your user database!"})})]}),(0,o.jsxs)("div",{className:"import-step",children:[(0,o.jsx)("h4",{children:"Step 1: Select CSV File"}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("input",{type:"file",accept:".csv",onChange:J,className:"form-control",disabled:F||G}),k&&(0,o.jsxs)("div",{className:"file-info",children:[(0,o.jsxs)("p",{children:["Selected file: ",k.name]}),(0,o.jsxs)("p",{children:["Records found: ",P&&Array.isArray(P)?P.length:0]})]})]})]}),(0,o.jsxs)("div",{className:"import-step",children:[(0,o.jsx)("h4",{children:"Step 2: Validate Data"}),(0,o.jsx)("button",{onClick:K,className:"btn btn-secondary",disabled:!P||!Array.isArray(P)||0===P.length||F||G,children:F?"Validating...":"Validate Data"}),F&&(0,o.jsx)("div",{className:"validation-progress",children:(0,o.jsxs)("div",{className:"validation-spinner-container",children:[(0,o.jsx)("div",{className:"validation-spinner"}),(0,o.jsxs)("div",{className:"validation-message",children:[(0,o.jsx)("h5",{children:"Validating Import Data"}),(0,o.jsx)("p",{children:"Checking format and user database..."}),(0,o.jsx)("div",{className:"validation-stats",children:(0,o.jsxs)("span",{children:["üìÑ ",P.length," records to process"]})})]})]})}),I&&!F&&(0,o.jsxs)("div",{className:"validation-result ".concat(I.success?"success":"error"),children:[(0,o.jsxs)("div",{className:"validation-header",children:[I.success?(0,o.jsx)(l.A,{size:20,className:"success-icon"}):(0,o.jsx)(i.A,{size:20,className:"error-icon"}),(0,o.jsx)("span",{children:I.message})]}),(null===(r=I.data)||void 0===r?void 0:r.validation)&&(0,o.jsxs)("div",{className:"validation-summary",children:[(0,o.jsxs)("div",{className:"summary-grid",children:[(0,o.jsxs)("div",{className:"summary-item",children:[(0,o.jsx)("span",{className:"summary-label",children:"Total:"}),(0,o.jsx)("span",{className:"summary-value",children:I.data.validation.totalRecords})]}),(0,o.jsxs)("div",{className:"summary-item",children:[(0,o.jsx)("span",{className:"summary-label",children:"Ready:"}),(0,o.jsx)("span",{className:"summary-value success",children:I.data.validation.validRecordsCount||(null===(t=I.data.validation.validRecords)||void 0===t?void 0:t.length)||0})]}),(0,o.jsxs)("div",{className:"summary-item",children:[(0,o.jsx)("span",{className:"summary-label",children:"Errors:"}),(0,o.jsx)("span",{className:"summary-value error",children:I.data.validation.invalidRecords||(null===(c=I.data.validation.errors)||void 0===c?void 0:c.length)||0})]})]}),(null===(u=I.data.validation.errors)||void 0===u?void 0:u.length)>0&&(0,o.jsxs)("div",{className:"validation-errors",children:[(0,o.jsxs)("h5",{children:["Issues Found (",I.data.validation.errors.length,"):"]}),(0,o.jsxs)("div",{className:"error-list",children:[I.data.validation.errors.slice(0,5).map((function(e,r){var t;return(0,o.jsxs)("div",{className:"error-item",children:[(0,o.jsxs)("span",{className:"error-record",children:["Row ",e.record,":"]}),(0,o.jsx)("span",{className:"error-message",children:e.errors.join(", ")}),(null===(t=e.data)||void 0===t?void 0:t.requester_email)&&(0,o.jsxs)("span",{className:"error-email",children:["(",e.data.requester_email,")"]})]},r)})),I.data.validation.errors.length>5&&(0,o.jsxs)("div",{className:"error-more",children:["+",I.data.validation.errors.length-5," more errors"]})]})]})]})]})]}),(0,o.jsxs)("div",{className:"import-step",children:[(0,o.jsxs)("div",{className:"import-warning",children:[(0,o.jsxs)("div",{className:"alert alert-warning",children:[(0,o.jsx)("strong",{children:"Important:"})," This import will REPLACE all existing daily schedules. Current database contains ",(null==I||null===(v=I.data)||void 0===v||null===(v=v.validation)||void 0===v?void 0:v.totalRecords)||0," records."]}),(0,o.jsxs)("label",{className:"checkbox-container",children:[(0,o.jsx)("input",{type:"checkbox",checked:H,onChange:function(e){return $(e.target.checked)}}),"I understand this will replace existing daily schedule data"]})]}),(0,o.jsx)("h4",{children:"Step 3: Import Data"}),(0,o.jsx)("button",{onClick:Q,className:"btn btn-primary",disabled:!(null!=I&&I.success)||G||!H,children:G?"IMPORTING...":"Import Data"}),G&&(null==Y?void 0:Y.inProgress)&&(0,o.jsxs)("div",{className:"import-progress",children:[(0,o.jsx)("div",{className:"progress-bar",children:(0,o.jsx)("div",{className:"progress-fill",style:{width:"".concat(Math.round(((null==Y?void 0:Y.recordsProcessed)||0)/((null==Y?void 0:Y.totalRecords)||1)*100),"%")}})}),(0,o.jsxs)("div",{className:"progress-stats",children:[(0,o.jsxs)("span",{children:["Processing batch ",(null==Y?void 0:Y.batchNumber)||1," of ",(null==Y?void 0:Y.totalBatches)||1]}),(0,o.jsxs)("span",{children:[(null==Y?void 0:Y.recordsProcessed)||0," of ",(null==Y?void 0:Y.totalRecords)||0," records processed"]}),(0,o.jsxs)("span",{children:[(null==Y?void 0:Y.importedRecords)||0," imported, ",(null==Y?void 0:Y.failedRecords)||0," failed"]})]})]}),Y&&!Y.inProgress&&(0,o.jsxs)("div",{className:"import-result ".concat(Y.success?"success":"error"),children:[(0,o.jsxs)("div",{className:"import-result-header",children:[Y.success?(0,o.jsx)(l.A,{size:20,className:"success-icon"}):(0,o.jsx)(i.A,{size:20,className:"error-icon"}),(0,o.jsx)("span",{children:Y.message})]}),Y.data&&(0,o.jsxs)("div",{className:"import-result-details",children:[(0,o.jsxs)("div",{className:"import-stats",children:[(0,o.jsxs)("div",{className:"stat-item",children:[(0,o.jsx)("span",{className:"stat-label",children:"Total Records:"}),(0,o.jsx)("span",{className:"stat-value",children:(null==Y||null===(p=Y.data)||void 0===p?void 0:p.totalRecords)||0})]}),(0,o.jsxs)("div",{className:"stat-item",children:[(0,o.jsx)("span",{className:"stat-label",children:"Imported:"}),(0,o.jsx)("span",{className:"stat-value success",children:(null==Y||null===(j=Y.data)||void 0===j?void 0:j.importedRecords)||0})]}),(0,o.jsxs)("div",{className:"stat-item",children:[(0,o.jsx)("span",{className:"stat-label",children:"Failed:"}),(0,o.jsx)("span",{className:"stat-value error",children:(null==Y||null===(b=Y.data)||void 0===b?void 0:b.failedRecords)||0})]})]}),Y.data.errors&&Y.data.errors.length>0&&(0,o.jsxs)("div",{className:"import-errors",children:[(0,o.jsx)("h5",{children:"Failed Records:"}),(0,o.jsxs)("div",{className:"error-table-container",children:[(0,o.jsxs)("table",{className:"error-table",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Record #"}),(0,o.jsx)("th",{children:"Error"}),(0,o.jsx)("th",{children:"Email"})]})}),(0,o.jsx)("tbody",{children:Y.data.errors.slice(0,10).map((function(e,r){return(0,o.jsxs)("tr",{className:"error-row",children:[(0,o.jsx)("td",{children:e.record}),(0,o.jsx)("td",{className:"error-message",children:e.batch?"Batch ".concat(e.batch,": ").concat(e.error):e.error||e.errors&&e.errors.join(", ")}),(0,o.jsx)("td",{children:e.data&&(0,o.jsxs)("div",{className:"error-data",children:[e.data.requester_email&&(0,o.jsxs)("div",{children:["Requester: ",e.data.requester_email]}),e.data.manager_email&&(0,o.jsxs)("div",{children:["Manager: ",e.data.manager_email]})]})})]},r)}))})]}),Y.data.errors.length>10&&(0,o.jsxs)("div",{className:"more-errors",children:["...and ",Y.data.errors.length-10," more errors"]})]})]})]}),Y.success&&(null===(x=Y.data)||void 0===x?void 0:x.importedRecords)>0&&(0,o.jsxs)("div",{className:"import-success-message",children:[(0,o.jsx)("p",{children:"‚úÖ PTO records have been successfully imported."}),(0,o.jsx)("p",{children:"The modal will close automatically in a few seconds, or you can close it manually."})]})]}),(0,o.jsxs)("div",{className:"form-actions",children:[(0,o.jsx)("button",{onClick:function(){S(),W()},className:"btn btn-secondary",disabled:G,children:Y&&Y.success?"Close":"Cancel"}),(0,o.jsx)("button",{onClick:Q,className:"btn btn-primary",disabled:!I||!I.success||G||Y&&Y.success,children:G?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"spinner"}),"Importing..."]}):Y&&Y.success?"Imported Successfully":"Import Data"})]})]})]})})]})}):null}},4506:(e,r,t)=>{t.d(r,{A:()=>_});var a=t(6540),n=t(2307),s=t(8697),l=t(418),i=t(8686),o=t(3893),c=t(4471),d=t(2708),u=t(7235),m=t(6069),f=t(5143),v=t(808),h=t(2321),p=t(4848);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function g(){var e,r,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function s(t,a,n,s){var o=a&&a.prototype instanceof i?a:i,c=Object.create(o.prototype);return j(c,"_invoke",function(t,a,n){var s,i,o,c=0,d=n||[],u=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(r,t){return s=r,i=0,o=e,m.n=t,l}};function f(t,a){for(i=t,o=a,r=0;!u&&c&&!n&&r<d.length;r++){var n,s=d[r],f=m.p,v=s[2];t>3?(n=v===a)&&(o=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=f&&((n=t<2&&f<s[1])?(i=0,m.v=a,m.n=s[1]):f<v&&(n=t<3||s[0]>a||a>v)&&(s[4]=t,s[5]=a,m.n=v,i=0))}if(n||t>1)return l;throw u=!0,a}return function(n,d,v){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,v),i=d,o=v;(r=i<2?e:o)||!u;){s||(i?i<3?(i>1&&(m.n=-1),f(i,o)):m.n=o:m.v=o);try{if(c=2,s){if(i||(n="next"),r=s[n]){if(!(r=r.call(s,o)))throw TypeError("iterator result is not an object");if(!r.done)return r;o=r.value,i<2&&(i=0)}else 1===i&&(r=s.return)&&r.call(s),i<2&&(o=TypeError("The iterator does not provide a '"+n+"' method"),i=1);s=e}else if((r=(u=m.n<0)?o:t.call(a,m))!==l)break}catch(r){s=e,i=1,o=r}finally{c=1}}return{value:r,done:u}}}(t,n,s),!0),c}var l={};function i(){}function o(){}function c(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(j(r={},a,(function(){return this})),r),u=c.prototype=i.prototype=Object.create(d);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,j(e,n,"GeneratorFunction")),e.prototype=Object.create(u),e}return o.prototype=c,j(u,"constructor",c),j(c,"constructor",o),o.displayName="GeneratorFunction",j(c,n,"GeneratorFunction"),j(u),j(u,n,"Generator"),j(u,a,(function(){return this})),j(u,"toString",(function(){return"[object Generator]"})),(g=function(){return{w:s,m}})()}function j(e,r,t,a){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}j=function(e,r,t,a){if(r)n?n(e,r,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[r]=t;else{var s=function(r,t){j(e,r,(function(e){return this._invoke(r,t,e)}))};s("next",0),s("throw",1),s("return",2)}},j(e,r,t,a)}function b(e,r,t,a,n,s,l){try{var i=e[s](l),o=i.value}catch(e){return void t(e)}i.done?r(o):Promise.resolve(o).then(a,n)}function x(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function S(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?N(Object(t),!0).forEach((function(r){D(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function D(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,r||"default");if("object"!=y(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==y(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function w(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,n,s,l,i=[],o=!0,c=!1;try{if(s=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;o=!1}else for(;!(o=(a=s.call(t)).done)&&(i.push(a.value),i.length!==r);o=!0);}catch(e){c=!0,n=e}finally{try{if(!o&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw n}}return i}}(e,r)||O(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,r){if(e){if("string"==typeof e)return A(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?A(e,r):void 0}}function A(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=Array(r);t<r;t++)a[t]=e[t];return a}var k=a.useState,T=a.useEffect;const _=function(e){var r,t,a,y,j,N=e.selectedDates,O=void 0===N?[]:N,A=e.onClose,_=e.onSubmit,P=e.currentUser,U=e.currentUserData,C=e.userManager,I=e.allUsers,E=void 0===I?[]:I,R=e.allTeams,F=void 0===R?[]:R,L=e.allRequests,q=void 0===L?[]:L,G=e.isAdmin,V=void 0!==G&&G,B=(e.isAdminMode,w(k({targetUser:P,manager:C,startDate:O[0]||"",endDate:O[O.length-1]||"",reason:"",dailySchedules:[]}),2)),Y=B[0],z=B[1],M=w(k({}),2),H=M[0],$=M[1],J=w(k(!1),2),K=J[0],Q=J[1],W=w(k(!1),2),X=W[0],Z=W[1],ee=w(k(!1),2),re=ee[0],te=ee[1];T((function(){Q(!V&&!U)}),[V,U]);var ae=function(e){if(!e)return null;var r=E.find((function(r){return r.jira_account_id===e.accountId||r.email_address===e.emailAddress}));if(null!=r&&r.manager)return E.find((function(e){return e.id===r.manager||e.jira_account_id===r.manager}));if(null!=r&&r.team_id){var t=F.find((function(e){return e.id===r.team_id}));if(null!=t&&t.manager)return E.find((function(e){return e.id===t.manager||e.jira_account_id===t.manager}))}return null};T((function(){!function(){var e=[];if(!X&&O.length>0)e=O.slice().sort();else if((X||0===O.length)&&Y.startDate&&Y.endDate){var r=new Date(Y.startDate),t=new Date(Y.endDate);e=[];for(var a=new Date(r);a<=t;a.setDate(a.getDate()+1))e.push(a.toISOString().split("T")[0])}var n=e.map((function(e){return{date:e,type:"FULL_DAY",leaveType:"vacation"}}));z((function(r){return S(S({},r),{},{targetUser:V?r.targetUser:P,manager:ae(V?r.targetUser:P)||C||r.manager,startDate:e[0]||"",endDate:e[e.length-1]||"",dailySchedules:n})}))}()}),[O,P,C,V,E,F,X]),T((function(){if(Y.startDate&&Y.endDate){for(var e=new Date(Y.startDate),r=new Date(Y.endDate),t=[],a=new Date(e);a<=r;a.setDate(a.getDate()+1))t.push(a.toISOString().split("T")[0]);var n=Y.dailySchedules.filter((function(e){return t.includes(e.date)})),s=t.filter((function(e){return!n.find((function(r){return r.date===e}))})).map((function(e){return{date:e,type:"FULL_DAY",leaveType:"vacation"}}));z((function(e){return S(S({},e),{},{dailySchedules:[].concat(x(n),x(s)).sort((function(e,r){return new Date(e.date)-new Date(r.date)}))})}))}}),[Y.startDate,Y.endDate]);var ne=function(){var e,r=(e=g().m((function e(r){var t,a,n,s;return g().w((function(e){for(;;)switch(e.n){case 0:if(r){e.n=1;break}return z((function(e){return S(S({},e),{},{targetUser:null})})),e.a(2);case 1:return e.p=1,e.n=2,(0,h.invoke)("getUsers");case 2:t=e.v,a=t.success&&t.data||[],n=a.find((function(e){return e.jira_account_id===r.accountId||e.email_address===r.emailAddress})),z(n?function(e){return S(S({},e),{},{targetUser:n,manager:ae(n)})}:function(e){return S(S({},e),{},{targetUser:r,manager:null})}),e.n=4;break;case 3:e.p=3,s=e.v,console.error("Failed to get user details:",s),z((function(e){return S(S({},e),{},{targetUser:r})}));case 4:return e.a(2)}}),e,null,[[1,3]])})),function(){var r=this,t=arguments;return new Promise((function(a,n){var s=e.apply(r,t);function l(e){b(s,a,n,l,i,"next",e)}function i(e){b(s,a,n,l,i,"throw",e)}l(void 0)}))});return function(e){return r.apply(this,arguments)}}(),se=function(e,r,t){z((function(a){return S(S({},a),{},{dailySchedules:a.dailySchedules.map((function(a,n){return n===e?S(S({},a),{},D({},r,t)):a}))})}))},le=[{value:"FULL_DAY",label:"Full Day (8h)"},{value:"HALF_DAY_MORNING",label:"Morning Half (4h)"},{value:"HALF_DAY_AFTERNOON",label:"Afternoon Half (4h)"}],ie=[{value:"vacation",label:"üèñÔ∏è Vacation",emoji:"üèñÔ∏è"},{value:"sick",label:"ü§í Sick Leave",emoji:"ü§í"},{value:"personal",label:"üë§ Personal Day",emoji:"üë§"},{value:"holiday",label:"üéâ Holiday",emoji:"üéâ"},{value:"other leave type",label:"üìù Other Leave Type",emoji:"üìù"}],oe={totalDays:Y.dailySchedules.reduce((function(e,r){return e+("FULL_DAY"===r.type?1:.5)}),0),totalHours:Y.dailySchedules.reduce((function(e,r){return e+("FULL_DAY"===r.type?8:4)}),0),leaveTypeBreakdown:Y.dailySchedules.reduce((function(e,r){return e[r.leaveType]=(e[r.leaveType]||0)+("FULL_DAY"===r.type?1:.5),e}),{}),workingDays:Y.dailySchedules.length,dateRange:Y.startDate&&Y.endDate?"".concat(new Date(Y.startDate).toLocaleDateString()," - ").concat(new Date(Y.endDate).toLocaleDateString()):""},ce=function(e){Z(e);var r=[];if(e&&Y.startDate&&Y.endDate)for(var t=new Date(Y.startDate),a=new Date(Y.endDate),n=new Date(t);n<=a;n.setDate(n.getDate()+1))r.push(n.toISOString().split("T")[0]);else r=O.slice().sort();var s=r.map((function(e){return{date:e,type:"FULL_DAY",leaveType:"vacation"}}));z((function(e){return S(S({},e),{},{dailySchedules:s})}))};return T((function(){Z(!1);var e=O.slice().sort(),r=e.map((function(e){return{date:e,type:"FULL_DAY",leaveType:"vacation"}}));z((function(t){return S(S({},t),{},{startDate:e[0]||"",endDate:e[e.length-1]||"",dailySchedules:r})}))}),[O]),(0,p.jsx)("div",{className:"modal-overlay",children:(0,p.jsxs)("div",{className:"modal-content pto-submission-modal",children:[(0,p.jsxs)("div",{className:"modal-header",children:[(0,p.jsxs)("h3",{className:"modal-title",children:[(0,p.jsx)(n.A,{size:20}),V?"Create PTO Request (Admin)":"Submit PTO Request"]}),(0,p.jsx)("button",{onClick:A,className:"modal-close",children:(0,p.jsx)(s.A,{size:20})})]}),(0,p.jsxs)("div",{className:"modal-body",children:[K&&(0,p.jsxs)("div",{className:"alert alert-warning",children:[(0,p.jsx)(l.A,{size:20}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"User Not in System"}),(0,p.jsx)("p",{children:"Your user profile is not set up in the team management system. Please contact HR to complete your setup."})]})]}),(0,p.jsxs)("div",{className:"form-section",children:[(0,p.jsxs)("label",{className:"form-label",children:["Employee ",V?"*":""]}),V?(0,p.jsx)(f.A,{selectedUser:Y.targetUser,onSelect:ne,placeholder:"Search and select employee",required:!0,error:H.targetUser,useBackendSearch:!0}):(0,p.jsxs)("div",{className:"user-display-card",children:[(0,p.jsx)("div",{className:"user-avatar-large",children:null!=P&&P.avatarUrl?(0,p.jsx)("img",{src:P.avatarUrl,alt:P.displayName}):(0,p.jsx)("div",{className:"avatar-placeholder-large",children:(null==P||null===(r=P.displayName)||void 0===r?void 0:r.charAt(0))||(0,p.jsx)(i.A,{size:20})})}),(0,p.jsxs)("div",{className:"user-info-detailed",children:[(0,p.jsx)("div",{className:"user-name-large",children:null==P?void 0:P.displayName}),(0,p.jsx)("div",{className:"user-email-large",children:null==P?void 0:P.emailAddress}),(null==U?void 0:U.team_id)&&(0,p.jsxs)("div",{className:"user-team",children:[(0,p.jsx)(o.A,{size:14}),(null===(t=F.find((function(e){return e.id===U.team_id})))||void 0===t?void 0:t.name)||"Team Member"]})]})]}),H.targetUser&&(0,p.jsx)("div",{className:"error-text",children:H.targetUser})]}),(0,p.jsxs)("div",{className:"form-section",children:[(0,p.jsx)("label",{className:"form-label",children:"Manager *"}),Y.manager?(0,p.jsxs)("div",{className:"user-display-card manager-display",children:[(0,p.jsx)("div",{className:"user-avatar-large",children:Y.manager.avatarUrl?(0,p.jsx)("img",{src:Y.manager.avatarUrl,alt:Y.manager.displayName}):(0,p.jsx)("div",{className:"avatar-placeholder-large",children:(null===(a=Y.manager.displayName)||void 0===a?void 0:a.charAt(0))||(0,p.jsx)(i.A,{size:20})})}),(0,p.jsxs)("div",{className:"user-info-detailed",children:[(0,p.jsx)("div",{className:"user-name-large",children:Y.manager.displayName}),(0,p.jsx)("div",{className:"user-email-large",children:Y.manager.emailAddress}),(0,p.jsxs)("div",{className:"manager-badge",children:[(0,p.jsx)(c.A,{size:14}),"Approving Manager"]})]}),V&&(0,p.jsx)("button",{type:"button",onClick:function(){return z((function(e){return S(S({},e),{},{manager:null})}))},className:"btn btn-sm btn-secondary",title:"Change Manager",children:"Change"})]}):(0,p.jsx)(f.A,{selectedUser:Y.manager,onSelect:function(e){return z((function(r){return S(S({},r),{},{manager:e})}))},placeholder:"Search and select approving manager",required:!0,error:H.manager,useBackendSearch:!0}),H.manager&&(0,p.jsx)("div",{className:"error-text",children:H.manager})]}),(0,p.jsxs)("div",{className:"pto-modal-section pto-modal-row",children:[(0,p.jsxs)("div",{className:"pto-modal-col",children:[(0,p.jsx)("label",{className:"form-label",children:"Start Date"}),(0,p.jsx)("input",{type:"text",className:"form-control",value:Y.startDate,readOnly:!0,tabIndex:-1})]}),(0,p.jsxs)("div",{className:"pto-modal-col",children:[(0,p.jsx)("label",{className:"form-label",children:"End Date"}),(0,p.jsx)("input",{type:"text",className:"form-control",value:Y.endDate,readOnly:!0,tabIndex:-1})]}),(0,p.jsxs)("div",{className:"pto-modal-col",style:{alignSelf:"end"},children:[!X&&O.length>1&&(0,p.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",style:{marginTop:24},onClick:function(){return ce(!0)},children:"Add all dates in range"}),X&&(0,p.jsx)("button",{type:"button",className:"btn btn-sm btn-secondary",style:{marginTop:24},onClick:function(){return ce(!1)},children:"Use only selected dates"})]})]}),(0,p.jsxs)("div",{className:"form-section",children:[(0,p.jsx)("label",{className:"form-label",children:"Reason (Optional)"}),(0,p.jsx)("textarea",{value:Y.reason,onChange:function(e){return z((function(r){return S(S({},r),{},{reason:e.target.value})}))},className:"form-control",rows:"3",placeholder:"Please provide additional details about your PTO request..."})]}),Y.dailySchedules.length>0&&(0,p.jsxs)("div",{className:"form-section",children:[(0,p.jsxs)("div",{className:"schedule-header",children:[(0,p.jsx)("label",{className:"form-label",children:"Schedule Details"}),(0,p.jsxs)("div",{className:"quick-actions",children:[(0,p.jsx)("span",{className:"quick-actions-label",children:"Apply to all:"}),ie.map((function(e){return(0,p.jsxs)("button",{type:"button",onClick:function(){return r=e.value,void z((function(e){return S(S({},e),{},{dailySchedules:e.dailySchedules.map((function(e){return S(S({},e),{},{leaveType:r})}))})}));var r},className:"btn btn-sm btn-secondary quick-action-btn",title:"Mark all days as ".concat(e.label),children:[(0,p.jsx)("span",{children:e.emoji}),(0,p.jsx)("span",{children:e.value})]},e.value)}))]})]}),(0,p.jsx)("div",{className:"schedule-list",children:Y.dailySchedules.map((function(e,r){return(0,p.jsxs)("div",{className:"schedule-day-row",children:[(0,p.jsx)("div",{className:"schedule-day-info",children:(0,p.jsx)("div",{className:"day-date",children:new Date(e.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})})}),(0,p.jsxs)("div",{className:"schedule-controls",children:[(0,p.jsx)("select",{value:e.leaveType,onChange:function(e){return se(r,"leaveType",e.target.value)},className:"form-control schedule-select",children:ie.map((function(e){return(0,p.jsx)("option",{value:e.value,children:e.label},e.value)}))}),(0,p.jsx)("select",{value:e.type,onChange:function(e){return se(r,"type",e.target.value)},className:"form-control schedule-select",children:le.map((function(e){return(0,p.jsx)("option",{value:e.value,children:e.label},e.value)}))}),(0,p.jsx)("button",{type:"button",onClick:function(){return function(e){z((function(r){return S(S({},r),{},{dailySchedules:r.dailySchedules.filter((function(r,t){return t!==e}))})}));var r=Y.dailySchedules.filter((function(r,t){return t!==e}));if(r.length>0){var t=r.map((function(e){return e.date})).sort();z((function(e){return S(S({},e),{},{startDate:t[0],endDate:t[t.length-1]})}))}}(r)},className:"btn btn-sm btn-danger",title:"Remove this day",children:(0,p.jsx)(d.A,{size:14})})]})]},e.date)}))}),H.dailySchedules&&(0,p.jsx)("div",{className:"error-text",children:H.dailySchedules})]}),Y.dailySchedules.length>0&&(0,p.jsx)("div",{className:"form-section",children:(0,p.jsxs)("div",{className:"request-summary-card",children:[(0,p.jsxs)("div",{className:"summary-header",children:[(0,p.jsx)("h4",{children:"Request Summary"}),(0,p.jsxs)("div",{className:"summary-status",children:[(0,p.jsx)(u.A,{size:16}),"Ready to Submit"]})]}),(0,p.jsxs)("div",{className:"summary-content",children:[(0,p.jsxs)("div",{className:"summary-metrics",children:[(0,p.jsxs)("div",{className:"metric-item",children:[(0,p.jsx)("div",{className:"metric-value",children:oe.totalDays}),(0,p.jsx)("div",{className:"metric-label",children:"Days Off"})]}),(0,p.jsxs)("div",{className:"metric-item",children:[(0,p.jsxs)("div",{className:"metric-value",children:[oe.totalHours,"h"]}),(0,p.jsx)("div",{className:"metric-label",children:"Total Hours"})]}),(0,p.jsxs)("div",{className:"metric-item",children:[(0,p.jsx)("div",{className:"metric-value",children:oe.workingDays}),(0,p.jsx)("div",{className:"metric-label",children:"Scheduled Days"})]})]}),(0,p.jsxs)("div",{className:"summary-details",children:[(0,p.jsxs)("div",{className:"detail-row",children:[(0,p.jsxs)("span",{className:"detail-label",children:[(0,p.jsx)(m.A,{size:16}),"Date Range:"]}),(0,p.jsx)("span",{className:"detail-value",children:oe.dateRange})]}),(0,p.jsxs)("div",{className:"detail-row",children:[(0,p.jsxs)("span",{className:"detail-label",children:[(0,p.jsx)(i.A,{size:16}),V?"Employee:":"Approver:"]}),(0,p.jsx)("span",{className:"detail-value",children:V?(null===(y=Y.targetUser)||void 0===y?void 0:y.displayName)||"Not selected":(null===(j=Y.manager)||void 0===j?void 0:j.displayName)||"Not selected"})]}),Object.keys(oe.leaveTypeBreakdown).length>0&&(0,p.jsxs)("div",{className:"detail-row",children:[(0,p.jsxs)("span",{className:"detail-label",children:[(0,p.jsx)(n.A,{size:16}),"Leave Types:"]}),(0,p.jsx)("div",{className:"leave-type-tags",children:Object.entries(oe.leaveTypeBreakdown).map((function(e){var r=w(e,2),t=r[0],a=r[1];return(0,p.jsxs)("span",{className:"leave-type-tag",children:[(0,v.S0)(t)," ",t,": ",a," day",1!==a?"s":""]},t)}))})]})]})]})]})}),H.duplicate&&(0,p.jsxs)("div",{className:"alert alert-error",children:[(0,p.jsx)(l.A,{size:20}),(0,p.jsxs)("div",{children:[(0,p.jsx)("strong",{children:"Scheduling Conflict"}),(0,p.jsx)("p",{children:H.duplicate})]})]}),(0,p.jsxs)("div",{className:"form-actions",children:[(0,p.jsx)("button",{type:"button",onClick:A,className:"btn btn-secondary",children:"Cancel"}),(0,p.jsx)("button",{type:"button",onClick:function(){var e;if(function(){var e,r,t={};Y.targetUser||(t.targetUser="User is required"),Y.manager||(t.manager="Manager is required"),Y.startDate||(t.startDate="Start date is required"),Y.endDate||(t.endDate="End date is required"),Y.startDate&&Y.endDate&&new Date(Y.startDate)>new Date(Y.endDate)&&(t.endDate="End date must be after start date"),0===Y.dailySchedules.length&&(t.dailySchedules="Please select at least one day");var a=(null===(e=Y.targetUser)||void 0===e?void 0:e.accountId)||(null===(r=Y.targetUser)||void 0===r?void 0:r.jira_account_id);if(a){var n=Y.dailySchedules.filter((function(e){return q.some((function(r){var t;return(r.requester_id===a||r.requester_email===(null===(t=Y.targetUser)||void 0===t?void 0:t.emailAddress))&&"declined"!==r.status&&r.start_date<=e.date&&r.end_date>=e.date}))}));n.length>0&&(t.duplicate="This user already has PTO requests for: ".concat(n.map((function(e){return new Date(e.date).toLocaleDateString()})).join(", ")))}return $(t),0===Object.keys(t).length}()){var r,t=(r=Y.targetUser)?S(S({},r),{},{accountId:r.accountId||r.jira_account_id||r.id,displayName:r.displayName||r.display_name||r.name,emailAddress:r.emailAddress||r.email_address,avatarUrl:r.avatarUrl||r.avatar_url}):null;if(t&&t.accountId&&t.displayName&&t.emailAddress){var a,n=Y.dailySchedules.reduce((function(e,r){return e+("FULL_DAY"===r.type?1:.5)}),0),s=Y.dailySchedules.reduce((function(e,r){return e+("FULL_DAY"===r.type?8:4)}),0),l=S({reporter:t,manager:(a=Y.manager,a?S(S({},a),{},{accountId:a.accountId||a.jira_account_id||a.id,displayName:a.displayName||a.display_name||a.name,emailAddress:a.emailAddress||a.email_address,avatarUrl:a.avatarUrl||a.avatar_url}):null),startDate:Y.startDate,endDate:Y.endDate,leaveType:(null===(e=Y.dailySchedules[0])||void 0===e?void 0:e.leaveType)||"vacation",reason:Y.reason,dailySchedules:Y.dailySchedules,totalDays:n,totalHours:s,isAdmin:re},re&&{targetUser:t});_(l)}else $((function(e){return S(S({},e),{},{targetUser:"Please select a valid user."})}))}},disabled:!Y.targetUser||!Y.manager||!Y.startDate||!Y.endDate||0===Y.dailySchedules.length||!!H.duplicate||K,className:"btn btn-primary",children:V?"Create PTO Request":"Submit Request"})]}),re&&(0,p.jsxs)("div",{className:"admin-notice",children:[(0,p.jsx)("strong",{children:"Admin Mode:"})," This PTO request will be created with admin privileges and may be automatically approved."]}),0===Y.dailySchedules.length&&(0,p.jsxs)("div",{className:"instructions",children:[(0,p.jsx)("strong",{children:"Next Step:"})," Select start and end dates to configure your PTO schedule, or return to the calendar to select specific dates."]}),V&&(0,p.jsxs)("div",{className:"pto-admin-mode-toggle",style:{display:"flex",gap:"2rem",alignItems:"center",marginBottom:16},children:[(0,p.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,p.jsx)("input",{type:"radio",checked:!re,onChange:function(){return te(!1)},style:{marginRight:6}}),"Submit as Standard User"]}),(0,p.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,p.jsx)("input",{type:"radio",checked:re,onChange:function(){return te(!0)},style:{marginRight:6}}),"Submit as Admin (auto-approve)"]})]})]})]})})}},9618:(e,r,t)=>{t.d(r,{A:()=>p});var a=t(6540),n=t(8697),s=t(2321),l=t(4848);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,a)}return t}function c(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){d(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function d(e,r,t){return(r=function(e){var r=function(e,r){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,r||"default");if("object"!=i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==i(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function u(){var e,r,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",n=t.toStringTag||"@@toStringTag";function s(t,a,n,s){var o=a&&a.prototype instanceof i?a:i,c=Object.create(o.prototype);return m(c,"_invoke",function(t,a,n){var s,i,o,c=0,d=n||[],u=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(r,t){return s=r,i=0,o=e,m.n=t,l}};function f(t,a){for(i=t,o=a,r=0;!u&&c&&!n&&r<d.length;r++){var n,s=d[r],f=m.p,v=s[2];t>3?(n=v===a)&&(o=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=f&&((n=t<2&&f<s[1])?(i=0,m.v=a,m.n=s[1]):f<v&&(n=t<3||s[0]>a||a>v)&&(s[4]=t,s[5]=a,m.n=v,i=0))}if(n||t>1)return l;throw u=!0,a}return function(n,d,v){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&f(d,v),i=d,o=v;(r=i<2?e:o)||!u;){s||(i?i<3?(i>1&&(m.n=-1),f(i,o)):m.n=o:m.v=o);try{if(c=2,s){if(i||(n="next"),r=s[n]){if(!(r=r.call(s,o)))throw TypeError("iterator result is not an object");if(!r.done)return r;o=r.value,i<2&&(i=0)}else 1===i&&(r=s.return)&&r.call(s),i<2&&(o=TypeError("The iterator does not provide a '"+n+"' method"),i=1);s=e}else if((r=(u=m.n<0)?o:t.call(a,m))!==l)break}catch(r){s=e,i=1,o=r}finally{c=1}}return{value:r,done:u}}}(t,n,s),!0),c}var l={};function i(){}function o(){}function c(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(m(r={},a,(function(){return this})),r),f=c.prototype=i.prototype=Object.create(d);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,m(e,n,"GeneratorFunction")),e.prototype=Object.create(f),e}return o.prototype=c,m(f,"constructor",c),m(c,"constructor",o),o.displayName="GeneratorFunction",m(c,n,"GeneratorFunction"),m(f),m(f,n,"Generator"),m(f,a,(function(){return this})),m(f,"toString",(function(){return"[object Generator]"})),(u=function(){return{w:s,m:v}})()}function m(e,r,t,a){var n=Object.defineProperty;try{n({},"",{})}catch(e){n=0}m=function(e,r,t,a){if(r)n?n(e,r,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[r]=t;else{var s=function(r,t){m(e,r,(function(e){return this._invoke(r,t,e)}))};s("next",0),s("throw",1),s("return",2)}},m(e,r,t,a)}function f(e,r,t,a,n,s,l){try{var i=e[s](l),o=i.value}catch(e){return void t(e)}i.done?r(o):Promise.resolve(o).then(a,n)}function v(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,n,s,l,i=[],o=!0,c=!1;try{if(s=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;o=!1}else for(;!(o=(a=s.call(t)).done)&&(i.push(a.value),i.length!==r);o=!0);}catch(e){c=!0,n=e}finally{try{if(!o&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw n}}return i}}(e,r)||function(e,r){if(e){if("string"==typeof e)return h(e,r);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=Array(r);t<r;t++)a[t]=e[t];return a}const p=function(e){var r=e.request,t=e.onClose,i=e.onSave,o=e.currentUser,d=v((0,a.useState)({startDate:"",endDate:"",leaveType:"",reason:"",dailySchedules:[]}),2),m=d[0],h=d[1],p=v((0,a.useState)(""),2),y=p[0],g=p[1];(0,a.useEffect)((function(){r&&h({startDate:r.start_date,endDate:r.end_date,leaveType:r.leave_type,reason:r.reason||"",dailySchedules:r.daily_schedules||[]})}),[r]);var j=function(){var e,a=(e=u().m((function e(a){var n,l,c;return u().w((function(e){for(;;)switch(e.n){case 0:if(a.preventDefault(),g(""),e.p=1,"approved"!==r.status){e.n=2;break}if((n=new Date).setHours(0,0,0,0),!(new Date(r.start_date)<n)){e.n=2;break}return g("Cannot edit approved requests with past dates. Please contact an admin for assistance."),e.a(2);case 2:return e.n=3,(0,s.invoke)("editPTORequest",{requestId:r.id,editedBy:o.accountId,updatedData:{startDate:m.startDate,endDate:m.endDate,leaveType:m.leaveType,reason:m.reason,dailySchedules:m.dailySchedules}});case 3:(l=e.v).success?(i(l.data),t()):g(l.message||"Failed to update PTO request"),e.n=5;break;case 4:e.p=4,c=e.v,g("Failed to update PTO request: "+c.message);case 5:return e.a(2)}}),e,null,[[1,4]])})),function(){var r=this,t=arguments;return new Promise((function(a,n){var s=e.apply(r,t);function l(e){f(s,a,n,l,i,"next",e)}function i(e){f(s,a,n,l,i,"throw",e)}l(void 0)}))});return function(e){return a.apply(this,arguments)}}();return(0,l.jsx)("div",{className:"modal-overlay",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"modal-header",children:[(0,l.jsx)("h3",{children:"Edit PTO Request"}),(0,l.jsx)("button",{onClick:t,className:"modal-close",children:(0,l.jsx)(n.A,{size:20})})]}),y&&(0,l.jsx)("div",{className:"alert alert-danger",children:y}),(0,l.jsxs)("form",{onSubmit:j,children:[(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Start Date"}),(0,l.jsx)("input",{type:"date",value:m.startDate,onChange:function(e){return h((function(r){return c(c({},r),{},{startDate:e.target.value})}))},className:"form-control",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"End Date"}),(0,l.jsx)("input",{type:"date",value:m.endDate,onChange:function(e){return h((function(r){return c(c({},r),{},{endDate:e.target.value})}))},className:"form-control",required:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Leave Type"}),(0,l.jsxs)("select",{value:m.leaveType,onChange:function(e){return h((function(r){return c(c({},r),{},{leaveType:e.target.value})}))},className:"form-control",required:!0,children:[(0,l.jsx)("option",{value:"vacation",children:"Vacation"}),(0,l.jsx)("option",{value:"sick",children:"Sick Leave"}),(0,l.jsx)("option",{value:"personal",children:"Personal Leave"}),(0,l.jsx)("option",{value:"other",children:"Other"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{children:"Reason"}),(0,l.jsx)("textarea",{value:m.reason,onChange:function(e){return h((function(r){return c(c({},r),{},{reason:e.target.value})}))},className:"form-control",rows:"3"})]}),(0,l.jsxs)("div",{className:"modal-footer",children:[(0,l.jsx)("button",{type:"button",onClick:t,className:"btn btn-secondary",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"})]})]})]})})}}}]);