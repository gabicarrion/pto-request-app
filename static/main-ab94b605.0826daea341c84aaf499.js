/*! For license information please see main-ab94b605.0826daea341c84aaf499.js.LICENSE.txt */
"use strict";(this.webpackChunkpto_request_app=this.webpackChunkpto_request_app||[]).push([[6],{7049:(e,t,a)=>{a.d(t,{A:()=>Te});var n=a(6540),r=a(2492),l=a(3893),c=a(4945),i=a(2762),s=a(7623),o=a(2307),u=a(8309),m=a(4796),d=a(418),p=a(827),f=a(964),v=a(8697),y=a(2321),E=a(2795),b=a(5741),g=a(8852),h=a(697),_=a(1999),N=a(1393),w=a(8445),k=a(8188),S=a(2708),O=a(8686);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function A(e){return function(e){if(Array.isArray(e))return z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||F(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=F(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,i=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return c=e.done,e},e:function(e){i=!0,l=e},f:function(){try{c||null==a.return||a.return()}finally{if(i)throw l}}}}function D(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?D(Object(a),!0).forEach((function(t){P(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function I(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function l(a,n,r,l){var s=n&&n.prototype instanceof i?n:i,o=Object.create(s.prototype);return x(o,"_invoke",function(a,n,r){var l,i,s,o=0,u=r||[],m=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,a){return l=t,i=0,s=e,d.n=a,c}};function p(a,n){for(i=a,s=n,t=0;!m&&o&&!r&&t<u.length;t++){var r,l=u[t],p=d.p,f=l[2];a>3?(r=f===n)&&(s=l[(i=l[4])?5:(i=3,3)],l[4]=l[5]=e):l[0]<=p&&((r=a<2&&p<l[1])?(i=0,d.v=n,d.n=l[1]):p<f&&(r=a<3||l[0]>n||n>f)&&(l[4]=a,l[5]=n,d.n=f,i=0))}if(r||a>1)return c;throw m=!0,n}return function(r,u,f){if(o>1)throw TypeError("Generator is already running");for(m&&1===u&&p(u,f),i=u,s=f;(t=i<2?e:s)||!m;){l||(i?i<3?(i>1&&(d.n=-1),p(i,s)):d.n=s:d.v=s);try{if(o=2,l){if(i||(r="next"),t=l[r]){if(!(t=t.call(l,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=l.return)&&t.call(l),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);l=e}else if((t=(m=d.n<0)?s:a.call(n,d))!==c)break}catch(t){l=e,i=1,s=t}finally{o=1}}return{value:t,done:m}}}(a,r,l),!0),o}var c={};function i(){}function s(){}function o(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(x(t={},n,(function(){return this})),t),m=o.prototype=i.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,x(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=o,x(m,"constructor",o),x(o,"constructor",s),s.displayName="GeneratorFunction",x(o,r,"GeneratorFunction"),x(m),x(m,r,"Generator"),x(m,n,(function(){return this})),x(m,"toString",(function(){return"[object Generator]"})),(I=function(){return{w:l,m:d}})()}function x(e,t,a,n){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}x=function(e,t,a,n){if(t)r?r(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a;else{var l=function(t,a){x(e,t,(function(e){return this._invoke(t,a,e)}))};l("next",0),l("throw",1),l("return",2)}},x(e,t,a,n)}function q(e,t,a,n,r,l,c){try{var i=e[l](c),s=i.value}catch(e){return void a(e)}i.done?t(s):Promise.resolve(s).then(n,r)}function U(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var l=e.apply(t,a);function c(e){q(l,n,r,c,i,"next",e)}function i(e){q(l,n,r,c,i,"throw",e)}c(void 0)}))}}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,i=[],s=!0,o=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;s=!1}else for(;!(s=(n=l.call(a)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){o=!0,r=e}finally{try{if(!s&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(o)throw r}}return i}}(e,t)||F(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){if(e){if("string"==typeof e)return z(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?z(e,t):void 0}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var L=function(e){var t=e.isOpen,a=e.onClose,r=e.teamData,l=e.setTeamData,c=e.onSave,i=e.isEditing,s=e.loading;e.users;return t?n.createElement("div",{className:"modal-overlay"},n.createElement("div",{className:"modal-content",style:{maxWidth:"600px"}},n.createElement("div",{className:"modal-header"},n.createElement("h3",null,i?"Edit Team":"Create New Team"),n.createElement("button",{className:"modal-close-btn",onClick:a},n.createElement(v.A,{size:20}))),n.createElement("div",{className:"modal-body"},n.createElement("div",{className:"form-grid"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Team Name *"),n.createElement("input",{type:"text",value:r.team_name,onChange:function(e){return l(j(j({},r),{},{team_name:e.target.value}))},placeholder:"Enter team name",required:!0})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Department"),n.createElement("input",{type:"text",value:r.team_department,onChange:function(e){return l(j(j({},r),{},{team_department:e.target.value}))},placeholder:"Enter department"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Business Unit"),n.createElement("input",{type:"text",value:r.team_business_unit,onChange:function(e){return l(j(j({},r),{},{team_business_unit:e.target.value}))},placeholder:"Enter business unit"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Manager Name"),n.createElement("input",{type:"text",value:r.team_manager_name,onChange:function(e){return l(j(j({},r),{},{team_manager_name:e.target.value}))},placeholder:"Enter manager name"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Manager ID (Jira Account ID)"),n.createElement("input",{type:"text",value:r.team_manager_id,onChange:function(e){return l(j(j({},r),{},{team_manager_id:e.target.value}))},placeholder:"Enter manager Jira account ID"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Manager Email"),n.createElement("input",{type:"email",value:r.team_manager_email,onChange:function(e){return l(j(j({},r),{},{team_manager_email:e.target.value}))},placeholder:"Enter manager email"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Executive Manager Name"),n.createElement("input",{type:"text",value:r.team_executive_manager_name,onChange:function(e){return l(j(j({},r),{},{team_executive_manager_name:e.target.value}))},placeholder:"Enter executive manager name"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Executive Manager ID (Jira Account ID)"),n.createElement("input",{type:"text",value:r.team_executive_manager_id,onChange:function(e){return l(j(j({},r),{},{team_executive_manager_id:e.target.value}))},placeholder:"Enter executive manager Jira account ID"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Executive Manager Email"),n.createElement("input",{type:"email",value:r.team_executive_manager_email,onChange:function(e){return l(j(j({},r),{},{team_executive_manager_email:e.target.value}))},placeholder:"Enter executive manager email"})))),n.createElement("div",{className:"modal-footer"},n.createElement("button",{className:"btn btn-secondary",onClick:a,disabled:s},"Cancel"),n.createElement("button",{className:"btn btn-primary",onClick:c,disabled:s||!r.team_name.trim()},s?"Saving...":i?"Update Team":"Create Team")))):null},M=function(e){var t=e.isOpen,a=e.onClose,r=e.userData,l=e.setUserData,c=e.onSave,i=e.isEditing,s=e.loading,o=e.teams;if(!t)return null;var u=function(e,t,a){l(j(j({},r),{},{standard_availability:j(j({},r.standard_availability),{},P({},e,j(j({},r.standard_availability[e]),{},P({},t,a))))}))};return n.createElement("div",{className:"modal-overlay"},n.createElement("div",{className:"modal-content",style:{maxWidth:"800px",maxHeight:"90vh",overflowY:"auto"}},n.createElement("div",{className:"modal-header"},n.createElement("h3",null,i?"Edit User":"Create New User"),n.createElement("button",{className:"modal-close-btn",onClick:a},n.createElement(v.A,{size:20}))),n.createElement("div",{className:"modal-body"},n.createElement("div",{className:"form-sections"},n.createElement("div",{className:"form-section"},n.createElement("h4",null,"Basic Information"),n.createElement("div",{className:"form-grid"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Display Name *"),n.createElement("input",{type:"text",value:r.display_name,onChange:function(e){return l(j(j({},r),{},{display_name:e.target.value}))},placeholder:"Enter display name",required:!0})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Email Address *"),n.createElement("input",{type:"email",value:r.email_address,onChange:function(e){return l(j(j({},r),{},{email_address:e.target.value}))},placeholder:"Enter email address",required:!0})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Jira Account ID"),n.createElement("input",{type:"text",value:r.jira_account_id,onChange:function(e){return l(j(j({},r),{},{jira_account_id:e.target.value}))},placeholder:"Enter Jira account ID"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Hiring Date"),n.createElement("input",{type:"date",value:r.hiring_date,onChange:function(e){return l(j(j({},r),{},{hiring_date:e.target.value}))}})))),n.createElement("div",{className:"form-section"},n.createElement("h4",null,"Employment Information"),n.createElement("div",{className:"form-grid"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Employment Type"),n.createElement("select",{value:r.employment_type,onChange:function(e){var t="full_time"===e.target.value?40:20;l(j(j({},r),{},{employment_type:e.target.value,capacity:t}))}},n.createElement("option",{value:"full_time"},"Full Time (40h/week)"),n.createElement("option",{value:"part_time"},"Part Time (20h/week)"))),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Capacity (hours/week)"),n.createElement("input",{type:"number",value:r.capacity,onChange:function(e){return l(j(j({},r),{},{capacity:parseInt(e.target.value)||0}))},min:"1",max:"60"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"PTO Accountability Type"),n.createElement("select",{value:r.pto_accountability_type,onChange:function(e){return l(j(j({},r),{},{pto_accountability_type:e.target.value}))}},n.createElement("option",{value:"standard_year"},"Standard Year"),n.createElement("option",{value:"work_year"},"Work Year"))))),n.createElement("div",{className:"form-section"},n.createElement("h4",null,"Permissions"),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"checkbox-label"},n.createElement("input",{type:"checkbox",checked:r.isAdmin,onChange:function(e){return l(j(j({},r),{},{isAdmin:e.target.checked}))}}),n.createElement("span",null,"Is Admin")))),n.createElement("div",{className:"form-section"},n.createElement("h4",null,"Team Memberships"),n.createElement("div",{className:"team-memberships"},0===o.length?n.createElement("p",null,"No teams available. Create teams first."):o.map((function(e){var t=r.team_memberships.find((function(t){return t.team_id===(e.team_id||e.id)}));return n.createElement("div",{key:e.team_id||e.id,className:"team-membership-item"},n.createElement("div",{className:"team-info"},n.createElement(N.A,{size:16}),n.createElement("span",null,e.team_name||e.name)),n.createElement("select",{value:(null==t?void 0:t.role)||"",onChange:function(t){return a=e.team_id||e.id,n=t.target.value,c=r.team_memberships.findIndex((function(e){return e.team_id===a})),i=A(r.team_memberships),-1!==c?n?i[c]={team_id:a,role:n}:i.splice(c,1):n&&i.push({team_id:a,role:n}),void l(j(j({},r),{},{team_memberships:i}));var a,n,c,i}},n.createElement("option",{value:""},"No Role"),n.createElement("option",{value:"Member"},"Member"),n.createElement("option",{value:"Manager"},"Manager"),n.createElement("option",{value:"Executive Manager"},"Executive Manager")))})))),n.createElement("div",{className:"form-section"},n.createElement("h4",null,"Standard Availability"),n.createElement("div",{className:"availability-grid"},Object.entries(r.standard_availability).map((function(e){var t=R(e,2),a=t[0],r=t[1];return n.createElement("div",{key:a,className:"availability-day"},n.createElement("div",{className:"day-header"},n.createElement("label",{className:"checkbox-label"},n.createElement("input",{type:"checkbox",checked:r.working,onChange:function(e){return u(a,"working",e.target.checked)}}),n.createElement("span",null,a.charAt(0).toUpperCase()+a.slice(1)))),r.working&&n.createElement("div",{className:"hours-input"},n.createElement("input",{type:"number",value:r.hours,onChange:function(e){return u(a,"hours",parseInt(e.target.value)||0)},min:"0",max:"12",step:"0.5"}),n.createElement("span",null,"hours")))})))),n.createElement("div",{className:"form-section"},n.createElement("h4",null,"PTO Allowances (Days per Period)"),n.createElement("div",{className:"form-grid"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Vacation Days"),n.createElement("input",{type:"number",value:r.pto_available_in_the_period.vacation,onChange:function(e){return l(j(j({},r),{},{pto_available_in_the_period:j(j({},r.pto_available_in_the_period),{},{vacation:parseInt(e.target.value)||0}),remaining_pto_days_in_period:j(j({},r.remaining_pto_days_in_period),{},{vacation:parseInt(e.target.value)||0})}))},min:"0"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Holiday Days"),n.createElement("input",{type:"number",value:r.pto_available_in_the_period.holiday,onChange:function(e){return l(j(j({},r),{},{pto_available_in_the_period:j(j({},r.pto_available_in_the_period),{},{holiday:parseInt(e.target.value)||0}),remaining_pto_days_in_period:j(j({},r.remaining_pto_days_in_period),{},{holiday:parseInt(e.target.value)||0})}))},min:"0"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Personal Days"),n.createElement("input",{type:"number",value:r.pto_available_in_the_period.personal,onChange:function(e){return l(j(j({},r),{},{pto_available_in_the_period:j(j({},r.pto_available_in_the_period),{},{personal:parseInt(e.target.value)||0}),remaining_pto_days_in_period:j(j({},r.remaining_pto_days_in_period),{},{personal:parseInt(e.target.value)||0})}))},min:"0"})))))),n.createElement("div",{className:"modal-footer"},n.createElement("button",{className:"btn btn-secondary",onClick:a,disabled:s},"Cancel"),n.createElement("button",{className:"btn btn-primary",onClick:c,disabled:s||!r.display_name.trim()||!r.email_address.trim()},s?"Saving...":i?"Update User":"Create User"))))};const B=function(e){var t=e.isOpen,a=e.onClose,r=e.showNotification,c=e.onRefresh,i=R((0,n.useState)("teams"),2),s=i[0],o=i[1],u=R((0,n.useState)(!1),2),m=u[0],d=u[1],p=R((0,n.useState)([]),2),f=p[0],E=p[1],b=R((0,n.useState)([]),2),T=b[0],D=b[1],P=R((0,n.useState)(""),2),x=P[0],q=P[1],F=R((0,n.useState)(!1),2),z=F[0],B=F[1],G=R((0,n.useState)(!1),2),J=G[0],V=G[1],W=R((0,n.useState)(null),2),H=W[0],Y=W[1],K=R((0,n.useState)(null),2),$=K[0],Q=K[1],X=R((0,n.useState)(!1),2),Z=X[0],ee=X[1],te=R((0,n.useState)([]),2),ae=te[0],ne=te[1],re=R((0,n.useState)([]),2),le=re[0],ce=re[1],ie=R((0,n.useState)(!1),2),se=ie[0],oe=ie[1],ue=R((0,n.useState)({team_id:"",team_name:"",team_department:"",team_business_unit:"",team_manager_name:"",team_manager_id:"",team_manager_email:"",team_executive_manager_name:"",team_executive_manager_id:"",team_executive_manager_email:""}),2),me=ue[0],de=ue[1],pe=R((0,n.useState)({user_id:"",jira_account_id:"",display_name:"",email_address:"",team_memberships:[],employment_type:"full_time",capacity:40,standard_availability:{monday:{working:!0,hours:8},tuesday:{working:!0,hours:8},wednesday:{working:!0,hours:8},thursday:{working:!0,hours:8},friday:{working:!0,hours:8},saturday:{working:!1,hours:0},sunday:{working:!1,hours:0}},isAdmin:!1,isManager:[],isExecutive_Manager:[],pto_accountability_type:"standard_year",pto_available_in_the_period:{vacation:20,holiday:10,personal:1},hiring_date:"",used_pto_days_in_period:{vacation:0,holiday:0,personal:0},remaining_pto_days_in_period:{vacation:20,holiday:10,personal:1}}),2),fe=pe[0],ve=pe[1];(0,n.useEffect)((function(){t&&ye()}),[t]);var ye=function(){var e=U(I().m((function e(){var t,a,n,l,c;return I().w((function(e){for(;;)switch(e.n){case 0:return d(!0),e.p=1,e.n=2,Promise.all([(0,y.invoke)("getAllTeams"),(0,y.invoke)("getAllUsers")]);case 2:t=e.v,a=R(t,2),n=a[0],l=a[1],n.success&&E(n.data||[]),l.success&&D(l.data||[]),e.n=4;break;case 3:e.p=3,c=e.v,console.error("Error loading data:",c),r("Error loading data","error");case 4:return e.p=4,d(!1),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),Ee=function(){de({team_id:"",team_name:"",team_department:"",team_business_unit:"",team_manager_name:"",team_manager_id:"",team_manager_email:"",team_executive_manager_name:"",team_executive_manager_id:"",team_executive_manager_email:""}),Y(null)},be=function(){ve({user_id:"",jira_account_id:"",display_name:"",email_address:"",team_memberships:[],employment_type:"full_time",capacity:40,standard_availability:{monday:{working:!0,hours:8},tuesday:{working:!0,hours:8},wednesday:{working:!0,hours:8},thursday:{working:!0,hours:8},friday:{working:!0,hours:8},saturday:{working:!1,hours:0},sunday:{working:!1,hours:0}},isAdmin:!1,isManager:[],isExecutive_Manager:[],pto_accountability_type:"standard_year",pto_available_in_the_period:{vacation:20,holiday:10,personal:1},hiring_date:"",used_pto_days_in_period:{vacation:0,holiday:0,personal:0},remaining_pto_days_in_period:{vacation:20,holiday:10,personal:1}}),Q(null)},ge=function(){var e=U(I().m((function e(){var t,a,n;return I().w((function(e){for(;;)switch(e.n){case 0:return d(!0),e.p=1,t=j(j({},me),{},{updated_at:(new Date).toISOString()}),H?t.team_id=H.team_id||H.id:t.created_at=(new Date).toISOString(),e.n=2,(0,y.invoke)(H?"updateTeam":"createTeam",t);case 2:(a=e.v).success?(r("Team ".concat(H?"updated":"created"," successfully"),"success"),B(!1),Ee(),ye(),null==c||c()):r(a.message||"Error saving team","error"),e.n=4;break;case 3:e.p=3,n=e.v,console.error("Error saving team:",n),r("Error saving team","error");case 4:return e.p=4,d(!1),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=U(I().m((function e(t){var a,n;return I().w((function(e){for(;;)switch(e.n){case 0:if(window.confirm('Are you sure you want to delete team "'.concat(t.team_name||t.name,'"?'))){e.n=1;break}return e.a(2);case 1:return d(!0),e.p=2,e.n=3,(0,y.invoke)("deleteTeam",{team_id:t.team_id||t.id});case 3:(a=e.v).success?(r("Team deleted successfully","success"),ye(),null==c||c()):r(a.message||"Error deleting team","error"),e.n=5;break;case 4:e.p=4,n=e.v,console.error("Error deleting team:",n),r("Error deleting team","error");case 5:return e.p=5,d(!1),e.f(5);case 6:return e.a(2)}}),e,null,[[2,4,5,6]])})));return function(t){return e.apply(this,arguments)}}(),_e=function(){var e=U(I().m((function e(){var t,a,n;return I().w((function(e){for(;;)switch(e.n){case 0:return d(!0),e.p=1,t=j(j({},fe),{},{updated_at:(new Date).toISOString()}),$?t.user_id=$.user_id||$.id:t.created_at=(new Date).toISOString(),e.n=2,(0,y.invoke)($?"updateUser":"createUser",t);case 2:(a=e.v).success?(r("User ".concat($?"updated":"created"," successfully"),"success"),V(!1),be(),ye(),null==c||c()):r(a.message||"Error saving user","error"),e.n=4;break;case 3:e.p=3,n=e.v,console.error("Error saving user:",n),r("Error saving user","error");case 4:return e.p=4,d(!1),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),Ne=function(){var e=U(I().m((function e(t){var a,n;return I().w((function(e){for(;;)switch(e.n){case 0:if(window.confirm('Are you sure you want to delete user "'.concat(t.display_name,'"?'))){e.n=1;break}return e.a(2);case 1:return d(!0),e.p=2,e.n=3,(0,y.invoke)("deleteUser",{user_id:t.user_id||t.id});case 3:(a=e.v).success?(r("User deleted successfully","success"),ye(),null==c||c()):r(a.message||"Error deleting user","error"),e.n=5;break;case 4:e.p=4,n=e.v,console.error("Error deleting user:",n),r("Error deleting user","error");case 5:return e.p=5,d(!1),e.f(5);case 6:return e.a(2)}}),e,null,[[2,4,5,6]])})));return function(t){return e.apply(this,arguments)}}(),we=f.filter((function(e){return(e.team_name||e.name||"").toLowerCase().includes(x.toLowerCase())||(e.team_department||e.department||"").toLowerCase().includes(x.toLowerCase())})),ke=T.filter((function(e){return(e.display_name||"").toLowerCase().includes(x.toLowerCase())||(e.email_address||"").toLowerCase().includes(x.toLowerCase())})),Se=function(e,t){if(e&&0!==e.length){var a=Object.keys(e[0]),n=[];n.push(a.map((function(e){return'"'.concat(e,'"')})).join(","));var r,l=C(e);try{var c=function(){var e=r.value,t=a.map((function(t){var a=e[t];return null==a?'""':'"'.concat(a.toString().replace(/"/g,'""'),'"')}));n.push(t.join(","))};for(l.s();!(r=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}var i=n.join("\n"),s=new Blob([i],{type:"text/csv"}),o=URL.createObjectURL(s),u=document.createElement("a");u.href=o,u.download=t,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(o)}},Oe=function(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(e){try{var n=e.target.result.split("\n").filter((function(e){return e.trim()}));if(0===n.length)throw new Error("Empty CSV file");for(var r=n[0].split(",").map((function(e){return e.replace(/"/g,"").trim()})),l=[],c=function(){var e=n[i].split(",").map((function(e){return e.replace(/"/g,"").trim()})),t={};r.forEach((function(a,n){t[a]=e[n]||""})),l.push(t)},i=1;i<n.length;i++)c();t(l)}catch(e){a(e)}},n.onerror=function(){return a(new Error("Failed to read file"))},n.readAsText(e)}))},Te=function(){var e=U(I().m((function e(t){var a,n,l,c,i,s,o,u,m,p;return I().w((function(e){for(;;)switch(e.n){case 0:if(a=t.target.files[0]){e.n=1;break}return e.a(2);case 1:return d(!0),e.p=2,e.n=3,Oe(a);case 3:n=e.v,l=0,c=C(n),e.p=4,c.s();case 5:if((i=c.n()).done){e.n=8;break}return s=i.value,o=[],s.team_memberships&&(o=s.team_memberships.split(";").map((function(e){var t=R(e.split(":"),2),a=t[0],n=t[1],r=f.find((function(e){return e.team_name===a||e.team_id===a}));return{team_id:r?r.team_id:a,team_name:r?r.team_name:a,role:n||"Member"}}))),u={user_id:s.user_id||"user-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),jira_account_id:s.jira_account_id||"",display_name:s.display_name||"",email_address:s.email_address||"",employment_type:s.employment_type||"full_time",capacity:parseInt(s.capacity)||40,team_memberships:o,standard_availability:{monday:{working:!0,hours:8},tuesday:{working:!0,hours:8},wednesday:{working:!0,hours:8},thursday:{working:!0,hours:8},friday:{working:!0,hours:8},saturday:{working:!1,hours:0},sunday:{working:!1,hours:0}}},e.n=6,(0,y.invoke)("createUser",u);case 6:e.v.success&&l++;case 7:e.n=5;break;case 8:e.n=10;break;case 9:e.p=9,m=e.v,c.e(m);case 10:return e.p=10,c.f(),e.f(10);case 11:r("Successfully imported ".concat(l," users")),loadUsers(),e.n=13;break;case 12:e.p=12,p=e.v,r("Failed to import users: ".concat(p.message),"error");case 13:return e.p=13,d(!1),t.target.value="",e.f(13);case 14:return e.a(2)}}),e,null,[[4,9,10,11],[2,12,13,14]])})));return function(t){return e.apply(this,arguments)}}(),Ae=function(){var e=U(I().m((function e(t){var a,n,l,c,i,s,o,u,m;return I().w((function(e){for(;;)switch(e.n){case 0:if(a=t.target.files[0]){e.n=1;break}return e.a(2);case 1:return d(!0),e.p=2,e.n=3,Oe(a);case 3:n=e.v,l=0,c=C(n),e.p=4,c.s();case 5:if((i=c.n()).done){e.n=8;break}return s=i.value,o={team_id:s.team_id||"team-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),team_name:s.team_name||"",team_department:s.team_department||"",team_business_unit:s.team_business_unit||"",team_manager_name:s.team_manager_name||"",team_manager_id:s.team_manager_id||"",team_manager_email:s.team_manager_email||"",team_executive_manager_name:s.team_executive_manager_name||"",team_executive_manager_id:s.team_executive_manager_id||"",team_executive_manager_email:s.team_executive_manager_email||""},e.n=6,(0,y.invoke)("createTeam",o);case 6:e.v.success&&l++;case 7:e.n=5;break;case 8:e.n=10;break;case 9:e.p=9,u=e.v,c.e(u);case 10:return e.p=10,c.f(),e.f(10);case 11:r("Successfully imported ".concat(l," teams")),loadTeams(),e.n=13;break;case 12:e.p=12,m=e.v,r("Failed to import teams: ".concat(m.message),"error");case 13:return e.p=13,d(!1),t.target.value="",e.f(13);case 14:return e.a(2)}}),e,null,[[4,9,10,11],[2,12,13,14]])})));return function(t){return e.apply(this,arguments)}}(),Ce=function(){var e=U(I().m((function e(){var t,a,n,l,c,i,s=arguments;return I().w((function(e){for(;;)switch(e.n){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:0,oe(!0),e.p=1,e.n=2,(0,y.invoke)("getInternalJiraUsers",{startAt:t,maxResults:50});case 2:(a=e.v).success||a.users?(n=a.users||a.data||[],l=T.map((function(e){return e.jira_account_id||e.email_address})).filter(Boolean),c=n.filter((function(e){return!l.includes(e.accountId)&&!l.includes(e.emailAddress)})),ne(c)):r("Failed to load Jira users","error"),e.n=4;break;case 3:e.p=3,i=e.v,r("Failed to load Jira users: ".concat(i.message),"error");case 4:return e.p=4,oe(!1),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),De=function(){var e=U(I().m((function e(){var t,a,n,l,c;return I().w((function(e){for(;;)switch(e.n){case 0:if(0!==le.length){e.n=1;break}return r("Please select users to import","error"),e.a(2);case 1:return d(!0),e.p=2,e.n=3,(0,y.invoke)("bulkImportUsersFromJira",{selectedUserIds:le.map((function(e){return e.accountId})),defaultTeamId:null,defaultDepartment:""});case 3:if(!(t=e.v).success){e.n=4;break}a=t.data,n=a.importedCount,l=a.skippedCount,r("Successfully imported ".concat(n," users. ").concat(l>0?"".concat(l," users were already in the system."):""),"success"),ce([]),ee(!1),loadUsers(),Ce(0),e.n=5;break;case 4:throw new Error(t.message||"Failed to import users");case 5:e.n=7;break;case 6:e.p=6,c=e.v,r("Failed to import users: ".concat(c.message),"error");case 7:return e.p=7,d(!1),e.f(7);case 8:return e.a(2)}}),e,null,[[2,6,7,8]])})));return function(){return e.apply(this,arguments)}}();return t?n.createElement(n.Fragment,null,n.createElement("div",{className:"modal-overlay"},n.createElement("div",{className:"modal-content",style:{maxWidth:"1200px",width:"90vw",height:"80vh"}},n.createElement("div",{className:"modal-header"},n.createElement("h2",null,"Team & User Management"),n.createElement("div",{className:"header-actions"},n.createElement("button",{onClick:"teams"===s?function(){if(0!==f.length){var e=f.map((function(e){return{team_id:e.team_id||e.id,team_name:e.team_name||"",team_department:e.team_department||"",team_business_unit:e.team_business_unit||"",team_manager_name:e.team_manager_name||"",team_manager_id:e.team_manager_id||"",team_manager_email:e.team_manager_email||"",team_executive_manager_name:e.team_executive_manager_name||"",team_executive_manager_id:e.team_executive_manager_id||"",team_executive_manager_email:e.team_executive_manager_email||"",created_at:e.created_at||"",updated_at:e.updated_at||""}}));Se(e,"teams-export-".concat((new Date).toISOString().split("T")[0],".csv")),r("Teams exported successfully!")}else r("No teams to export","error")}:function(){if(0!==T.length){var e=T.map((function(e){return{user_id:e.user_id||e.id,jira_account_id:e.jira_account_id||"",display_name:e.display_name||"",email_address:e.email_address||"",employment_type:e.employment_type||"full_time",capacity:e.capacity||40,team_memberships:Array.isArray(e.team_memberships)?e.team_memberships.map((function(e){return"".concat(e.team_name||e.team_id,":").concat(e.role||"Member")})).join(";"):"",created_at:e.created_at||"",updated_at:e.updated_at||""}}));Se(e,"users-export-".concat((new Date).toISOString().split("T")[0],".csv")),r("Users exported successfully!")}else r("No users to export","error")},disabled:m,className:"btn btn-secondary"},n.createElement(g.A,{size:16}),"Export ","teams"===s?"Teams":"Users"," CSV"),n.createElement("label",{className:"btn btn-secondary",style:{marginLeft:8}},n.createElement("input",{type:"file",accept:".csv",onChange:"teams"===s?Ae:Te,style:{display:"none"},disabled:m}),n.createElement(h.A,{size:16}),"Import ","teams"===s?"Teams":"Users"," CSV"),"users"===s&&n.createElement("button",{onClick:function(){ee(!0),Ce(0)},disabled:m,className:"btn btn-primary",style:{marginLeft:8}},n.createElement(_.A,{size:16}),"Import from Jira"),n.createElement("button",{className:"modal-close",onClick:a},"×"))),n.createElement("div",{className:"tabs-container"},n.createElement("div",{className:"tabs-nav"},n.createElement("button",{className:"tab ".concat("teams"===s?"active":""),onClick:function(){return o("teams")}},n.createElement(N.A,{size:16}),"Teams (",f.length,")"),n.createElement("button",{className:"tab ".concat("users"===s?"active":""),onClick:function(){return o("users")}},n.createElement(l.A,{size:16}),"Users (",T.length,")")),n.createElement("div",{className:"tab-content"},n.createElement("div",{className:"action-bar"},n.createElement("div",{className:"search-container"},n.createElement(w.A,{size:16}),n.createElement("input",{type:"text",placeholder:"Search ".concat(s,"..."),value:x,onChange:function(e){return q(e.target.value)},className:"search-input"})),n.createElement("div",{className:"action-buttons"},n.createElement("button",{className:"btn btn-primary",onClick:"teams"===s?function(){Ee(),B(!0)}:function(){be(),V(!0)}},n.createElement(h.A,{size:16}),"Add ","teams"===s?"Team":"User"))),"teams"===s&&n.createElement("div",{className:"data-table-container"},m?n.createElement("div",{className:"loading-state"},"Loading teams..."):0===we.length?n.createElement("div",{className:"empty-state"},n.createElement(N.A,{size:48}),n.createElement("h3",null,"No teams found"),n.createElement("p",null,"Create your first team to get started")):n.createElement("div",{className:"data-table"},n.createElement("div",{className:"table-header"},n.createElement("div",null,"Team Name"),n.createElement("div",null,"Department"),n.createElement("div",null,"Business Unit"),n.createElement("div",null,"Manager"),n.createElement("div",null,"Actions")),we.map((function(e){return n.createElement("div",{key:e.team_id||e.id,className:"table-row"},n.createElement("div",{className:"cell-primary"},n.createElement(N.A,{size:16}),e.team_name||e.name),n.createElement("div",null,e.team_department||e.department||"-"),n.createElement("div",null,e.team_business_unit||e.business_unit||"-"),n.createElement("div",null,e.team_manager_name||"-"),n.createElement("div",{className:"actions-cell"},n.createElement("button",{className:"btn-icon",onClick:function(){return function(e){de({team_id:e.team_id||e.id,team_name:e.team_name||e.name||"",team_department:e.team_department||e.department||"",team_business_unit:e.team_business_unit||e.business_unit||"",team_manager_name:e.team_manager_name||"",team_manager_id:e.team_manager_id||"",team_manager_email:e.team_manager_email||"",team_executive_manager_name:e.team_executive_manager_name||"",team_executive_manager_id:e.team_executive_manager_id||"",team_executive_manager_email:e.team_executive_manager_email||""}),Y(e),B(!0)}(e)},title:"Edit team"},n.createElement(k.A,{size:14})),n.createElement("button",{className:"btn-icon btn-danger",onClick:function(){return he(e)},title:"Delete team"},n.createElement(S.A,{size:14}))))})))),"users"===s&&n.createElement("div",{className:"data-table-container"},m?n.createElement("div",{className:"loading-state"},"Loading users..."):0===ke.length?n.createElement("div",{className:"empty-state"},n.createElement(O.A,{size:48}),n.createElement("h3",null,"No users found"),n.createElement("p",null,"Add your first user to get started")):n.createElement("div",{className:"data-table"},n.createElement("div",{className:"table-header"},n.createElement("div",null,"Display Name"),n.createElement("div",null,"Email"),n.createElement("div",null,"Employment Type"),n.createElement("div",null,"Teams"),n.createElement("div",null,"Admin"),n.createElement("div",null,"Actions")),ke.map((function(e){return n.createElement("div",{key:e.user_id||e.id,className:"table-row"},n.createElement("div",{className:"cell-primary"},n.createElement(O.A,{size:16}),e.display_name),n.createElement("div",null,e.email_address||"-"),n.createElement("div",null,n.createElement("span",{className:"badge ".concat("full_time"===e.employment_type?"badge-success":"badge-warning")},"full_time"===e.employment_type?"Full Time":"Part Time")),n.createElement("div",null,(e.team_memberships||[]).length," teams"),n.createElement("div",null,e.isAdmin?n.createElement("span",{className:"badge badge-info"},"Admin"):"-"),n.createElement("div",{className:"actions-cell"},n.createElement("button",{className:"btn-icon",onClick:function(){return function(e){ve({user_id:e.user_id||e.id,jira_account_id:e.jira_account_id||"",display_name:e.display_name||"",email_address:e.email_address||"",team_memberships:e.team_memberships||[],employment_type:e.employment_type||"full_time",capacity:e.capacity||40,standard_availability:e.standard_availability||{monday:{working:!0,hours:8},tuesday:{working:!0,hours:8},wednesday:{working:!0,hours:8},thursday:{working:!0,hours:8},friday:{working:!0,hours:8},saturday:{working:!1,hours:0},sunday:{working:!1,hours:0}},isAdmin:e.isAdmin||!1,isManager:e.isManager||[],isExecutive_Manager:e.isExecutive_Manager||[],pto_accountability_type:e.pto_accountability_type||"standard_year",pto_available_in_the_period:e.pto_available_in_the_period||{vacation:20,holiday:10,personal:1},hiring_date:e.hiring_date||"",used_pto_days_in_period:e.used_pto_days_in_period||{vacation:0,holiday:0,personal:0},remaining_pto_days_in_period:e.remaining_pto_days_in_period||{vacation:20,holiday:10,personal:1}}),Q(e),V(!0)}(e)},title:"Edit user"},n.createElement(k.A,{size:14})),n.createElement("button",{className:"btn-icon btn-danger",onClick:function(){return Ne(e)},title:"Delete user"},n.createElement(S.A,{size:14}))))})))))))),z&&n.createElement(L,{isOpen:z,onClose:function(){B(!1),Ee()},teamData:me,setTeamData:de,onSave:ge,isEditing:!!H,loading:m,users:T}),J&&n.createElement(M,{isOpen:J,onClose:function(){V(!1),be()},userData:fe,setUserData:ve,onSave:_e,isEditing:!!$,loading:m,teams:f}),Z&&n.createElement("div",{className:"modal-overlay"},n.createElement("div",{className:"modal-content",style:{maxWidth:"800px"}},n.createElement("div",{className:"modal-header"},n.createElement("h3",null,"Import Users from Jira"),n.createElement("div",{className:"jira-import-actions"},n.createElement("button",{onClick:function(){return Ce(0)},disabled:se,className:"btn btn-secondary"},n.createElement(w.A,{size:16,className:se?"spin":""}),"Refresh"),le.length>0&&n.createElement("button",{onClick:De,disabled:m,className:"btn btn-primary"},n.createElement(_.A,{size:16}),"Import ",le.length," Selected",m&&" (Importing...)")),n.createElement("button",{className:"modal-close-btn",onClick:function(){return ee(!1)}},n.createElement(v.A,{size:20}))),n.createElement("div",{className:"modal-body"},se&&0===ae.length?n.createElement("div",{className:"loading-state"},n.createElement("div",{className:"loading-spinner"}),n.createElement("p",null,"Loading Jira users...")):0===ae.length?n.createElement("div",{className:"empty-state"},n.createElement("div",{className:"empty-icon"},"✅"),n.createElement("h4",null,"All Jira Users Imported"),n.createElement("p",null,"All available Jira users from your organization are already in the system.")):n.createElement("div",{className:"jira-users-list"},n.createElement("div",{className:"list-header"},n.createElement("p",null,"Select Jira users to import into the PTO system. Users already in the system will not be shown.")),ae.map((function(e){var t;return n.createElement("div",{key:e.accountId,className:"jira-user-item ".concat(le.some((function(t){return t.accountId===e.accountId}))?"selected":""),onClick:function(){return function(e){ce((function(t){return t.some((function(t){return t.accountId===e.accountId}))?t.filter((function(t){return t.accountId!==e.accountId})):[].concat(A(t),[e])}))}(e)}},n.createElement("div",{className:"user-avatar"},null!==(t=e.avatarUrls)&&void 0!==t&&t["32x32"]?n.createElement("img",{src:e.avatarUrls["32x32"],alt:e.displayName,width:"32",height:"32"}):n.createElement(O.A,{size:20})),n.createElement("div",{className:"user-info"},n.createElement("div",{className:"user-name"},e.displayName),n.createElement("div",{className:"user-email"},e.emailAddress)),n.createElement("div",{className:"selection-indicator"},le.some((function(t){return t.accountId===e.accountId}))&&"✓"))}))))))):null};var G=a(4471),J=a(7235),V=a(4934),W=a(7946),H=a(5653);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(Object(a),!0).forEach((function(t){Q(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Q(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=Y(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function X(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function l(a,n,r,l){var s=n&&n.prototype instanceof i?n:i,o=Object.create(s.prototype);return Z(o,"_invoke",function(a,n,r){var l,i,s,o=0,u=r||[],m=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,a){return l=t,i=0,s=e,d.n=a,c}};function p(a,n){for(i=a,s=n,t=0;!m&&o&&!r&&t<u.length;t++){var r,l=u[t],p=d.p,f=l[2];a>3?(r=f===n)&&(s=l[(i=l[4])?5:(i=3,3)],l[4]=l[5]=e):l[0]<=p&&((r=a<2&&p<l[1])?(i=0,d.v=n,d.n=l[1]):p<f&&(r=a<3||l[0]>n||n>f)&&(l[4]=a,l[5]=n,d.n=f,i=0))}if(r||a>1)return c;throw m=!0,n}return function(r,u,f){if(o>1)throw TypeError("Generator is already running");for(m&&1===u&&p(u,f),i=u,s=f;(t=i<2?e:s)||!m;){l||(i?i<3?(i>1&&(d.n=-1),p(i,s)):d.n=s:d.v=s);try{if(o=2,l){if(i||(r="next"),t=l[r]){if(!(t=t.call(l,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=l.return)&&t.call(l),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);l=e}else if((t=(m=d.n<0)?s:a.call(n,d))!==c)break}catch(t){l=e,i=1,s=t}finally{o=1}}return{value:t,done:m}}}(a,r,l),!0),o}var c={};function i(){}function s(){}function o(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Z(t={},n,(function(){return this})),t),m=o.prototype=i.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,Z(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=o,Z(m,"constructor",o),Z(o,"constructor",s),s.displayName="GeneratorFunction",Z(o,r,"GeneratorFunction"),Z(m),Z(m,r,"Generator"),Z(m,n,(function(){return this})),Z(m,"toString",(function(){return"[object Generator]"})),(X=function(){return{w:l,m:d}})()}function Z(e,t,a,n){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}Z=function(e,t,a,n){if(t)r?r(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a;else{var l=function(t,a){Z(e,t,(function(e){return this._invoke(t,a,e)}))};l("next",0),l("throw",1),l("return",2)}},Z(e,t,a,n)}function ee(e,t,a,n,r,l,c){try{var i=e[l](c),s=i.value}catch(e){return void a(e)}i.done?t(s):Promise.resolve(s).then(n,r)}function te(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var l=e.apply(t,a);function c(e){ee(l,n,r,c,i,"next",e)}function i(e){ee(l,n,r,c,i,"throw",e)}c(void 0)}))}}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,i=[],s=!0,o=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;s=!1}else for(;!(s=(n=l.call(a)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){o=!0,r=e}finally{try{if(!s&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(o)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ne(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ne(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}const re=function(e){var t=e.currentUser,a=e.showNotification,r=e.isAdmin,l=ae((0,n.useState)(null),2),c=l[0],i=l[1],s=ae((0,n.useState)({startDate:new Date((new Date).getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date((new Date).getFullYear(),11,31).toISOString().split("T")[0]}),2),u=s[0],m=s[1],d=ae((0,n.useState)([]),2),p=d[0],f=d[1],v=ae((0,n.useState)(!1),2),b=(v[0],v[1]),g=ae((0,n.useState)(null),2),h=g[0],_=g[1];(0,n.useEffect)((function(){c&&N()}),[c,u]);var N=function(){var e=te(X().m((function e(){var t;return X().w((function(e){for(;;)switch(e.n){case 0:return b(!0),e.p=1,e.n=2,(0,y.invoke)("getPTORequests",{requester_id:c.accountId,startDate:u.startDate,endDate:u.endDate});case 2:(t=e.v).success&&f(t.data||[]),e.n=4;break;case 3:e.p=3,e.v,a("Failed to load PTO requests","error");case 4:return e.p=4,b(!1),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=te(X().m((function e(t){return X().w((function(e){for(;;)switch(e.n){case 0:a("PTO request updated successfully"),N();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=te(X().m((function e(n){var r;return X().w((function(e){for(;;)switch(e.n){case 0:if(window.confirm("Are you sure you want to delete this PTO request?")){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,(0,y.invoke)("adminDeletePTORequest",{requestId:n.id,adminId:t.accountId,reason:"Admin deletion"});case 2:(r=e.v).success?(a("PTO request deleted successfully"),N()):a(r.message||"Failed to delete request","error"),e.n=4;break;case 3:e.p=3,e.v,a("Failed to delete PTO request","error");case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(t){return e.apply(this,arguments)}}(),O={totalDays:p.reduce((function(e,t){return e+(t.total_days||0)}),0),approved:p.filter((function(e){return"approved"===e.status})).length,pending:p.filter((function(e){return"pending"===e.status})).length,declined:p.filter((function(e){return"declined"===e.status})).length};return n.createElement("div",{className:"user-pto-management"},n.createElement("div",{className:"user-pto-header"},n.createElement("h2",null,"User PTO Management"),n.createElement("div",{className:"user-pto-controls"},n.createElement(E.A,{selectedUser:c,onSelect:i,placeholder:"Search and select user",useBackendSearch:!0}),n.createElement("div",{className:"date-range-filter"},n.createElement("input",{type:"date",value:u.startDate,onChange:function(e){return m((function(t){return $($({},t),{},{startDate:e.target.value})}))},className:"form-control"}),n.createElement("span",null,"to"),n.createElement("input",{type:"date",value:u.endDate,onChange:function(e){return m((function(t){return $($({},t),{},{endDate:e.target.value})}))},className:"form-control"})))),c&&n.createElement(n.Fragment,null,n.createElement("div",{className:"summary-cards"},n.createElement("div",{className:"summary-card"},n.createElement("div",{className:"card-icon"},n.createElement(o.A,{size:24})),n.createElement("div",{className:"card-content"},n.createElement("div",{className:"card-value"},O.totalDays),n.createElement("div",{className:"card-label"},"Total PTO Days"))),n.createElement("div",{className:"summary-card approved"},n.createElement("div",{className:"card-icon"},n.createElement(G.A,{size:24})),n.createElement("div",{className:"card-content"},n.createElement("div",{className:"card-value"},O.approved),n.createElement("div",{className:"card-label"},"Approved"))),n.createElement("div",{className:"summary-card pending"},n.createElement("div",{className:"card-icon"},n.createElement(J.A,{size:24})),n.createElement("div",{className:"card-content"},n.createElement("div",{className:"card-value"},O.pending),n.createElement("div",{className:"card-label"},"Pending")))),n.createElement("div",{className:"requests-table-container"},n.createElement("table",{className:"requests-table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"PTO Date"),n.createElement("th",null,"Leave Type"),n.createElement("th",null,"Period"),n.createElement("th",null,"Days"),n.createElement("th",null,"Reason"),n.createElement("th",null,"Status"),r&&n.createElement("th",null,"Actions"))),n.createElement("tbody",null,p.map((function(e){return n.createElement("tr",{key:e.id},n.createElement("td",null,new Date(e.start_date).toLocaleDateString()),n.createElement("td",null,n.createElement("span",{className:"leave-type ".concat(e.leave_type)},e.leave_type)),n.createElement("td",null,e.start_date===e.end_date?new Date(e.start_date).toLocaleDateString():"".concat(new Date(e.start_date).toLocaleDateString()," - ").concat(new Date(e.end_date).toLocaleDateString())),n.createElement("td",null,e.total_days),n.createElement("td",null,e.reason),n.createElement("td",null,n.createElement("span",{className:"status-badge status-".concat(e.status)},e.status)),r&&n.createElement("td",{className:"actions"},n.createElement("button",{onClick:function(){return function(e){_(e)}(e)},className:"action-btn edit",title:"Edit request"},n.createElement(V.A,{size:16})),n.createElement("button",{onClick:function(){return k(e)},className:"action-btn delete",title:"Delete request"},n.createElement(S.A,{size:16}))))})),0===p.length&&n.createElement("tr",null,n.createElement("td",{colSpan:r?7:6,className:"empty-state"},n.createElement("div",{className:"empty-content"},n.createElement(o.A,{size:24}),n.createElement("p",null,"No PTO requests found for this period")))))))),!c&&n.createElement("div",{className:"empty-state"},n.createElement("div",{className:"empty-content"},n.createElement(W.A,{size:32}),n.createElement("p",null,"Select a user to view their PTO requests"))),h&&n.createElement(H.A,{request:h,onClose:function(){return _(null)},onSave:w,currentUser:t}))};function le(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function l(a,n,r,l){var s=n&&n.prototype instanceof i?n:i,o=Object.create(s.prototype);return ce(o,"_invoke",function(a,n,r){var l,i,s,o=0,u=r||[],m=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,a){return l=t,i=0,s=e,d.n=a,c}};function p(a,n){for(i=a,s=n,t=0;!m&&o&&!r&&t<u.length;t++){var r,l=u[t],p=d.p,f=l[2];a>3?(r=f===n)&&(s=l[(i=l[4])?5:(i=3,3)],l[4]=l[5]=e):l[0]<=p&&((r=a<2&&p<l[1])?(i=0,d.v=n,d.n=l[1]):p<f&&(r=a<3||l[0]>n||n>f)&&(l[4]=a,l[5]=n,d.n=f,i=0))}if(r||a>1)return c;throw m=!0,n}return function(r,u,f){if(o>1)throw TypeError("Generator is already running");for(m&&1===u&&p(u,f),i=u,s=f;(t=i<2?e:s)||!m;){l||(i?i<3?(i>1&&(d.n=-1),p(i,s)):d.n=s:d.v=s);try{if(o=2,l){if(i||(r="next"),t=l[r]){if(!(t=t.call(l,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=l.return)&&t.call(l),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);l=e}else if((t=(m=d.n<0)?s:a.call(n,d))!==c)break}catch(t){l=e,i=1,s=t}finally{o=1}}return{value:t,done:m}}}(a,r,l),!0),o}var c={};function i(){}function s(){}function o(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(ce(t={},n,(function(){return this})),t),m=o.prototype=i.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,ce(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=o,ce(m,"constructor",o),ce(o,"constructor",s),s.displayName="GeneratorFunction",ce(o,r,"GeneratorFunction"),ce(m),ce(m,r,"Generator"),ce(m,n,(function(){return this})),ce(m,"toString",(function(){return"[object Generator]"})),(le=function(){return{w:l,m:d}})()}function ce(e,t,a,n){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}ce=function(e,t,a,n){if(t)r?r(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a;else{var l=function(t,a){ce(e,t,(function(e){return this._invoke(t,a,e)}))};l("next",0),l("throw",1),l("return",2)}},ce(e,t,a,n)}function ie(e,t,a,n,r,l,c){try{var i=e[l](c),s=i.value}catch(e){return void a(e)}i.done?t(s):Promise.resolve(s).then(n,r)}function se(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var l=e.apply(t,a);function c(e){ie(l,n,r,c,i,"next",e)}function i(e){ie(l,n,r,c,i,"throw",e)}c(void 0)}))}}function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,i=[],s=!0,o=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;s=!1}else for(;!(s=(n=l.call(a)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){o=!0,r=e}finally{try{if(!s&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(o)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ue(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ue(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function me(e){var t=e.value,a=e.max;return n.createElement("div",{className:"progress-bar",style:{width:"100%",background:"#e0e0e0",borderRadius:6,margin:"10px 0"}},n.createElement("div",{style:{width:"".concat(t/a*100,"%"),background:"#00b38f",height:16,borderRadius:6,transition:"width 0.2s"}}))}const de=function(e){var t,a=e.isOpen,r=e.onClose,l=e.showNotification,c=oe((0,n.useState)(1),2),i=c[0],s=c[1],o=oe((0,n.useState)(null),2),u=(o[0],o[1]),m=oe((0,n.useState)([]),2),d=m[0],p=m[1],f=oe((0,n.useState)(null),2),E=f[0],b=f[1],g=oe((0,n.useState)(!1),2),h=g[0],_=g[1],N=oe((0,n.useState)(null),2),w=N[0],k=N[1],S=oe((0,n.useState)(!1),2),O=S[0],T=S[1],A=oe((0,n.useState)(!1),2),C=A[0],D=A[1],j=oe((0,n.useState)(!1),2),P=j[0],I=j[1],x=oe((0,n.useState)({currentBatch:0,totalBatches:1}),2),q=x[0],U=x[1],R=oe((0,n.useState)(null),2),F=R[0],z=R[1],L=oe((0,n.useState)(!1),2),M=L[0],B=L[1];(0,n.useEffect)((function(){a||(s(1),u(null),p([]),b(null),_(!1),k(null),T(!1),D(!1),I(!1),U({currentBatch:0,totalBatches:1}),z(null),B(!1))}),[a]);var G=function(){var e=se(le().m((function e(){var t,a;return le().w((function(e){for(;;)switch(e.n){case 0:return _(!0),k(null),T(!1),e.p=1,e.n=2,(0,y.invoke)("preValidatePTOImportData",{importData:d});case 2:t=e.v,k(t.summary),T(0===t.summary.missingRequesters.length&&0===t.summary.missingManagers.length&&0===t.summary.invalidLeaveTypes.length&&0===t.summary.invalidHours.length&&0===t.summary.invalidStatuses.length),l("Validation complete. Review the details below."),e.n=4;break;case 3:e.p=3,a=e.v,k(null),l("Validation failed: "+(a.message||a.toString()),"error");case 4:_(!1);case 5:return e.a(2)}}),e,null,[[1,3]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=se(le().m((function e(){var t,a;return le().w((function(e){for(;;)switch(e.n){case 0:return D(!0),z(null),e.p=1,e.n=2,(0,y.invoke)("preparePTOImportData",{importData:d});case 2:t=e.v,console.log("preparePTOImportData response:",t),t.success&&t.enrichedCount>0?(s(3),l("Data prepared. Ready for import.")):l(t.message||"Preparation failed.","error"),e.n=4;break;case 3:e.p=3,a=e.v,l("Preparation error: "+(a.message||a.toString()),"error");case 4:D(!1);case 5:return e.a(2)}}),e,null,[[1,3]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=se(le().m((function e(){var t,a,n,r,c;return le().w((function(e){for(;;)switch(e.n){case 0:I(!0),U({currentBatch:0,totalBatches:1}),z(null),e.p=1,t=!1,a=0,n=null;case 2:if(t){e.n=5;break}return e.n=3,(0,y.invoke)("importPTODailySchedulesChunked",{batchIndex:a});case 3:return(r=e.v).progress&&(U({currentBatch:r.progress.currentBatch,totalBatches:r.progress.totalBatches}),a=r.progress.currentBatch,r.progress.totalBatches),r.finished&&(n=r.result,t=!0),e.n=4,new Promise((function(e){return setTimeout(e,300)}));case 4:e.n=2;break;case 5:z(n),l(n.message,n.success?void 0:"error"),I(!1),s(4),e.n=7;break;case 6:e.p=6,c=e.v,l("Import failed: "+(c.message||c.toString()),"error"),I(!1);case 7:return e.a(2)}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}();return a?n.createElement("div",{className:"modal-overlay"},n.createElement("div",{className:"modal-content",style:{maxWidth:560,margin:"auto"}},n.createElement("div",{className:"modal-header"},n.createElement("h3",null,"Import PTO Daily Schedules"),n.createElement("button",{className:"modal-close",onClick:r},n.createElement(v.A,{size:20}))),n.createElement("div",{className:"modal-body"},1===i&&n.createElement(n.Fragment,null,n.createElement("h4",null,"Step 1: Upload CSV File"),n.createElement("input",{type:"file",accept:".csv",onChange:function(e){var t=e.target.files[0];if(!t)return b("No file selected."),p([]),void u(null);u(t),b(null);var a=new FileReader;a.onload=function(e){try{var t=e.target.result.trim().split("\n");if(t.length<2)throw new Error("File must have a header and at least one data row.");var a=t[0].split(",").map((function(e){return e.trim()})),n=t.slice(1).filter((function(e){return e.trim()})).map((function(e){var t=e.split(",").map((function(e){return e.trim().replace(/^"|"$/g,"")})),n={};return a.forEach((function(e,a){var r;return n[e]=null!==(r=t[a])&&void 0!==r?r:""})),n}));p(n),s(2)}catch(e){b(e.message),p([])}},a.onerror=function(){return b("Could not read file.")},a.readAsText(t)},disabled:h||C||P}),E&&n.createElement("div",{style:{color:"red",marginTop:10}},E),d.length>0&&n.createElement("div",{style:{marginTop:10}},n.createElement("div",null,"Records loaded: ",n.createElement("b",null,d.length)),n.createElement("button",{className:"btn btn-primary",onClick:G},"Validate Data"))),2===i&&n.createElement(n.Fragment,null,n.createElement("h4",null,"Step 2: Validate Data"),n.createElement("button",{className:"btn btn-secondary",onClick:G,disabled:h||C},"Run Validation"),h&&n.createElement("div",{style:{marginTop:10}},n.createElement("span",{className:"spinner"})," Validating..."),w&&n.createElement("div",{style:{marginTop:16}},n.createElement("div",null,n.createElement("b",null,"Total records:")," ",w.totalRecords),n.createElement("div",null,n.createElement("b",null,"Unique requesters:")," ",w.uniqueRequesters," (",w.missingRequesters.length," missing)"),w.missingRequesters.length>0&&n.createElement("div",{style:{color:"red"}},"Missing requesters: ",w.missingRequesters.join(", ")),n.createElement("div",null,n.createElement("b",null,"Unique managers:")," ",w.uniqueManagers," (",w.missingManagers.length," missing)"),w.missingManagers.length>0&&n.createElement("div",{style:{color:"red"}},"Missing managers: ",w.missingManagers.join(", ")),w.invalidLeaveTypes.length>0&&n.createElement("div",{style:{color:"red"}},"Invalid leave types: ",w.invalidLeaveTypes.map((function(e){return"row ".concat(e.row,": ").concat(e.value)})).join(", ")),w.invalidHours.length>0&&n.createElement("div",{style:{color:"red"}},"Invalid hours: ",w.invalidHours.map((function(e){return"row ".concat(e.row,": ").concat(e.value)})).join(", ")),w.invalidStatuses.length>0&&n.createElement("div",{style:{color:"red"}},"Invalid statuses: ",w.invalidStatuses.map((function(e){return"row ".concat(e.row,": ").concat(e.value)})).join(", ")),w.invalidDates.length>0&&n.createElement("div",{style:{color:"red"}},"Invalid dates: ",w.invalidDates.map((function(e){return"row ".concat(e.row,": ").concat(e.value)})).join(", ")),w.missingFields.length>0&&n.createElement("div",{style:{color:"red"}},"Missing fields: ",w.missingFields.map((function(e){return"row ".concat(e.row,": ").concat(e.fields.join(", "))})).join("; ")),w.duplicateRecords.length>0&&n.createElement("div",{style:{color:"orange"}},"Duplicates: ",w.duplicateRecords.map((function(e){return"row ".concat(e.row)})).join(", "))),n.createElement("div",{style:{marginTop:16}},n.createElement("button",{className:"btn btn-primary",disabled:!w||!O||C,onClick:J},"Prepare Data for Import"),n.createElement("button",{className:"btn",onClick:function(){return s(1)}},"Back"))),(null==F||null===(t=F.errors)||void 0===t?void 0:t.length)>0&&n.createElement("div",{className:"alert alert-danger"},n.createElement("ul",null,F.errors.map((function(e,t){return n.createElement("li",{key:t},"Row ".concat(e.row,": ").concat(e.error," ").concat(e.error2))})))),3===i&&n.createElement(n.Fragment,null,n.createElement("h4",null,"Step 3: Confirm and Import"),n.createElement("div",{className:"alert alert-warning",style:{marginBottom:16}},n.createElement("strong",null,"Warning:")," This import will ",n.createElement("b",null,"REPLACE ALL")," existing PTO daily schedules in the system!"),n.createElement("label",{style:{display:"block",margin:"10px 0"}},n.createElement("input",{type:"checkbox",checked:M,onChange:function(e){return B(e.target.checked)}})," I understand this will delete all current PTO daily schedules and replace with my uploaded data."),n.createElement("button",{className:"btn btn-primary",onClick:V,disabled:!M||P},P?"Importing...":"Start Import"),P&&n.createElement("div",{style:{marginTop:16}},n.createElement(me,{value:q.currentBatch,max:q.totalBatches}),n.createElement("div",null,"Importing batch ",q.currentBatch," of ",q.totalBatches,"..."))),4===i&&F&&n.createElement(n.Fragment,null,n.createElement("h4",null,"Import Complete"),n.createElement("div",{className:F.success?"alert alert-success":"alert alert-danger"},F.message),n.createElement("div",null,n.createElement("div",null,n.createElement("b",null,"Total records:")," ",F.data.totalRecords),n.createElement("div",null,n.createElement("b",null,"Imported:")," ",F.data.importedRecords),n.createElement("div",null,n.createElement("b",null,"Failed:")," ",F.data.failedRecords),F.data.errors&&F.data.errors.length>0&&n.createElement("div",null,n.createElement("b",null,"Errors:"),n.createElement("ul",null,F.data.errors.slice(0,10).map((function(e,t){return n.createElement("li",{key:t},e.record?"Row ".concat(e.record):""," ",e.error)}))))),n.createElement("button",{className:"btn btn-primary",onClick:r},"Close"))))):null};function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function fe(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=ke(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,c=!0,i=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return c=e.done,e},e:function(e){i=!0,l=e},f:function(){try{c||null==a.return||a.return()}finally{if(i)throw l}}}}function ve(e){return function(e){if(Array.isArray(e))return Se(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ee(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(a),!0).forEach((function(t){be(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ye(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function be(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=pe(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pe(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ge(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function l(a,n,r,l){var s=n&&n.prototype instanceof i?n:i,o=Object.create(s.prototype);return he(o,"_invoke",function(a,n,r){var l,i,s,o=0,u=r||[],m=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,a){return l=t,i=0,s=e,d.n=a,c}};function p(a,n){for(i=a,s=n,t=0;!m&&o&&!r&&t<u.length;t++){var r,l=u[t],p=d.p,f=l[2];a>3?(r=f===n)&&(s=l[(i=l[4])?5:(i=3,3)],l[4]=l[5]=e):l[0]<=p&&((r=a<2&&p<l[1])?(i=0,d.v=n,d.n=l[1]):p<f&&(r=a<3||l[0]>n||n>f)&&(l[4]=a,l[5]=n,d.n=f,i=0))}if(r||a>1)return c;throw m=!0,n}return function(r,u,f){if(o>1)throw TypeError("Generator is already running");for(m&&1===u&&p(u,f),i=u,s=f;(t=i<2?e:s)||!m;){l||(i?i<3?(i>1&&(d.n=-1),p(i,s)):d.n=s:d.v=s);try{if(o=2,l){if(i||(r="next"),t=l[r]){if(!(t=t.call(l,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,i<2&&(i=0)}else 1===i&&(t=l.return)&&t.call(l),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);l=e}else if((t=(m=d.n<0)?s:a.call(n,d))!==c)break}catch(t){l=e,i=1,s=t}finally{o=1}}return{value:t,done:m}}}(a,r,l),!0),o}var c={};function i(){}function s(){}function o(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(he(t={},n,(function(){return this})),t),m=o.prototype=i.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,o):(e.__proto__=o,he(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=o,he(m,"constructor",o),he(o,"constructor",s),s.displayName="GeneratorFunction",he(o,r,"GeneratorFunction"),he(m),he(m,r,"Generator"),he(m,n,(function(){return this})),he(m,"toString",(function(){return"[object Generator]"})),(ge=function(){return{w:l,m:d}})()}function he(e,t,a,n){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}he=function(e,t,a,n){if(t)r?r(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a;else{var l=function(t,a){he(e,t,(function(e){return this._invoke(t,a,e)}))};l("next",0),l("throw",1),l("return",2)}},he(e,t,a,n)}function _e(e,t,a,n,r,l,c){try{var i=e[l](c),s=i.value}catch(e){return void a(e)}i.done?t(s):Promise.resolve(s).then(n,r)}function Ne(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var l=e.apply(t,a);function c(e){_e(l,n,r,c,i,"next",e)}function i(e){_e(l,n,r,c,i,"throw",e)}c(void 0)}))}}function we(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,i=[],s=!0,o=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;s=!1}else for(;!(s=(n=l.call(a)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){o=!0,r=e}finally{try{if(!s&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(o)throw r}}return i}}(e,t)||ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(e,t){if(e){if("string"==typeof e)return Se(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Se(e,t):void 0}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function Oe(e){var t=e.title,a=e.children,r=e.onClose;return n.createElement("div",{className:"modal-overlay"},n.createElement("div",{className:"modal-content admin-modal"},n.createElement("div",{className:"modal-header"},n.createElement("h3",null,t),n.createElement("button",{className:"modal-close",onClick:r},n.createElement(v.A,{size:24}))),n.createElement("div",{className:"modal-body"},a)))}const Te=function(e){var t=e.currentUser,a=e.showNotification,v=we((0,n.useState)("overview"),2),g=v[0],h=v[1],_=we((0,n.useState)(!1),2),N=_[0],w=_[1],k=we((0,n.useState)([]),2),S=k[0],O=k[1],T=we((0,n.useState)([]),2),A=T[0],C=T[1],D=we((0,n.useState)([]),2),j=D[0],P=D[1],I=we((0,n.useState)([]),2),x=I[0],q=I[1],U=we((0,n.useState)([]),2),R=U[0],F=U[1],z=we((0,n.useState)(!1),2),L=z[0],M=z[1],G=we((0,n.useState)(!1),2),J=G[0],V=G[1],W=we((0,n.useState)(!1),2),H=W[0],Y=W[1],K=we((0,n.useState)(!1),2),$=K[0],Q=K[1],X=we((0,n.useState)(!1),2),Z=X[0],ee=X[1],te=we((0,n.useState)(!1),2),ae=te[0],ne=te[1],le=we((0,n.useState)(!1),2),ce=le[0],ie=le[1],se=we((0,n.useState)({startDate:"",endDate:"",requesterId:"",managerId:"",leaveType:""}),2),oe=se[0],ue=se[1],me=we((0,n.useState)({scope:"company",teamId:"",userId:"",startDate:"",endDate:"",status:"all"}),2),ye=me[0],be=me[1],he=we((0,n.useState)(Date.now()),2),_e=he[0],ke=he[1],Se=we((0,n.useState)({totalAdmins:0,totalTeams:0,totalUsers:0,totalRequests:0,approvedRequests:0,pendingRequests:0,declinedRequests:0}),2),Te=Se[0],Ae=Se[1],Ce=(0,n.useRef)(),De=we((0,n.useState)("actions"),2),je=De[0],Pe=De[1],Ie=we((0,n.useState)("users"),2),xe=Ie[0],qe=Ie[1];(0,n.useEffect)((function(){Ue(),Me()}),[]);var Ue=function(){var e=Ne(ge().m((function e(){return ge().w((function(e){for(;;)switch(e.n){case 0:return w(!0),e.p=1,e.n=2,Promise.all([Re(),Fe(),ze(),Le()]);case 2:e.n=4;break;case 3:e.p=3,e.v,a("Failed to load admin data","error");case 4:return e.p=4,w(!1),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=Ne(ge().m((function e(){var t,a,n,r,l,c;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("getAdminUsers");case 1:if(!(t=e.v).success){e.n=3;break}return a=t.data||[],e.n=2,(0,y.invoke)("getAllUsers");case 2:n=e.v,r=n.success&&n.data||[],l=a.map((function(e){return r.find((function(t){return t.jira_account_id===e.accountId||t.email_address===e.emailAddress}))||e})),O(l);case 3:e.n=5;break;case 4:e.p=4,c=e.v,console.error("Failed to load admin users:",c);case 5:return e.a(2)}}),e,null,[[0,4]])})));return function(){return e.apply(this,arguments)}}(),Fe=function(){var e=Ne(ge().m((function e(){var t;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("getTeams");case 1:(t=e.v).success&&C(t.data||[]),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}(),ze=function(){var e=Ne(ge().m((function e(){var t;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("getAllUsers");case 1:(t=e.v).success&&P(t.data||[]),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}(),Le=function(){var e=Ne(ge().m((function e(){var t;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("getPTORequests");case 1:(t=e.v).success&&q(t.data||[]),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=Ne(ge().m((function e(){var t,a;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("getInternalJiraUsers",{startAt:0,maxResults:50});case 1:(t=e.v).success&&F(t.data.users||[]),e.n=3;break;case 2:e.p=2,a=e.v,console.error("Failed to load Jira users:",a);case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=Ne(ge().m((function e(n){var r;return ge().w((function(e){for(;;)switch(e.n){case 0:if(n){e.n=1;break}return e.a(2);case 1:return e.p=1,e.n=2,(0,y.invoke)("addAdminUser",{accountId:n.accountId,addedBy:t.accountId});case 2:(r=e.v).success?(a("".concat(n.displayName," added as admin")),M(!1),Re()):a(r.message||"Failed to add admin","error"),e.n=4;break;case 3:e.p=3,e.v,a("Failed to add admin user","error");case 4:return e.a(2)}}),e,null,[[1,3]])})));return function(t){return e.apply(this,arguments)}}(),Ge=function(){var e=Ne(ge().m((function e(n){var r,l;return ge().w((function(e){for(;;)switch(e.n){case 0:if(null!=n&&n.targetUser){e.n=1;break}return a("Please select a user for PTO","error"),e.a(2);case 1:return e.p=1,c=n.manager,r=c?Ee(Ee({},c),{},{accountId:c.accountId||c.jira_account_id||c.id,displayName:c.displayName||c.display_name||c.name,emailAddress:c.emailAddress||c.email_address,avatarUrl:c.avatarUrl||c.avatar_url}):null,e.n=2,(0,y.invoke)("submitPTOForUser",{requestData:{requester_id:n.targetUser.accountId,requester_name:n.targetUser.displayName,requester_email:n.targetUser.emailAddress,manager_id:(null==r?void 0:r.accountId)||"admin",manager_name:(null==r?void 0:r.displayName)||t.displayName,manager_email:(null==r?void 0:r.emailAddress)||t.emailAddress,start_date:n.startDate,end_date:n.endDate,leave_type:n.leaveType||"vacation",reason:n.reason||"Admin created",status:"approved",total_days:n.totalDays,total_hours:n.totalHours,daily_schedules:n.dailySchedules},submittedBy:t.accountId});case 2:(l=e.v).success?(a("PTO request created for ".concat(n.targetUser.displayName)),Y(!1),Le()):a(l.message||"Failed to create PTO request","error"),e.n=4;break;case 3:e.p=3,e.v,a("Failed to create PTO request","error");case 4:return e.a(2)}var c}),e,null,[[1,3]])})));return function(t){return e.apply(this,arguments)}}(),Je=function(){var e=Ne(ge().m((function e(){var t,n,r,l,c,i,s,o,u;return ge().w((function(e){for(;;)switch(e.n){case 0:try{t=ve(x),"team"===ye.scope&&ye.teamId?(n=j.filter((function(e){return(e.team_ids||[]).includes(ye.teamId)})),r=n.map((function(e){return e.jira_account_id||e.id})),t=t.filter((function(e){return r.includes(e.requester_id)}))):"user"===ye.scope&&ye.userId&&(t=t.filter((function(e){return e.requester_id===ye.userId}))),ye.startDate&&ye.endDate&&(t=t.filter((function(e){var t=new Date(e.start_date),a=new Date(ye.startDate),n=new Date(ye.endDate);return t>=a&&t<=n}))),"all"!==ye.status&&(t=t.filter((function(e){return e.status===ye.status}))),l=t.map((function(e){var t=j.find((function(t){return t.jira_account_id===e.requester_id||t.email_address===e.requester_email})),a=t?A.filter((function(e){return(t.team_ids||[]).includes(e.id)})):[];return{Date:(new Date).toLocaleDateString(),Manager:e.manager_name||"",Team:a.map((function(e){return e.name})).join(", "),Department:a.length>0?a[0].department:"",User:e.requester_name,"Start Date":e.start_date,"End Date":e.end_date,"Total Days":e.total_days||0,"Leave Type":e.leave_type,Reason:e.reason||"",Status:e.status,"Submitted Date":e.submitted_at}})),c=Object.keys(l[0]||{}),i=[c.join(",")].concat(ve(l.map((function(e){return c.map((function(t){return'"'.concat((e[t]||"").toString().replace(/"/g,'""'),'"')})).join(",")})))).join("\n"),s=new Blob([i],{type:"text/csv"}),o=URL.createObjectURL(s),(u=document.createElement("a")).href=o,u.download="pto-admin-report-".concat(ye.scope,"-").concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(o),a("Report downloaded successfully!"),Q(!1)}catch(e){a("Failed to generate report","error")}case 1:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}();(0,n.useEffect)((function(){var e,t;Ae({totalAdmins:S.length,totalTeams:A.length,totalUsers:j.length,totalRequests:x.length,pendingRequests:x.filter((function(e){return"pending"===e.status})).length,approvedRequests:x.filter((function(e){return"approved"===e.status})).length,declinedRequests:x.filter((function(e){return"declined"===e.status})).length,usersNotInSystem:(null===(t=j.map((function(e){return e.jira_account_id||e.email_address})).filter(Boolean),e=R.filter((function(e){return!t.includes(e.accountId)&&!t.includes(e.emailAddress)})))||void 0===e?void 0:e.length)||0})}),[S,A,j,x]);var Ve={requestsByWeekday:x.reduce((function(e,t){var a=new Date(t.start_date).toLocaleDateString("en-US",{weekday:"long"});return e[a]=(e[a]||0)+1,e}),{}),requestsByLeaveType:x.reduce((function(e,t){return e[t.leave_type]=(e[t.leave_type]||0)+1,e}),{}),requestsByTeam:x.reduce((function(e,t){var a=j.find((function(e){return e.jira_account_id===t.requester_id||e.email_address===t.requester_email})),n=a?A.find((function(e){return e.id===a.team_id})):null,r=(null==n?void 0:n.name)||"Unassigned";return e[r]=(e[r]||0)+1,e}),{})};function We(e,t){if(Array.isArray(e)&&0!==e.length){var a,n=Object.keys(e[0]),r=[n.join(",")],l=fe(e);try{var c=function(){var e=a.value;r.push(n.map((function(t){var a;return'"'+(null!==(a=e[t])&&void 0!==a?a:"").toString().replace(/"/g,'""')+'"'})).join(","))};for(l.s();!(a=l.n()).done;)c()}catch(e){l.e(e)}finally{l.f()}var i=r.join("\n"),s=new Blob([i],{type:"text/csv"}),o=URL.createObjectURL(s),u=document.createElement("a");u.href=o,u.download=t,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(o)}}var He=function(){var e=Ne(ge().m((function e(){var t;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("debugStorage");case 1:(t=e.v).success&&t.data?(t.data.users&&We(t.data.users,"users.csv"),t.data.teams&&We(t.data.teams,"teams.csv"),t.data.admins&&We(t.data.admins.map((function(e){return{accountId:e}})),"admins.csv"),t.data.pto_requests&&We(t.data.pto_requests,"pto_requests.csv"),t.data.pto_daily_schedules&&We(t.data.pto_daily_schedules,"pto_daily_schedules.csv"),a("Database exported as CSV files!")):a("Failed to export database","error"),e.n=3;break;case 2:e.p=2,e.v,a("Failed to export database","error");case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}(),Ye=function(){var e=Ne(ge().m((function e(){var t;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("exportPTODailySchedules",{filters:oe});case 1:(t=e.v).success?(We(t.data,"pto_daily_schedules.csv"),a("Daily schedules exported successfully!"),ne(!1)):a(t.message||"Failed to export daily schedules","error"),e.n=3;break;case 2:e.p=2,e.v,a("Failed to export daily schedules","error");case 3:return e.a(2)}}),e,null,[[0,2]])})));return function(){return e.apply(this,arguments)}}();return n.createElement("div",{className:"admin-dashboard"},n.createElement("div",{className:"admin-tabs"},n.createElement("button",{className:"admin-tab ".concat("overview"===g?"active":""),onClick:function(){return h("overview")}},n.createElement(r.A,{size:16}),"Overview"),n.createElement("button",{className:"admin-tab ".concat("users"===g?"active":""),onClick:function(){return h("users")}},n.createElement(l.A,{size:16}),"Users"),n.createElement("button",{className:"admin-tab ".concat("analytics"===g?"active":""),onClick:function(){return h("analytics")}},n.createElement(c.A,{size:16}),"Analytics"),n.createElement("button",{className:"admin-tab".concat("actions"===je?" active":""),onClick:function(){return Pe("actions")}},"Actions"),n.createElement("button",{className:"admin-tab".concat("pto-balances"===je?" active":""),onClick:function(){return Pe("pto-balances")}},"PTO Balances")),"overview"===g&&n.createElement("div",{className:"admin-section"},n.createElement("div",{className:"admin-stats-grid"},n.createElement("div",{className:"admin-stat-card admin-stat-purple"},n.createElement("div",{className:"stat-icon"},n.createElement(r.A,{size:24})),n.createElement("div",{className:"stat-content"},n.createElement("div",{className:"stat-value"},Te.totalAdmins),n.createElement("div",{className:"stat-label"},"Admin Users"))),n.createElement("div",{className:"admin-stat-card admin-stat-blue"},n.createElement("div",{className:"stat-icon"},n.createElement(i.A,{size:24})),n.createElement("div",{className:"stat-content"},n.createElement("div",{className:"stat-value"},Te.totalTeams),n.createElement("div",{className:"stat-label"},"Teams"))),n.createElement("div",{className:"admin-stat-card admin-stat-emerald"},n.createElement("div",{className:"stat-icon"},n.createElement(s.A,{size:24})),n.createElement("div",{className:"stat-content"},n.createElement("div",{className:"stat-value"},Te.totalUsers),n.createElement("div",{className:"stat-label"},"Users"))),n.createElement("div",{className:"admin-stat-card admin-stat-indigo"},n.createElement("div",{className:"stat-icon"},n.createElement(o.A,{size:24})),n.createElement("div",{className:"stat-content"},n.createElement("div",{className:"stat-value"},Te.totalRequests),n.createElement("div",{className:"stat-label"},"Total Requests"),n.createElement("div",{className:"stat-breakdown"},n.createElement("span",{className:"breakdown-item green"},Te.approvedRequests," approved"),n.createElement("span",{className:"breakdown-item orange"},Te.pendingRequests," pending"),n.createElement("span",{className:"breakdown-item red"},Te.declinedRequests," declined"))))),n.createElement("div",{className:"card admin-actions-card"},n.createElement("div",{className:"card-header"},n.createElement("h3",null,"Actions")),n.createElement("div",{className:"card-body"},n.createElement("div",{className:"admin-actions-grid"},n.createElement("button",{onClick:function(){ke(Date.now()),Y(!0)},className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-green"},n.createElement(o.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"Create PTO"),n.createElement("div",{className:"action-desc"},"Create PTO requests for users"))),n.createElement("button",{onClick:function(){return Q(!0)},className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-blue"},n.createElement(u.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"Generate Reports"),n.createElement("div",{className:"action-desc"},"Export detailed PTO reports"))),n.createElement("button",{onClick:function(){return V(!0)},className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-indigo"},n.createElement(l.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"Manage Teams & Users"),n.createElement("div",{className:"action-desc"},"Advanced team and user management"))),n.createElement("button",{onClick:He,className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-yellow"},n.createElement(u.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"Export Database"),n.createElement("div",{className:"action-desc"},"Download all tables as CSV"))),n.createElement("button",{onClick:function(){return ee(!0)},className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-purple"},n.createElement(m.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"Import PTOs"),n.createElement("div",{className:"action-desc"},"Import PTO daily schedules from CSV"))),n.createElement("button",{onClick:function(){return ne(!0)},className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-pink"},n.createElement(u.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"Export Daily Schedules"),n.createElement("div",{className:"action-desc"},"Export PTO daily schedules"))),n.createElement("button",{onClick:Ne(ge().m((function e(){var t,n,r,l,c,i,s,o,u;return ge().w((function(e){for(;;)switch(e.n){case 0:if(window.confirm("This will check all teams and fix any manager fields that are objects. Proceed?")){e.n=1;break}return e.a(2);case 1:return w(!0),e.p=2,e.n=3,(0,y.invoke)("getTeams");case 3:if((t=e.v).success){e.n=4;break}throw new Error("Failed to fetch teams");case 4:n=t.data||[],r=0,l=fe(n),e.p=5,l.s();case 6:if((c=l.n()).done){e.n=9;break}if(!(i=c.value).manager||"object"!==pe(i.manager)){e.n=8;break}if(!(s=i.manager.jira_account_id||i.manager.accountId||i.manager.id||null)){e.n=8;break}return e.n=7,(0,y.invoke)("updateTeam",Ee(Ee({},i),{},{manager:s}));case 7:r++;case 8:e.n=6;break;case 9:e.n=11;break;case 10:e.p=10,o=e.v,l.e(o);case 11:return e.p=11,l.f(),e.f(11);case 12:a("✅ Fixed ".concat(r," teams with object managers.")),Fe(),e.n=14;break;case 13:e.p=13,u=e.v,a("Failed to fix teams: "+u.message,"error");case 14:return e.p=14,w(!1),e.f(14);case 15:return e.a(2)}}),e,null,[[5,10,11,12],[2,13,14,15]])}))),className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-orange"},n.createElement(d.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"Fix Team Managers"),n.createElement("div",{className:"action-desc"},"Convert all manager fields to IDs"))),n.createElement("button",{onClick:Ne(ge().m((function e(){var n,r;return ge().w((function(e){for(;;)switch(e.n){case 0:if(window.confirm("⚠️ WARNING: This will DELETE ALL PTO data (requests + daily schedules). This cannot be undone. Are you sure?")){e.n=1;break}return e.a(2);case 1:if(window.confirm("Final confirmation: Delete ALL PTO data? Type YES to confirm.")){e.n=2;break}return e.a(2);case 2:return w(!0),e.p=3,e.n=4,(0,y.invoke)("cleanupPTODatabase",{adminId:t.accountId,confirmDelete:!0});case 4:(n=e.v).success?(a("✅ Cleanup complete: ".concat(n.data.deletedCount," items removed")),Ue()):a(n.message||"Cleanup failed","error"),e.n=6;break;case 5:e.p=5,r=e.v,a("Cleanup failed: "+r.message,"error");case 6:return e.p=6,w(!1),e.f(6);case 7:return e.a(2)}}),e,null,[[3,5,6,7]])}))),className:"admin-action-btn",disabled:N},n.createElement("div",{className:"action-icon bg-red"},n.createElement(d.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"🗑️ Cleanup PTO Database"),n.createElement("div",{className:"action-desc"},"Delete ALL PTO requests and schedules"))),n.createElement("button",{onClick:Ne(ge().m((function e(){var t,n;return ge().w((function(e){for(;;)switch(e.n){case 0:if(window.confirm("This will remove old conflicting database tables (pto_teams, pto_balances). Proceed?")){e.n=1;break}return e.a(2);case 1:return w(!0),e.p=2,e.n=3,(0,y.invoke)("cleanupConflictingTables");case 3:(t=e.v).success?(a("✅ Cleanup complete: Removed tables: ".concat(t.removedTables.join(", "))),Ue()):a(t.message||"Cleanup failed","error"),e.n=5;break;case 4:e.p=4,n=e.v,a("Cleanup failed: "+n.message,"error");case 5:return e.p=5,w(!1),e.f(5);case 6:return e.a(2)}}),e,null,[[2,4,5,6]])}))),className:"admin-action-btn",disabled:N},n.createElement("div",{className:"action-icon bg-purple"},n.createElement(d.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"🧹 Cleanup DB Schema"),n.createElement("div",{className:"action-desc"},"Remove conflicting database tables"))),n.createElement("button",{onClick:Ne(ge().m((function e(){var n,r;return ge().w((function(e){for(;;)switch(e.n){case 0:if(window.confirm("⚠️ WARNING: This will DELETE ALL PTO data (requests + daily schedules). This cannot be undone. Are you sure?")){e.n=1;break}return e.a(2);case 1:if(window.confirm("Final confirmation: Delete ALL PTO data? Type YES to confirm.")){e.n=2;break}return e.a(2);case 2:return w(!0),e.p=3,e.n=4,(0,y.invoke)("cleanupPTODatabase",{adminId:t.accountId,confirmDelete:!0});case 4:(n=e.v).success?(a("✅ Cleanup complete: ".concat(n.data.deletedCount," items removed")),Ue()):a(n.message||"Cleanup failed","error"),e.n=6;break;case 5:e.p=5,r=e.v,a("Cleanup failed: "+r.message,"error");case 6:return e.p=6,w(!1),e.f(6);case 7:return e.a(2)}}),e,null,[[3,5,6,7]])}))),className:"admin-action-btn",disabled:N},n.createElement("div",{className:"action-icon bg-red"},n.createElement(d.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"🗑️ Cleanup PTO Database"),n.createElement("div",{className:"action-desc"},"Delete ALL PTO requests and schedules"))),n.createElement("button",{onClick:Ne(ge().m((function e(){var t,n,r,l;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("checkStorageSizes");case 1:(t=e.v).success?(n=t.data,r="📊 Storage Report (".concat(n.totalSizeKB,"KB / ").concat(n.maxAllowedKB,"KB max):\n\n"),Object.entries(n.tables).forEach((function(e){var t=we(e,2),a=t[0],n=t[1];r+="".concat(a,": ").concat(n.records," records, ").concat(n.sizeKB,"KB\n")})),n.totalSize>.8*n.maxAllowed&&(r+="\n⚠️ WARNING: Storage is over 80% full!"),alert(r)):a("Failed to check storage sizes","error"),e.n=3;break;case 2:e.p=2,l=e.v,a("Storage check failed: "+l.message,"error");case 3:return e.a(2)}}),e,null,[[0,2]])}))),className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-yellow"},n.createElement(p.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"📊 Check Storage"),n.createElement("div",{className:"action-desc"},"View storage usage by table"))),n.createElement("button",{onClick:Ne(ge().m((function e(){var t,n;return ge().w((function(e){for(;;)switch(e.n){case 0:if(!window.confirm("This will migrate your database to the new structure. This process will backup and restructure your existing data. Proceed?")){e.n=5;break}return w(!0),e.p=1,e.n=2,(0,y.invoke)("migrateDatabaseStructure");case 2:(t=e.v).success?(a("✅ Migration completed: ".concat(t.data.migratedUsers," users, ").concat(t.data.migratedTeams," teams, ").concat(t.data.migratedPtoRequests," PTO requests migrated.")),loadStats()):a(t.message||"Migration failed","error"),e.n=4;break;case 3:e.p=3,n=e.v,a("Migration failed: "+n.message,"error");case 4:return e.p=4,w(!1),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])}))),className:"admin-action-btn",disabled:N},n.createElement("div",{className:"action-icon bg-blue"},n.createElement(f.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"🔄 Migrate Database"),n.createElement("div",{className:"action-desc"},"Restructure database to new schema"))),n.createElement("button",{onClick:function(){return ie(!0)},className:"admin-action-btn"},n.createElement("div",{className:"action-icon bg-orange"},n.createElement(m.A,{size:20})),n.createElement("div",{className:"action-content"},n.createElement("div",{className:"action-title"},"Import Database"),n.createElement("div",{className:"action-desc"},"Upload a JSON file to replace all data")))))),n.createElement("div",{className:"card recent-activity-card"},n.createElement("div",{className:"card-header"},n.createElement("h3",null,"Recent PTO Activity")),n.createElement("div",{className:"card-body"},0===x.length?n.createElement("div",{className:"empty-state-small"},n.createElement(o.A,{size:32}),n.createElement("p",null,"No PTO requests yet")):n.createElement("div",{className:"recent-requests-list"},x.sort((function(e,t){return new Date(t.submitted_at)-new Date(e.submitted_at)})).slice(0,5).map((function(e){var t;return n.createElement("div",{key:e.id,className:"recent-request-item"},n.createElement("div",{className:"request-avatar"},(null===(t=e.requester_name)||void 0===t?void 0:t.charAt(0))||"?"),n.createElement("div",{className:"request-details"},n.createElement("div",{className:"request-summary"},n.createElement("span",{className:"requester-name"},e.requester_name),n.createElement("span",{className:"request-action"},"requested ",e.leave_type)),n.createElement("div",{className:"request-meta"},new Date(e.start_date).toLocaleDateString()," • ",e.total_days," days")),n.createElement("div",{className:"request-status"},n.createElement("span",{className:"status-badge status-".concat(e.status)},e.status)))})))))),"users"===g&&n.createElement("div",{className:"admin-section"},n.createElement(re,{currentUser:t,showNotification:a,isAdmin:!0})),"analytics"===g&&n.createElement("div",{className:"admin-section"},n.createElement("div",{className:"section-header"},n.createElement("h3",null,"Analytics Dashboard")),n.createElement("div",{className:"analytics-grid"},n.createElement("div",{className:"card analytics-card"},n.createElement("div",{className:"card-header"},n.createElement("h4",null,"Requests by Weekday")),n.createElement("div",{className:"card-body"},n.createElement("div",{className:"analytics-list"},Object.entries(Ve.requestsByWeekday).sort((function(e,t){var a=we(e,2)[1];return we(t,2)[1]-a})).map((function(e){var t=we(e,2),a=t[0],r=t[1];return n.createElement("div",{key:a,className:"analytics-item"},n.createElement("div",{className:"item-info"},n.createElement("span",{className:"item-icon"},"📅"),n.createElement("span",{className:"item-label"},a)),n.createElement("div",{className:"item-value"},r))}))))))),L&&n.createElement(Oe,{title:"Add Admin User",onClose:function(){return M(!1)}},n.createElement("div",{className:"add-admin-content"},n.createElement("p",null,"Grant admin privileges to a user. They will be able to manage teams, users, and all PTO requests."),n.createElement(E.A,{selectedUser:null,onSelect:Be,placeholder:"Search and select user to grant admin privileges",useBackendSearch:!1}))),$&&n.createElement(Oe,{title:"Generate PTO Report",onClose:function(){return Q(!1)}},n.createElement("div",{className:"report-config"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Report Scope"),n.createElement("select",{value:ye.scope,onChange:function(e){return be((function(t){return Ee(Ee({},t),{},{scope:e.target.value})}))},className:"form-control"},n.createElement("option",{value:"company"},"Full Company"),n.createElement("option",{value:"team"},"Specific Team"),n.createElement("option",{value:"user"},"Specific User"))),"team"===ye.scope&&n.createElement("div",{className:"form-group"},n.createElement("label",null,"Select Team"),n.createElement("select",{value:ye.teamId,onChange:function(e){return be((function(t){return Ee(Ee({},t),{},{teamId:e.target.value})}))},className:"form-control"},n.createElement("option",{value:""},"Choose a team"),A.map((function(e){return n.createElement("option",{key:e.id,value:e.id},e.name)})))),"user"===ye.scope&&n.createElement("div",{className:"form-group"},n.createElement("label",null,"Select User"),n.createElement("select",{value:ye.userId,onChange:function(e){return be((function(t){return Ee(Ee({},t),{},{userId:e.target.value})}))},className:"form-control"},n.createElement("option",{value:""},"Choose a user"),j.map((function(e){return n.createElement("option",{key:e.id,value:e.jira_account_id||e.id},e.display_name||e.displayName)})))),n.createElement("div",{className:"form-row"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Start Date"),n.createElement("input",{type:"date",value:ye.startDate,onChange:function(e){return be((function(t){return Ee(Ee({},t),{},{startDate:e.target.value})}))},className:"form-control"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"End Date"),n.createElement("input",{type:"date",value:ye.endDate,onChange:function(e){return be((function(t){return Ee(Ee({},t),{},{endDate:e.target.value})}))},className:"form-control"}))),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Status Filter"),n.createElement("select",{value:ye.status,onChange:function(e){return be((function(t){return Ee(Ee({},t),{},{status:e.target.value})}))},className:"form-control"},n.createElement("option",{value:"all"},"All Status"),n.createElement("option",{value:"pending"},"Pending"),n.createElement("option",{value:"approved"},"Approved"),n.createElement("option",{value:"declined"},"Declined"))),n.createElement("div",{className:"form-actions"},n.createElement("button",{onClick:function(){return Q(!1)},className:"btn btn-secondary"},"Cancel"),n.createElement("button",{onClick:Je,className:"btn btn-primary"},n.createElement(u.A,{size:16}),"Generate Report")))),J&&n.createElement(B,{isOpen:J,onClose:function(){return V(!1)},showNotification:a,onRefresh:Ue}),H&&n.createElement(b.A,{key:_e,isAdminMode:!0,onClose:function(){return Y(!1)},onSubmit:Ge,allUsers:j,allTeams:A,allRequests:x,currentUser:t,isAdmin:!0}),Z&&n.createElement(de,{isOpen:Z,onClose:function(){return ee(!1)},currentUser:t,showNotification:a,onImportSuccess:Le}),ae&&n.createElement(Oe,{title:"Export PTO Daily Schedules",onClose:function(){return ne(!1)}},n.createElement("div",{className:"export-filters"},n.createElement("div",{className:"form-row"},n.createElement("div",{className:"form-group"},n.createElement("label",null,"Start Date"),n.createElement("input",{type:"date",value:oe.startDate,onChange:function(e){return ue((function(t){return Ee(Ee({},t),{},{startDate:e.target.value})}))},className:"form-control"})),n.createElement("div",{className:"form-group"},n.createElement("label",null,"End Date"),n.createElement("input",{type:"date",value:oe.endDate,onChange:function(e){return ue((function(t){return Ee(Ee({},t),{},{endDate:e.target.value})}))},className:"form-control"}))),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Requester"),n.createElement("select",{value:oe.requesterId,onChange:function(e){return ue((function(t){return Ee(Ee({},t),{},{requesterId:e.target.value})}))},className:"form-control"},n.createElement("option",{value:""},"All Requesters"),j.map((function(e){return n.createElement("option",{key:e.id,value:e.jira_account_id||e.id},e.display_name||e.displayName)})))),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Manager"),n.createElement("select",{value:oe.managerId,onChange:function(e){return ue((function(t){return Ee(Ee({},t),{},{managerId:e.target.value})}))},className:"form-control"},n.createElement("option",{value:""},"All Managers"),j.map((function(e){return n.createElement("option",{key:e.id,value:e.jira_account_id||e.id},e.display_name||e.displayName)})))),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Leave Type"),n.createElement("select",{value:oe.leaveType,onChange:function(e){return ue((function(t){return Ee(Ee({},t),{},{leaveType:e.target.value})}))},className:"form-control"},n.createElement("option",{value:""},"All Types"),n.createElement("option",{value:"vacation"},"Vacation"),n.createElement("option",{value:"sick"},"Sick Leave"),n.createElement("option",{value:"personal"},"Personal Leave"),n.createElement("option",{value:"holiday"},"Holiday"),n.createElement("option",{value:"other leave type"},"Other Leave Type"))),n.createElement("div",{className:"form-actions"},n.createElement("button",{onClick:function(){return ne(!1)},className:"btn btn-secondary"},"Cancel"),n.createElement("button",{onClick:Ye,className:"btn btn-primary"},n.createElement(u.A,{size:16}),"Export Schedules"),n.createElement("button",{onClick:Ne(ge().m((function e(){var t,n,r,l,c;return ge().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,(0,y.invoke)("debugStorage");case 1:if(t=e.v,console.log("🔍 DEBUG Storage Response:",t),!t.success){e.n=3;break}return n=t.data.summary,a("Storage Debug: ".concat(n.ptoRequestCount," PTO requests, ").concat(n.ptoScheduleCount," daily schedules"),"info"),e.n=2,(0,y.invoke)("getPTORequests");case 2:r=e.v,console.log("🔍 DEBUG getPTORequests Response:",r),r.success&&a("getPTORequests returned: ".concat((null===(l=r.data)||void 0===l?void 0:l.length)||0," total events"),"info");case 3:e.n=5;break;case 4:e.p=4,c=e.v,console.error("Debug error:",c),a("Debug failed: "+c.message,"error");case 5:return e.a(2)}}),e,null,[[0,4]])}))),className:"btn btn-secondary"},n.createElement(u.A,{size:16}),"Debug Storage")))),ce&&n.createElement("div",{className:"modal-overlay"},n.createElement("div",{className:"modal-content",style:{maxWidth:400,margin:"auto",padding:24}},n.createElement("h4",null,"Import Database"),n.createElement("div",{className:"form-group"},n.createElement("label",null,"Table to Replace"),n.createElement("select",{className:"form-control",value:xe,onChange:function(e){return qe(e.target.value)}},[{value:"users",label:"Users"},{value:"teams",label:"Teams"},{value:"pto_balances",label:"PTO Balances"}].map((function(e){return n.createElement("option",{key:e.value,value:e.value},e.label)})))),n.createElement("div",{className:"form-group"},n.createElement("label",null,"CSV File"),n.createElement("input",{type:"file",accept:".csv",ref:Ce,onChange:function(){var e=Ne(ge().m((function e(t){var n,r;return ge().w((function(e){for(;;)switch(e.n){case 0:if(n=t.target.files[0]){e.n=1;break}return e.a(2);case 1:(r=new FileReader).onload=function(){var e=Ne(ge().m((function e(t){var n,r,l,c;return ge().w((function(e){for(;;)switch(e.n){case 0:if(n=t.target.result,r=n.split(/\r?\n/).filter(Boolean),l=r[0].split(",").map((function(e){return e.trim()})),c=r.slice(1).map((function(e){var t=e.split(","),a={};return l.forEach((function(e,n){a[e]=t[n]})),a})),window.confirm("This will replace all data in the '".concat(xe,"' table. Proceed?"))){e.n=1;break}return e.a(2);case 1:return e.n=2,(0,y.invoke)("importDatabase",{table:xe,data:c});case 2:if(ie(!1),a("Imported ".concat(c.length," records into ").concat(xe,"."),"success"),"users"!==xe){e.n=3;break}return e.n=3,loadUsers();case 3:if("teams"!==xe){e.n=4;break}return e.n=4,loadTeams();case 4:if("pto_requests"!==xe){e.n=5;break}return e.n=5,Le();case 5:if("pto_daily_schedules"!==xe){e.n=6;break}return e.n=6,Le();case 6:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.readAsText(n);case 2:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}()})),n.createElement("div",{className:"form-actions"},n.createElement("button",{className:"btn btn-secondary",onClick:function(){return ie(!1)}},"Cancel")))))}}}]);