(()=>{"use strict";var e,t={6564:(e,t,a)=>{var s=a(6540),r=a(5338),l=a(2307),n=a(7235),c=a(4471),m=a(3893),i=a(2492),o=a(8686),d=a(2321);const u=e=>{let{message:t,type:a,onClose:r}=e;return s.createElement("div",{className:"fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ".concat("success"===a?"bg-green-500 text-white":"bg-red-500 text-white")},s.createElement("div",{className:"flex items-center justify-between"},s.createElement("span",null,t),s.createElement("button",{onClick:r,className:"ml-4 text-white hover:text-gray-200"},"×")))};var p=a(7623),v=a(2762),E=a(6550),y=a(3160),b=a(8697),N=a(8445);const g=e=>{var t;let{selectedUser:a,onSelect:r,placeholder:l="Search for a user",disabled:n=!1,required:c=!1,error:m=null}=e;const[i,u]=(0,s.useState)(!1),[p,v]=(0,s.useState)(""),[E,y]=(0,s.useState)([]),[g,f]=(0,s.useState)(!1),[h,q]=(0,s.useState)(null),w=(0,s.useRef)(null),T=(0,s.useRef)(null),D=(0,s.useCallback)(function(e,t){let a;return function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];const n=()=>{clearTimeout(a),e(...r)};clearTimeout(a),a=setTimeout(n,t)}}((async e=>{if(e.length<2)y([]);else{f(!0),q(null);try{console.log("🔍 Searching users:",e);const t=await(0,d.invoke)("getJiraUsers",{query:e});if(!t.success)throw new Error(t.message||"Failed to search users");y(t.data||[])}catch(e){console.error("❌ Error searching users:",e),q(e.message),y([])}finally{f(!1)}}}),300),[]);return(0,s.useEffect)((()=>{const e=e=>{w.current&&!w.current.contains(e.target)&&(u(!1),v(""),y([]))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&i&&(u(!1),v(""),y([]))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[i]),s.createElement("div",{className:"relative",ref:w},s.createElement("div",{onClick:()=>{n||(u(!0),setTimeout((()=>{var e;null===(e=T.current)||void 0===e||e.focus()}),100))},className:"flex items-center justify-between p-3 border rounded-md cursor-pointer transition-colors ".concat(n?"bg-gray-100 cursor-not-allowed border-gray-200":i?"border-blue-500 ring-2 ring-blue-200":m?"border-red-300 hover:border-red-400":"border-gray-300 hover:border-gray-400")},a?s.createElement("div",{className:"flex items-center space-x-3 flex-1"},s.createElement("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-semibold"},a.avatarUrl?s.createElement("img",{src:a.avatarUrl,alt:a.displayName,className:"w-8 h-8 rounded-full"}):(null===(t=a.displayName)||void 0===t?void 0:t.charAt(0))||s.createElement(o.A,{size:16})),s.createElement("div",{className:"flex-1"},s.createElement("div",{className:"font-medium text-gray-900"},a.displayName),s.createElement("div",{className:"text-sm text-gray-600"},a.emailAddress)),!n&&s.createElement("button",{onClick:e=>{e.stopPropagation(),r(null)},className:"p-1 hover:bg-gray-100 rounded transition-colors"},s.createElement(b.A,{size:16,className:"text-gray-400"}))):s.createElement("div",{className:"flex items-center space-x-3 text-gray-500"},s.createElement(N.A,{size:16}),s.createElement("span",null,l),c&&s.createElement("span",{className:"text-red-500"},"*"))),m&&s.createElement("div",{className:"mt-1 text-sm text-red-600"},m),i&&s.createElement("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-80 overflow-hidden"},s.createElement("div",{className:"p-3 border-b border-gray-200"},s.createElement("div",{className:"relative"},s.createElement(N.A,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),s.createElement("input",{ref:T,type:"text",value:p,onChange:e=>{const t=e.target.value;v(t),D(t)},placeholder:"Type to search users...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),s.createElement("div",{className:"max-h-60 overflow-y-auto"},g?s.createElement("div",{className:"p-4 text-center text-gray-500"},s.createElement("div",{className:"flex items-center justify-center space-x-2"},s.createElement("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"}),s.createElement("span",null,"Searching..."))):h?s.createElement("div",{className:"p-4 text-center text-red-600"},s.createElement("div",{className:"text-sm"},"Error: ",h)):p.length<2?s.createElement("div",{className:"p-4 text-center text-gray-500"},s.createElement("div",{className:"text-sm"},"Type at least 2 characters to search")):0===E.length?s.createElement("div",{className:"p-4 text-center text-gray-500"},s.createElement("div",{className:"text-sm"},"No users found")):s.createElement("div",{className:"divide-y divide-gray-100"},E.map((e=>{var t;return s.createElement("div",{key:e.accountId,onClick:()=>(e=>{r(e),u(!1),v(""),y([])})(e),className:"p-3 hover:bg-gray-50 cursor-pointer transition-colors"},s.createElement("div",{className:"flex items-center space-x-3"},s.createElement("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-semibold"},e.avatarUrl?s.createElement("img",{src:e.avatarUrl,alt:e.displayName,className:"w-8 h-8 rounded-full"}):(null===(t=e.displayName)||void 0===t?void 0:t.charAt(0))||s.createElement(o.A,{size:16})),s.createElement("div",{className:"flex-1"},s.createElement("div",{className:"font-medium text-gray-900"},e.displayName),s.createElement("div",{className:"text-sm text-gray-600"},e.emailAddress))))}))))))};var f=a(7946);function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){w(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function w(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const T=[{value:"vacation",label:"🏖️ Vacation",emoji:"🏖️"},{value:"sick",label:"🤒 Sick Leave",emoji:"🤒"},{value:"personal",label:"👤 Personal Day",emoji:"👤"},{value:"holiday",label:"🎉 Holiday",emoji:"🎉"},{value:"other",label:"📋 Other type of leave",emoji:"📋"}];const D=e=>{var t,a,r,c,i;let{selectedDates:u=[],onClose:p,onSubmit:v,currentUser:E,isAdmin:y=!1,targetUser:N=null,allUsers:h=[],allTeams:w=[],allRequests:D=[]}=e;const[O,k]=(0,s.useState)({selectedUser:E,manager:null,leaveType:"",reason:"",startDate:"",endDate:"",dailySchedules:[]}),[_,x]=(0,s.useState)({}),[S,A]=(0,s.useState)(!1),[P,C]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const e=N||E;e&&(k((t=>q(q({},t),{},{selectedUser:e}))),j(e))}),[N,E,h,w]),(0,s.useEffect)((()=>{if(u.length>0){const e=[...u].sort();k((t=>q(q({},t),{},{startDate:e[0],endDate:e[e.length-1],dailySchedules:e.map((e=>({date:e,type:"FULL_DAY"})))})))}}),[u]);const j=async e=>{if(e){C(!0);try{const t=function(e,t,a){if(!e||null==a||!a.length||null==t||!t.length)return null;const s=a.find((t=>{var a;return null===(a=t.members)||void 0===a?void 0:a.some((t=>t.accountId===e.accountId||t.jira_account_id===e.accountId||t.emailAddress===e.emailAddress||t.email_address===e.emailAddress))}));return s?s.manager?"object"==typeof s.manager?s.manager:t.find((e=>e.accountId===s.manager||e.jira_account_id===s.manager||e.id===s.manager)):s.team_lead?t.find((e=>e.displayName===s.team_lead||e.display_name===s.team_lead)):null:null}(e,h,w);if(k((e=>q(q({},e),{},{manager:t}))),!t)try{const e=await(0,d.invoke)("getJiraUsers",{query:"manager"});e.success&&e.data.length>0&&console.log("Could not auto-detect manager. Please select manually.")}catch(e){console.warn("Could not search for managers:",e)}}finally{C(!1)}}},U=()=>{var e,t;const a={};O.selectedUser||(a.selectedUser="User is required"),O.manager||(a.manager="Manager selection is required"),O.leaveType||(a.leaveType="Leave type is required"),0===u.length&&(a.dates="Please select at least one date");const s=(null===(e=O.selectedUser)||void 0===e?void 0:e.accountId)||(null===(t=O.selectedUser)||void 0===t?void 0:t.id);return function(e){let{allRequests:t,userId:a,dates:s}=e;return!!(a&&null!=s&&s.length&&null!=t&&t.length)&&t.filter((e=>!!e&&(e.userId===a||e.accountId===a||e.requester_id===a||e.targetUser&&(e.targetUser.id===a||e.targetUser.accountId===a)))).some((e=>{var t;return(null===(t=e.dailySchedules)||void 0===t?void 0:t.some((e=>s.includes(e.date))))||s.some((t=>{const a=new Date(t),s=new Date(e.start_date),r=new Date(e.end_date);return a>=s&&a<=r}))}))}({allRequests:D,userId:s,dates:u})&&(a.duplicate="This user already has a PTO request for one or more of these dates."),x(a),0===Object.keys(a).length},R=O.dailySchedules.reduce(((e,t)=>e+("FULL_DAY"===t.type?1:.5)),0),z=O.dailySchedules.reduce(((e,t)=>e+("FULL_DAY"===t.type?8:4)),0);return s.createElement("div",{className:"pto-modal-overlay"},s.createElement("div",{className:"pto-modal-content"},s.createElement("div",{className:"pto-modal-header"},s.createElement("div",{className:"pto-modal-title"},s.createElement(l.A,{size:24,className:"pto-modal-icon"}),s.createElement("h3",null,"Request Time Off")),s.createElement("button",{onClick:p,className:"pto-modal-close"},s.createElement(b.A,{size:24}))),s.createElement("div",{className:"pto-modal-body"},s.createElement("div",{className:"pto-form-section"},s.createElement("label",{className:"pto-form-label"},s.createElement(o.A,{size:16}),"Request for ",y?"*":""),y?s.createElement(g,{selectedUser:O.selectedUser,onSelect:e=>{k((t=>q(q({},t),{},{selectedUser:e,manager:null}))),e&&j(e),x((e=>q(q({},e),{},{selectedUser:null,manager:null})))},placeholder:"Search and select user",required:!0,error:_.selectedUser}):s.createElement("div",{className:"pto-user-display"},s.createElement("div",{className:"pto-user-avatar"},null!==(t=O.selectedUser)&&void 0!==t&&t.avatarUrl?s.createElement("img",{src:O.selectedUser.avatarUrl,alt:O.selectedUser.displayName}):(null===(a=O.selectedUser)||void 0===a||null===(a=a.displayName)||void 0===a?void 0:a.charAt(0))||s.createElement(o.A,{size:16})),s.createElement("div",{className:"pto-user-info"},s.createElement("div",{className:"pto-user-name"},null===(r=O.selectedUser)||void 0===r?void 0:r.displayName),s.createElement("div",{className:"pto-user-email"},null===(c=O.selectedUser)||void 0===c?void 0:c.emailAddress)),s.createElement("div",{className:"pto-user-badge"},"You")),_.selectedUser&&s.createElement("div",{className:"pto-error-text"},_.selectedUser)),s.createElement("div",{className:"pto-form-section"},s.createElement("label",{className:"pto-form-label"},s.createElement(m.A,{size:16}),"Manager *",P&&s.createElement("span",{className:"pto-loading-text"},s.createElement("div",{className:"pto-spinner"}),"Finding manager...")),s.createElement(g,{selectedUser:O.manager,onSelect:e=>{k((t=>q(q({},t),{},{manager:e}))),x((e=>q(q({},e),{},{manager:null})))},placeholder:O.manager?"Manager found automatically":"Search and select manager",required:!0,error:_.manager}),_.manager&&s.createElement("div",{className:"pto-error-text"},_.manager)),s.createElement("div",{className:"pto-form-section"},s.createElement("label",{className:"pto-form-label"},s.createElement(l.A,{size:16}),"Leave Type *"),s.createElement("div",{className:"pto-leave-types"},T.map((e=>s.createElement("button",{key:e.value,type:"button",onClick:()=>{k((t=>q(q({},t),{},{leaveType:e.value}))),x((e=>q(q({},e),{},{leaveType:null})))},className:"pto-leave-type-btn ".concat(O.leaveType===e.value?"selected":"")},s.createElement("span",{className:"pto-leave-emoji"},e.emoji),s.createElement("span",{className:"pto-leave-label"},e.label.replace(/^🏖️|🤒|👤|🎉|📋\s/,"")))))),_.leaveType&&s.createElement("div",{className:"pto-error-text"},_.leaveType)),s.createElement("div",{className:"pto-form-section"},s.createElement("label",{className:"pto-form-label"},"Reason (Optional)"),s.createElement("textarea",{value:O.reason,onChange:e=>k((t=>q(q({},t),{},{reason:e.target.value}))),className:"pto-textarea",rows:"3",placeholder:"Provide additional details about your time off request..."})),u.length>0&&s.createElement("div",{className:"pto-form-section"},s.createElement("label",{className:"pto-form-label"},s.createElement(n.A,{size:16}),"Schedule Details"),s.createElement("div",{className:"pto-schedule-container"},O.dailySchedules.map((e=>s.createElement("div",{key:e.date,className:"pto-schedule-day"},s.createElement("div",{className:"pto-schedule-date"},new Date(e.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})),s.createElement("select",{value:e.type,onChange:t=>{return a=e.date,s=t.target.value,void k((e=>q(q({},e),{},{dailySchedules:e.dailySchedules.map((e=>e.date===a?q(q({},e),{},{type:s}):e))})));var a,s},className:"pto-schedule-select"},s.createElement("option",{value:"FULL_DAY"},"Full Day (8h)"),s.createElement("option",{value:"HALF_DAY_MORNING"},"Morning Half (4h)"),s.createElement("option",{value:"HALF_DAY_AFTERNOON"},"Afternoon Half (4h)"))))))),u.length>0&&s.createElement("div",{className:"pto-summary"},s.createElement("h4",{className:"pto-summary-title"},"Request Summary"),s.createElement("div",{className:"pto-summary-grid"},s.createElement("div",{className:"pto-summary-item"},s.createElement("span",{className:"pto-summary-label"},"Total Days:"),s.createElement("span",{className:"pto-summary-value"},R)),s.createElement("div",{className:"pto-summary-item"},s.createElement("span",{className:"pto-summary-label"},"Total Hours:"),s.createElement("span",{className:"pto-summary-value"},z,"h")),s.createElement("div",{className:"pto-summary-item"},s.createElement("span",{className:"pto-summary-label"},"Date Range:"),s.createElement("span",{className:"pto-summary-value"},new Date(O.startDate).toLocaleDateString()," - ",new Date(O.endDate).toLocaleDateString())),s.createElement("div",{className:"pto-summary-item"},s.createElement("span",{className:"pto-summary-label"},"Requesting User:"),s.createElement("span",{className:"pto-summary-value"},(null===(i=O.selectedUser)||void 0===i?void 0:i.displayName)||"Not selected")))),_.duplicate&&s.createElement("div",{className:"pto-error-banner"},s.createElement(f.A,{size:16}),_.duplicate),_.dates&&s.createElement("div",{className:"pto-error-banner"},s.createElement(f.A,{size:16}),_.dates),_.submit&&s.createElement("div",{className:"pto-error-banner"},s.createElement(f.A,{size:16}),_.submit)),s.createElement("div",{className:"pto-modal-footer"},s.createElement("button",{type:"button",onClick:p,className:"pto-btn pto-btn-secondary",disabled:S},"Cancel"),s.createElement("button",{type:"button",onClick:async()=>{if(U()){A(!0);try{const e=O.dailySchedules.reduce(((e,t)=>e+("FULL_DAY"===t.type?1:.5)),0),t=O.dailySchedules.reduce(((e,t)=>e+("FULL_DAY"===t.type?8:4)),0),a={reporter:O.selectedUser,manager:O.manager,startDate:O.startDate,endDate:O.endDate,leaveType:O.leaveType,reason:O.reason.trim()||"No reason provided",dailySchedules:O.dailySchedules,totalDays:e,totalHours:t};await v(a)}catch(e){x({submit:e.message||"Failed to submit PTO request"})}finally{A(!1)}}},disabled:S||0===u.length||!O.selectedUser||!O.manager||!O.leaveType,className:"pto-btn pto-btn-primary"},S?s.createElement(s.Fragment,null,s.createElement("div",{className:"pto-spinner"}),"Submitting..."):s.createElement(s.Fragment,null,s.createElement(l.A,{size:16}),"Submit Request")))))};function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){_(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const x=function(e){let{isOpen:t,onClose:a,teams:r,users:l,onSaveTeam:n,onDeleteTeam:c,onSaveUser:m,onDeleteUser:i,showNotification:o,onRefresh:d}=e;const[u,p]=(0,s.useState)("teams"),[v,E]=(0,s.useState)("list"),[y,b]=(0,s.useState)(null),[N,f]=(0,s.useState)(null),[h,q]=(0,s.useState)(!1),[w,T]=(0,s.useState)({name:"",description:"",teamLead:null,department:"",color:"#667eea"}),[D,O]=(0,s.useState)({firstName:"",lastName:"",displayName:"",jiraAccountId:"",employmentType:"full-time",hireDate:"",teamId:"",capacity:40}),[_,x]=(0,s.useState)([{dayOfWeek:1,dayName:"Monday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:2,dayName:"Tuesday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:3,dayName:"Wednesday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:4,dayName:"Thursday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:5,dayName:"Friday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:6,dayName:"Saturday",isWorkingDay:!1,startTime:"",endTime:"",hoursPerDay:0},{dayOfWeek:7,dayName:"Sunday",isWorkingDay:!1,startTime:"",endTime:"",hoursPerDay:0}]),[S,A]=(0,s.useState)({}),P=()=>{T({name:"",description:"",teamLead:null,department:"",color:"#667eea"}),A({}),b(null)},C=()=>{O({firstName:"",lastName:"",displayName:"",jiraAccountId:"",employmentType:"full-time",hireDate:"",teamId:"",capacity:40}),x([{dayOfWeek:1,dayName:"Monday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:2,dayName:"Tuesday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:3,dayName:"Wednesday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:4,dayName:"Thursday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:5,dayName:"Friday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:6,dayName:"Saturday",isWorkingDay:!1,startTime:"",endTime:"",hoursPerDay:0},{dayOfWeek:7,dayName:"Sunday",isWorkingDay:!1,startTime:"",endTime:"",hoursPerDay:0}]),A({}),f(null)};(0,s.useEffect)((()=>{(D.firstName||D.lastName)&&O((e=>k(k({},e),{},{displayName:"".concat(D.firstName," ").concat(D.lastName).trim()})))}),[D.firstName,D.lastName]),(0,s.useEffect)((()=>{const e=_.reduce(((e,t)=>e+(t.isWorkingDay?t.hoursPerDay:0)),0);O((t=>k(k({},t),{},{capacity:e})))}),[_]);const j=(e,t)=>{T((a=>k(k({},a),{},{[e]:t}))),S[e]&&A((t=>k(k({},t),{},{[e]:null})))},U=e=>{f(e),O({firstName:e.first_name||e.firstName||"",lastName:e.last_name||e.lastName||"",displayName:e.display_name||e.displayName||"",jiraAccountId:e.jira_account_id||e.accountId||"",employmentType:e.employment_type||e.employmentType||"full-time",hireDate:e.hire_date||e.hireDate||"",teamId:e.team_id||e.teamId||"",capacity:e.capacity||40}),e.availability&&Array.isArray(e.availability)&&x(e.availability),p("users"),E("form")},R=(e,t)=>{O((a=>k(k({},a),{},{[e]:t}))),S[e]&&A((t=>k(k({},t),{},{[e]:null})))},z=(e,t,a)=>{x((s=>{const r=[...s];if(r[e]=k(k({},r[e]),{},{[t]:a}),"startTime"===t||"endTime"===t){const t=r[e];if(t.startTime&&t.endTime&&t.isWorkingDay){const a=new Date("2000-01-01T".concat(t.startTime)),s=(new Date("2000-01-01T".concat(t.endTime))-a)/36e5;r[e].hoursPerDay=Math.max(0,s)}}return"isWorkingDay"!==t||a||(r[e].startTime="",r[e].endTime="",r[e].hoursPerDay=0),r}))},F=async(e,t)=>{if(window.confirm('Are you sure you want to delete the user "'.concat(t,'"? This action cannot be undone.'))){q(!0);try{await i(e),o("User deleted successfully"),d&&d()}catch(e){o("Failed to delete user","error")}finally{q(!1)}}},L=e=>l.filter((t=>t.team_id===e||t.teamId===e)),I=()=>l.filter((e=>!e.team_id&&!e.teamId));return t?s.createElement("div",{className:"modal-overlay"},s.createElement("div",{className:"modal-content team-management-modal"},s.createElement("div",{className:"modal-header"},s.createElement("h3",null,"Team & User Management"),s.createElement("button",{className:"modal-close",onClick:a},"×")),s.createElement("div",{className:"modal-body"},s.createElement("div",{className:"main-tab-navigation"},s.createElement("button",{className:"main-tab-btn ".concat("teams"===u?"active":""),onClick:()=>{p("teams"),E("list"),P(),C()}},"👥 Teams (",r.length,")"),s.createElement("button",{className:"main-tab-btn ".concat("users"===u?"active":""),onClick:()=>{p("users"),E("list"),P(),C()}},"👤 Users (",l.length,")")),"teams"===u&&s.createElement(s.Fragment,null,s.createElement("div",{className:"sub-tab-navigation"},s.createElement("button",{className:"tab-btn ".concat("list"===v?"active":""),onClick:()=>E("list")},"Teams List"),s.createElement("button",{className:"tab-btn ".concat("form"===v?"active":""),onClick:()=>{E("form"),P()}},y?"Edit Team":"Add New Team")),"list"===v&&s.createElement("div",{className:"teams-section"},0===r.length?s.createElement("div",{className:"empty-state"},s.createElement("div",{className:"empty-icon"},"👥"),s.createElement("h4",null,"No Teams Created"),s.createElement("p",null,"Create your first team to organize your resources"),s.createElement("button",{className:"btn btn-primary",onClick:()=>{P(),E("form")}},"Create First Team")):s.createElement("div",{className:"teams-grid"},r.map((e=>{var t,a;const r=L(e.id);return s.createElement("div",{key:e.id,className:"team-card",style:{borderLeftColor:e.color}},s.createElement("div",{className:"team-header"},s.createElement("h4",null,e.name),s.createElement("div",{className:"team-actions"},s.createElement("button",{className:"btn btn-sm btn-secondary",onClick:()=>(e=>{b(e);let t=null;e.team_lead&&("string"==typeof e.team_lead?t=l.find((t=>t.display_name===e.team_lead||t.displayName===e.team_lead||t.name===e.team_lead))||null:"object"==typeof e.team_lead&&(t=e.team_lead)),T({name:e.name||"",description:e.description||"",teamLead:t,department:e.department||"",color:e.color||"#667eea"}),E("form")})(e),disabled:h},"Edit"),s.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async(e,t)=>{if(window.confirm('Are you sure you want to delete the team "'.concat(t,'"? This action cannot be undone.'))){q(!0);try{await c(e),o("Team deleted successfully"),d&&d()}catch(e){o("Failed to delete team","error")}finally{q(!1)}}})(e.id,e.name),disabled:h},"Delete"))),e.description&&s.createElement("p",{className:"team-description"},e.description),s.createElement("div",{className:"team-meta"},e.department&&s.createElement("span",{className:"team-department"},"📁 ",e.department),(e.team_lead||(null===(t=e.manager)||void 0===t?void 0:t.displayName))&&s.createElement("span",{className:"team-lead"},"👤 ",e.team_lead||(null===(a=e.manager)||void 0===a?void 0:a.displayName)),s.createElement("span",{className:"member-count"},r.length," members")),r.length>0&&s.createElement("div",{className:"team-members-preview"},s.createElement("h5",null,"Members:"),s.createElement("div",{className:"members-list"},r.slice(0,3).map((e=>{var t;return s.createElement("div",{key:e.id,className:"member-preview"},s.createElement("div",{className:"member-avatar-small"},e.avatar_url||e.avatarUrl?s.createElement("img",{src:e.avatar_url||e.avatarUrl,alt:e.display_name||e.displayName}):s.createElement("div",{className:"avatar-placeholder-small"},(null===(t=e.display_name||e.displayName||e.name)||void 0===t?void 0:t.charAt(0))||"?")),s.createElement("span",{className:"member-name-small"},e.display_name||e.displayName||e.name))})),r.length>3&&s.createElement("div",{className:"more-members"},"+",r.length-3," more"))))})))),"form"===v&&s.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return w.name.trim()||(e.name="Team name is required"),A(e),0===Object.keys(e).length})()){q(!0);try{var t,a;const e={id:null==y?void 0:y.id,name:w.name,description:w.description,team_lead:(null===(t=w.teamLead)||void 0===t?void 0:t.displayName)||(null===(a=w.teamLead)||void 0===a?void 0:a.display_name)||"",teamLeadUser:w.teamLead,department:w.department,color:w.color,manager:(null==y?void 0:y.manager)||w.teamLead||null,members:(null==y?void 0:y.members)||[]};await n(e),o(y?"Team updated successfully":"Team created successfully"),P(),E("list"),d&&d()}catch(e){o("Failed to save team","error")}finally{q(!1)}}},className:"team-form"},s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"team-name"},"Team Name *"),s.createElement("input",{type:"text",id:"team-name",className:"form-control ".concat(S.name?"error":""),value:w.name,onChange:e=>j("name",e.target.value),placeholder:"Enter team name",disabled:h}),S.name&&s.createElement("span",{className:"error-text"},S.name)),s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"team-description"},"Description"),s.createElement("textarea",{id:"team-description",className:"form-control",value:w.description,onChange:e=>j("description",e.target.value),placeholder:"Brief description of the team's purpose",rows:"3",disabled:h})),s.createElement("div",{className:"form-row"},s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"team-lead"},"Team Lead"),s.createElement(g,{selectedUser:w.teamLead,onSelect:e=>{T((t=>k(k({},t),{},{teamLead:e}))),S.teamLead&&A((e=>k(k({},e),{},{teamLead:null})))},placeholder:"Search and select team lead",disabled:h,error:S.teamLead}),S.teamLead&&s.createElement("span",{className:"error-text"},S.teamLead)),s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"department"},"Department"),s.createElement("select",{id:"department",className:"form-control",value:w.department,onChange:e=>j("department",e.target.value),disabled:h},s.createElement("option",{value:""},"Select Department"),["Product","Devops","RebelCare","Strategy","Service Delivery","Client Services"].map((e=>s.createElement("option",{key:e,value:e},e)))))),s.createElement("div",{className:"form-group"},s.createElement("label",null,"Team Color"),s.createElement("div",{className:"color-options"},["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#ffecd2","#fcb69f"].map((e=>s.createElement("div",{key:e,className:"color-option ".concat(w.color===e?"selected":""),style:{backgroundColor:e},onClick:()=>!h&&j("color",e)}))))),s.createElement("div",{className:"form-actions"},s.createElement("button",{type:"submit",className:"btn btn-primary",disabled:h},h?"Saving...":y?"Update Team":"Create Team"),s.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{P(),E("list")},disabled:h},"Cancel")))),"users"===u&&s.createElement(s.Fragment,null,s.createElement("div",{className:"sub-tab-navigation"},s.createElement("button",{className:"tab-btn ".concat("list"===v?"active":""),onClick:()=>E("list")},"Users List"),s.createElement("button",{className:"tab-btn ".concat("form"===v?"active":""),onClick:()=>{E("form"),C()}},N?"Edit User":"Add New User")),"list"===v&&s.createElement("div",{className:"users-section"},0===l.length?s.createElement("div",{className:"empty-state"},s.createElement("div",{className:"empty-icon"},"👤"),s.createElement("h4",null,"No Users Created"),s.createElement("p",null,"Add your first team member to get started"),s.createElement("button",{className:"btn btn-primary",onClick:()=>{C(),E("form")}},"Add First User")):s.createElement(s.Fragment,null,r.map((e=>{const t=L(e.id);return 0===t.length?null:s.createElement("div",{key:e.id,className:"team-users-section"},s.createElement("h4",{style:{color:e.color}},e.name," (",t.length," members)"),s.createElement("div",{className:"users-grid"},t.map((e=>{var t,a;return s.createElement("div",{key:e.id,className:"user-card"},s.createElement("div",{className:"user-avatar"},e.avatar_url||e.avatarUrl?s.createElement("img",{src:e.avatar_url||e.avatarUrl,alt:e.display_name||e.displayName}):s.createElement("div",{className:"avatar-placeholder"},(null===(t=e.display_name||e.displayName||e.name)||void 0===t?void 0:t.charAt(0))||"?")),s.createElement("div",{className:"user-info"},s.createElement("h5",null,e.display_name||e.displayName||e.name),s.createElement("p",{className:"user-role"},null===(a=e.employment_type||e.employmentType)||void 0===a?void 0:a.replace("-"," ")),s.createElement("div",{className:"user-capacity"},e.capacity||40,"h/week capacity")),s.createElement("div",{className:"user-actions"},s.createElement("button",{className:"btn btn-sm btn-secondary",onClick:()=>U(e),disabled:h},"Edit"),s.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>F(e.id,e.display_name||e.displayName||e.name),disabled:h},"Delete")))}))))})),I().length>0&&s.createElement("div",{className:"team-users-section"},s.createElement("h4",{style:{color:"#6c757d"}},"Unassigned Users (",I().length,")"),s.createElement("div",{className:"users-grid"},I().map((e=>{var t,a;return s.createElement("div",{key:e.id,className:"user-card"},s.createElement("div",{className:"user-avatar"},e.avatar_url||e.avatarUrl?s.createElement("img",{src:e.avatar_url||e.avatarUrl,alt:e.display_name||e.displayName}):s.createElement("div",{className:"avatar-placeholder"},(null===(t=e.display_name||e.displayName||e.name)||void 0===t?void 0:t.charAt(0))||"?")),s.createElement("div",{className:"user-info"},s.createElement("h5",null,e.display_name||e.displayName||e.name),s.createElement("p",{className:"user-role"},null===(a=e.employment_type||e.employmentType)||void 0===a?void 0:a.replace("-"," ")),s.createElement("div",{className:"user-capacity"},e.capacity||40,"h/week capacity")),s.createElement("div",{className:"user-actions"},s.createElement("button",{className:"btn btn-sm btn-secondary",onClick:()=>U(e),disabled:h},"Edit"),s.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>F(e.id,e.display_name||e.displayName||e.name),disabled:h},"Delete")))})))))),"form"===v&&s.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return D.firstName.trim()||(e.firstName="First name is required"),D.lastName.trim()||(e.lastName="Last name is required"),A(e),0===Object.keys(e).length})()){q(!0);try{const e={id:null==N?void 0:N.id,first_name:D.firstName,last_name:D.lastName,display_name:D.displayName,jira_account_id:D.jiraAccountId,employment_type:D.employmentType,hire_date:D.hireDate,team_id:D.teamId,capacity:D.capacity,availability:_};await m(e),o(N?"User updated successfully":"User created successfully"),C(),E("list"),d&&d()}catch(e){o("Failed to save user","error")}finally{q(!1)}}},className:"user-form"},s.createElement("div",{className:"form-row"},s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"firstName"},"First Name *"),s.createElement("input",{type:"text",id:"firstName",className:"form-control ".concat(S.firstName?"error":""),value:D.firstName,onChange:e=>R("firstName",e.target.value),placeholder:"Enter first name",disabled:h}),S.firstName&&s.createElement("span",{className:"error-text"},S.firstName)),s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"lastName"},"Last Name *"),s.createElement("input",{type:"text",id:"lastName",className:"form-control ".concat(S.lastName?"error":""),value:D.lastName,onChange:e=>R("lastName",e.target.value),placeholder:"Enter last name",disabled:h}),S.lastName&&s.createElement("span",{className:"error-text"},S.lastName))),s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"displayName"},"Display Name"),s.createElement("input",{type:"text",id:"displayName",className:"form-control",value:D.displayName,onChange:e=>R("displayName",e.target.value),placeholder:"Display name (auto-generated from first/last name)",disabled:h})),s.createElement("div",{className:"form-row"},s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"employmentType"},"Employment Type"),s.createElement("select",{id:"employmentType",className:"form-control",value:D.employmentType,onChange:e=>R("employmentType",e.target.value),disabled:h},s.createElement("option",{value:"full-time"},"Full-time"),s.createElement("option",{value:"part-time"},"Part-time"),s.createElement("option",{value:"contractor"},"Contractor"))),s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"hireDate"},"Hire Date"),s.createElement("input",{type:"date",id:"hireDate",className:"form-control",value:D.hireDate,onChange:e=>R("hireDate",e.target.value),disabled:h}))),s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"teamId"},"Team"),s.createElement("select",{id:"teamId",className:"form-control",value:D.teamId||"",onChange:e=>R("teamId",e.target.value),disabled:h},s.createElement("option",{value:""},"Select a team (optional)"),r.map((e=>s.createElement("option",{key:e.id,value:e.id},e.name))))),s.createElement("div",{className:"form-group"},s.createElement("label",{htmlFor:"jiraAccountId"},"Jira Account ID"),s.createElement("input",{type:"text",id:"jiraAccountId",className:"form-control",value:D.jiraAccountId,onChange:e=>R("jiraAccountId",e.target.value),placeholder:"Optional: Link to Jira account",disabled:h})),s.createElement("div",{className:"availability-section"},s.createElement("h4",null,"Working Schedule"),s.createElement("p",{className:"help-text"},"Set the default working hours for this team member."),s.createElement("div",{className:"availability-grid"},_.map(((e,t)=>s.createElement("div",{key:e.dayOfWeek,className:"availability-day"},s.createElement("div",{className:"day-header"},s.createElement("label",{className:"checkbox-label"},s.createElement("input",{type:"checkbox",checked:e.isWorkingDay,onChange:e=>z(t,"isWorkingDay",e.target.checked),disabled:h}),s.createElement("span",{className:"day-name"},e.dayName))),e.isWorkingDay&&s.createElement("div",{className:"day-details"},s.createElement("div",{className:"time-inputs"},s.createElement("input",{type:"time",value:e.startTime,onChange:e=>z(t,"startTime",e.target.value),className:"form-control input-small",disabled:h}),s.createElement("span",null,"to"),s.createElement("input",{type:"time",value:e.endTime,onChange:e=>z(t,"endTime",e.target.value),className:"form-control input-small",disabled:h})),s.createElement("div",{className:"hours-display"},e.hoursPerDay.toFixed(1)," hours")))))),s.createElement("div",{className:"availability-summary"},s.createElement("strong",null,"Total weekly capacity: "),_.reduce(((e,t)=>e+(t.isWorkingDay?t.hoursPerDay:0)),0).toFixed(1)," hours")),s.createElement("div",{className:"form-actions"},s.createElement("button",{type:"submit",className:"btn btn-primary",disabled:h},h?"Saving...":N?"Update User":"Create User"),s.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{C(),E("list")},disabled:h},"Cancel"))))),s.createElement("div",{className:"modal-footer"},s.createElement("button",{className:"btn btn-secondary",onClick:a,disabled:h},"Close")))):null};function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(Object(a),!0).forEach((function(t){P(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function P(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function C(e){let{title:t,value:a,color:r,icon:l}=e;return s.createElement("div",{className:"summary-card summary-card-".concat(r)},s.createElement("div",{className:"summary-card-icon"},l),s.createElement("div",{className:"summary-card-content"},s.createElement("div",{className:"summary-card-title"},t),s.createElement("div",{className:"summary-card-value"},a)))}function j(e){let{title:t,children:a,onClose:r}=e;return s.createElement("div",{className:"modal-overlay"},s.createElement("div",{className:"modal-content",style:{maxWidth:500}},s.createElement("div",{className:"modal-header"},s.createElement("h3",null,t),s.createElement("button",{className:"modal-close",onClick:r},s.createElement(b.A,{size:24}))),s.createElement("div",{className:"modal-body"},a)))}const U=e=>{let{currentUser:t,showNotification:a,onNavigateToCalendar:r}=e;const[n,c]=(0,s.useState)("overview"),[o,u]=(0,s.useState)(!1),[b,N]=(0,s.useState)([]),[f,h]=(0,s.useState)([]),[q,w]=(0,s.useState)([]),[T,O]=(0,s.useState)([]),[k,_]=(0,s.useState)(!1),[S,P]=(0,s.useState)(!1),[U,R]=(0,s.useState)(!1),[z,F]=(0,s.useState)(null);(0,s.useEffect)((()=>{L()}),[]);const L=async()=>{u(!0);try{await Promise.all([I(),M(),W(),Y()])}catch(e){a("Failed to load admin data","error")}finally{u(!1)}},I=async()=>{try{const e=await(0,d.invoke)("getAdminUsers");e.success&&N(e.data||[])}catch(e){}},M=async()=>{try{const e=await(0,d.invoke)("getTeams");e.success&&h(e.data||[])}catch(e){}},W=async()=>{try{const e=await(0,d.invoke)("getUsers");e.success&&w(e.data||[])}catch(e){}},Y=async()=>{try{const e=await(0,d.invoke)("getPTORequests");e.success&&O(e.data||[])}catch(e){}},H=e=>{r&&r("calendar",{teamId:e})},B=e=>{r&&r("calendar",{userId:e})},V={totalAdmins:b.length,totalTeams:f.length,totalUsers:q.length,totalRequests:T.length,pendingRequests:T.filter((e=>"pending"===e.status)).length,approvedRequests:T.filter((e=>"approved"===e.status)).length};return s.createElement("div",{className:"dashboard"},s.createElement("div",{className:"main-tabs"},s.createElement("button",{className:"tab-btn".concat("overview"===n?" active":""),onClick:()=>c("overview")},"📊 Overview"),s.createElement("button",{className:"tab-btn".concat("teams"===n?" active":""),onClick:()=>c("teams")},"👥 Teams"),s.createElement("button",{className:"tab-btn".concat("users"===n?" active":""),onClick:()=>c("users")},"👤 Users"),s.createElement("button",{className:"tab-btn".concat("analytics"===n?" active":""),onClick:()=>c("analytics")},"📈 Analytics")),"overview"===n&&s.createElement("div",{className:"dashboard-section"},s.createElement("div",{className:"dashboard-cards"},s.createElement(C,{title:"Admin Users",value:V.totalAdmins,color:"purple",icon:s.createElement(i.A,{size:24})}),s.createElement(C,{title:"Teams",value:V.totalTeams,color:"blue",icon:s.createElement(m.A,{size:24})}),s.createElement(C,{title:"Total Users",value:V.totalUsers,color:"emerald",icon:s.createElement(p.A,{size:24})}),s.createElement(C,{title:"PTO Requests",value:V.totalRequests,color:"orange",icon:s.createElement(l.A,{size:24})}),s.createElement(C,{title:"Pending",value:V.pendingRequests,color:"yellow",icon:s.createElement(l.A,{size:24})}),s.createElement(C,{title:"Approved",value:V.approvedRequests,color:"green",icon:s.createElement(l.A,{size:24})})),s.createElement("div",{className:"card"},s.createElement("div",{className:"card-header"},"Quick Actions"),s.createElement("div",{className:"quick-actions"},s.createElement("button",{onClick:()=>P(!0),className:"action-btn"},s.createElement("div",{className:"action-icon bg-blue"},s.createElement(v.A,{size:20})),s.createElement("div",null,s.createElement("div",{className:"action-title"},"Manage Teams & Users"),s.createElement("div",{className:"action-desc"},"Advanced team and user management"))),s.createElement("button",{onClick:()=>_(!0),className:"action-btn"},s.createElement("div",{className:"action-icon bg-purple"},s.createElement(i.A,{size:20})),s.createElement("div",null,s.createElement("div",{className:"action-title"},"Add Admin"),s.createElement("div",{className:"action-desc"},"Grant admin privileges"))),s.createElement("button",{onClick:()=>R(!0),className:"action-btn"},s.createElement("div",{className:"action-icon bg-green"},s.createElement(l.A,{size:20})),s.createElement("div",null,s.createElement("div",{className:"action-title"},"Create PTO"),s.createElement("div",{className:"action-desc"},"Create PTO for users"))),s.createElement("button",{onClick:()=>H(),className:"action-btn"},s.createElement("div",{className:"action-icon bg-indigo"},s.createElement(E.A,{size:20})),s.createElement("div",null,s.createElement("div",{className:"action-title"},"View Calendar"),s.createElement("div",{className:"action-desc"},"View all PTO requests on calendar"))))),s.createElement("div",{className:"card"},s.createElement("div",{className:"card-header"},"Recent PTO Requests"),s.createElement("div",{className:"card-body"},T.slice(0,8).map((e=>{var t;return s.createElement("div",{key:e.id,className:"request-row"},s.createElement("div",{className:"request-avatar"},(null===(t=e.requester_name)||void 0===t?void 0:t.charAt(0))||"?"),s.createElement("div",{className:"request-info"},s.createElement("span",{className:"request-user"},e.requester_name),s.createElement("span",{className:"request-type"},"requested ",e.leave_type),s.createElement("div",{className:"request-date"},new Date(e.start_date).toLocaleDateString())),s.createElement("div",{className:"request-actions"},s.createElement("span",{className:"status-badge status-".concat(e.status)},e.status),s.createElement("button",{onClick:()=>B(e.requester_id),className:"btn-icon",title:"View user's calendar"},s.createElement(y.A,{size:14}))))}))))),"teams"===n&&s.createElement("div",{className:"dashboard-section"},s.createElement("div",{className:"card"},s.createElement("div",{className:"card-header"},s.createElement("span",null,"Team Management"),s.createElement("button",{onClick:()=>P(!0),className:"btn btn-primary"},"Manage Teams")),s.createElement("div",{className:"teams-grid"},f.map((e=>{const t=(e=>{const t=q.filter((t=>t.team_id===e)),a=t.map((e=>e.jira_account_id||e.id)),s=T.filter((e=>a.includes(e.requester_id)));return{memberCount:t.length,totalRequests:s.length,pendingRequests:s.filter((e=>"pending"===e.status)).length,approvedRequests:s.filter((e=>"approved"===e.status)).length,totalDaysOff:s.filter((e=>"approved"===e.status)).reduce(((e,t)=>e+(t.total_days||0)),0)}})(e.id);return s.createElement("div",{key:e.id,className:"team-admin-card"},s.createElement("div",{className:"team-card-header"},s.createElement("div",{className:"team-info"},s.createElement("h4",{style:{color:e.color||"#6366f1"}},e.name),e.description&&s.createElement("p",{className:"team-description"},e.description)),s.createElement("div",{className:"team-actions"},s.createElement("button",{onClick:()=>H(e.id),className:"btn btn-sm btn-secondary",title:"View team calendar"},s.createElement(E.A,{size:16}),"Calendar"))),s.createElement("div",{className:"team-stats-grid"},s.createElement("div",{className:"stat-item"},s.createElement("span",{className:"stat-value"},t.memberCount),s.createElement("span",{className:"stat-label"},"Members")),s.createElement("div",{className:"stat-item"},s.createElement("span",{className:"stat-value"},t.totalRequests),s.createElement("span",{className:"stat-label"},"Requests")),s.createElement("div",{className:"stat-item"},s.createElement("span",{className:"stat-value"},t.pendingRequests),s.createElement("span",{className:"stat-label"},"Pending")),s.createElement("div",{className:"stat-item"},s.createElement("span",{className:"stat-value"},t.totalDaysOff),s.createElement("span",{className:"stat-label"},"Days Off"))),s.createElement("div",{className:"team-members-preview"},s.createElement("h5",null,"Recent Activity:"),T.filter((t=>q.filter((t=>t.team_id===e.id)).map((e=>e.jira_account_id||e.id)).includes(t.requester_id))).slice(0,3).map((e=>s.createElement("div",{key:e.id,className:"activity-item"},s.createElement("span",{className:"activity-user"},e.requester_name),s.createElement("span",{className:"activity-action"},e.leave_type," • ",new Date(e.start_date).toLocaleDateString()),s.createElement("span",{className:"activity-status status-".concat(e.status)},e.status))))))}))))),"users"===n&&s.createElement("div",{className:"dashboard-section"},s.createElement("div",{className:"card"},s.createElement("div",{className:"card-header"},s.createElement("span",null,"User Management"),s.createElement("button",{onClick:()=>P(!0),className:"btn btn-primary"},"Manage Users")),s.createElement("div",{className:"users-grid"},q.map((e=>{var t;const a=(e=>{const t=new Date,a=T.filter((a=>a.requester_id===e&&"approved"===a.status&&new Date(a.start_date)<=t&&new Date(a.end_date)>=t));return a.length>0?a[0]:null})(e.jira_account_id||e.id),r=f.find((t=>t.id===e.team_id)),l=T.filter((t=>t.requester_id===(e.jira_account_id||e.id)));return s.createElement("div",{key:e.id,className:"user-admin-card"},s.createElement("div",{className:"user-card-header"},s.createElement("div",{className:"user-avatar-large"},e.avatar_url?s.createElement("img",{src:e.avatar_url,alt:e.display_name}):s.createElement("div",{className:"avatar-placeholder-large"},(null===(t=e.display_name||e.displayName||e.name)||void 0===t?void 0:t.charAt(0))||"?")),s.createElement("div",{className:"user-info"},s.createElement("h4",null,e.display_name||e.displayName||e.name),s.createElement("p",{className:"user-email"},e.email_address||e.emailAddress),r&&s.createElement("span",{className:"user-team",style:{color:r.color}},r.name)),s.createElement("div",{className:"user-actions"},s.createElement("button",{onClick:()=>B(e.jira_account_id||e.id),className:"btn btn-sm btn-secondary",title:"View user's calendar"},s.createElement(E.A,{size:16}),"Calendar"))),a&&s.createElement("div",{className:"current-pto-banner"},"🏖️ Currently on ",a.leave_type," leave until ",new Date(a.end_date).toLocaleDateString()),s.createElement("div",{className:"user-stats-grid"},s.createElement("div",{className:"stat-item"},s.createElement("span",{className:"stat-value"},l.length),s.createElement("span",{className:"stat-label"},"Total Requests")),s.createElement("div",{className:"stat-item"},s.createElement("span",{className:"stat-value"},l.filter((e=>"pending"===e.status)).length),s.createElement("span",{className:"stat-label"},"Pending")),s.createElement("div",{className:"stat-item"},s.createElement("span",{className:"stat-value"},l.filter((e=>"approved"===e.status)).reduce(((e,t)=>e+(t.total_days||0)),0)),s.createElement("span",{className:"stat-label"},"Days Used"))))}))))),"analytics"===n&&s.createElement("div",{className:"dashboard-section"},s.createElement("div",{className:"analytics-grid"},s.createElement("div",{className:"card"},s.createElement("div",{className:"card-header"},"PTO Requests by Status"),s.createElement("div",{className:"card-body"},s.createElement("table",{className:"dashboard-table"},s.createElement("thead",null,s.createElement("tr",null,s.createElement("th",null,"Status"),s.createElement("th",null,"Count"),s.createElement("th",null,"Percentage"))),s.createElement("tbody",null,s.createElement("tr",null,s.createElement("td",null,s.createElement("span",{className:"status-badge status-approved"},"Approved")),s.createElement("td",null,V.approvedRequests),s.createElement("td",null,V.totalRequests>0?Math.round(V.approvedRequests/V.totalRequests*100):0,"%")),s.createElement("tr",null,s.createElement("td",null,s.createElement("span",{className:"status-badge status-pending"},"Pending")),s.createElement("td",null,V.pendingRequests),s.createElement("td",null,V.totalRequests>0?Math.round(V.pendingRequests/V.totalRequests*100):0,"%")),s.createElement("tr",null,s.createElement("td",null,s.createElement("span",{className:"status-badge status-declined"},"Declined")),s.createElement("td",null,T.filter((e=>"declined"===e.status)).length),s.createElement("td",null,V.totalRequests>0?Math.round(T.filter((e=>"declined"===e.status)).length/V.totalRequests*100):0,"%")),s.createElement("tr",{className:"table-total"},s.createElement("td",null,s.createElement("strong",null,"Total")),s.createElement("td",null,s.createElement("strong",null,V.totalRequests)),s.createElement("td",null,s.createElement("strong",null,"100%"))))))),s.createElement("div",{className:"card"},s.createElement("div",{className:"card-header"},"Leave Types Distribution"),s.createElement("div",{className:"card-body"},s.createElement("div",{className:"leave-types-stats"},["vacation","sick","personal","holiday"].map((e=>{const t=T.filter((t=>t.leave_type===e)).length,a=V.totalRequests>0?Math.round(t/V.totalRequests*100):0;return s.createElement("div",{key:e,className:"leave-type-stat"},s.createElement("div",{className:"leave-type-header"},s.createElement("span",{className:"leave-type-name"},e.charAt(0).toUpperCase()+e.slice(1)),s.createElement("span",{className:"leave-type-count"},t)),s.createElement("div",{className:"leave-type-bar"},s.createElement("div",{className:"leave-type-progress",style:{width:"".concat(a,"%")}})),s.createElement("span",{className:"leave-type-percentage"},a,"%"))}))))))),k&&s.createElement(j,{title:"Add Admin User",onClose:()=>_(!1)},s.createElement(g,{selectedUser:null,onSelect:async e=>{if(e)try{const s=await(0,d.invoke)("addAdminUser",{accountId:e.accountId,addedBy:t.accountId});s.success?(a("".concat(e.displayName," added as admin")),_(!1),I()):a(s.message||"Failed to add admin","error")}catch(e){a("Failed to add admin user","error")}},placeholder:"Search and select user to grant admin privileges",required:!0}),s.createElement("div",{className:"modal-actions"},s.createElement("button",{className:"btn btn-secondary",onClick:()=>_(!1)},"Cancel"))),S&&s.createElement(x,{isOpen:S,onClose:()=>P(!1),teams:f,users:q,onSaveTeam:async e=>{f.some((t=>t.name.trim().toLowerCase()===e.name.trim().toLowerCase()&&t.id!==e.id))?a("A team with this name already exists.","error"):(await(0,d.invoke)(e.id?"updateTeam":"createTeam",e),M())},onDeleteTeam:async e=>{await(0,d.invoke)("deleteTeam",{teamId:e,deletedBy:t.accountId}),M()},onSaveUser:async e=>{q.some((t=>{var a,s;return((null===(a=t.email)||void 0===a?void 0:a.toLowerCase())===(null===(s=e.email)||void 0===s?void 0:s.toLowerCase())||t.accountId===e.accountId)&&t.id!==e.id}))?a("A user with this email or account already exists.","error"):(await(0,d.invoke)(e.id?"updateUser":"createUser",e),W())},onDeleteUser:async e=>{await(0,d.invoke)("deleteUser",{userId:e,deletedBy:t.accountId}),W()},showNotification:a,onRefresh:L}),U&&s.createElement(D,{isAdminMode:!0,onClose:()=>{R(!1),F(null)},onSubmit:async e=>{if(null!=e&&e.targetUser)try{const s=await(0,d.invoke)("submitPTOForUser",A(A({},e),{},{submittedBy:t.accountId}));s.success?(a("PTO request created for ".concat(e.targetUser.displayName)),R(!1),F(null),Y()):a(s.message||"Failed to create PTO request","error")}catch(e){a("Failed to create PTO request","error")}else a("Please select a user for PTO","error")},targetUser:z,allUsers:q,allTeams:f,allRequests:T}))};var R=a(6316),z=a(8309),F=a(180);const L=e=>{let{status:t}=e;const a=(e=>{const t={pending:{bg:"bg-yellow-100",text:"text-yellow-800",icon:f.A,label:"Pending"},approved:{bg:"bg-green-100",text:"text-green-800",icon:c.A,label:"Approved"},declined:{bg:"bg-red-100",text:"text-red-800",icon:F.A,label:"Declined"}};return t[e.toLowerCase()]||t.pending})(t),r=a.icon;return s.createElement("span",{className:"inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ".concat(a.bg," ").concat(a.text)},s.createElement(r,{size:12}),s.createElement("span",null,a.label))},I={vacation:{id:"vacation",label:"🏖️ Vacation",emoji:"🏖️",color:"bg-blue-100 text-blue-800"},sick:{id:"sick",label:"🤒 Sick Leave",emoji:"🤒",color:"bg-red-100 text-red-800"},personal:{id:"personal",label:"👤 Personal Day",emoji:"👤",color:"bg-purple-100 text-purple-800"},holiday:{id:"holiday",label:"🎉 Holiday",emoji:"🎉",color:"bg-green-100 text-green-800"}},M=e=>{var t;return(null===(t=I[e.toLowerCase()])||void 0===t?void 0:t.emoji)||"📅"},W=e=>{var t;let{teamData:a,requests:r,currentUser:n}=e;const[c,i]=(0,s.useState)("current_month"),[u,p]=(0,s.useState)("all"),[v,E]=(0,s.useState)([]),[y,b]=(0,s.useState)(null),[N,g]=(0,s.useState)([]),[f,h]=(0,s.useState)(!0),[q,w]=(0,s.useState)(""),[T,D]=(0,s.useState)([]);(0,s.useEffect)((()=>{n&&O()}),[n]),(0,s.useEffect)((()=>{y&&k()}),[y,c]);const O=async()=>{h(!0);try{const e=await(0,d.invoke)("getTeams");if(!e.success)throw new Error(e.message||"Failed to load teams");{const t=e.data||[];E(t);const a=t.find((e=>{var t,a;return(null===(t=e.manager)||void 0===t?void 0:t.accountId)===n.accountId||(null===(a=e.members)||void 0===a?void 0:a.some((e=>e.accountId===n.accountId)))}));b(a||t[0]||null)}}catch(e){w("Failed to load teams: "+e.message)}finally{h(!1)}},k=async()=>{if(y)try{const e=await(0,d.invoke)("getTeamPTORequests",{teamId:y.id,dateRange:c});g(e.success&&e.data||[])}catch(e){g([])}},_=(()=>{const e=N||[];return{totalRequests:e.length,approvedRequests:e.filter((e=>"approved"===e.status)).length,pendingRequests:e.filter((e=>"pending"===e.status)).length,totalDaysOff:e.filter((e=>"approved"===e.status)).reduce(((e,t)=>e+(t.total_days||0)),0)}})(),x=(()=>{const e=new Date;return(N||[]).filter((t=>"approved"===t.status&&new Date(t.start_date)>=e)).sort(((e,t)=>new Date(e.start_date)-new Date(t.start_date))).slice(0,5)})(),S=(()=>{let e=N||[];return"all"!==u&&(e=e.filter((e=>e.requester_id===u))),e.sort(((e,t)=>new Date(t.submitted_at)-new Date(e.submitted_at)))})(),A=(null==y?void 0:y.members)||[];return f?s.createElement("div",{className:"loading-container"},s.createElement("div",{className:"loading-spinner"}),s.createElement("p",null,"Loading team information...")):q?s.createElement("div",{className:"error-container"},s.createElement("div",{className:"error-icon"},"⚠️"),s.createElement("h3",{className:"error-title"},"Error Loading Teams"),s.createElement("p",{className:"error-desc"},q),s.createElement("button",{className:"btn btn-primary",onClick:O},"Retry")):0===v.length?s.createElement("div",{className:"empty-state-card"},s.createElement(m.A,{size:48,className:"empty-icon"}),s.createElement("h3",null,"No Teams Found"),s.createElement("p",null,"You don't have access to any teams yet. Contact your administrator to be added to a team.")):s.createElement("div",{className:"team-dashboard"},s.createElement("div",{className:"card team-header-card"},s.createElement("div",{className:"team-header"},s.createElement("div",{className:"team-header-title"},s.createElement("div",{className:"team-header-icon"},s.createElement(m.A,{size:20})),s.createElement("div",null,s.createElement("h1",null,"Team Dashboard"),s.createElement("p",null,"Manage and overview team PTO requests"))),s.createElement("select",{className:"team-select",value:(null==y?void 0:y.id)||"",onChange:e=>b(v.find((t=>t.id===e.target.value)))},v.map((e=>{var t;return s.createElement("option",{key:e.id,value:e.id},e.name," (",(null===(t=e.members)||void 0===t?void 0:t.length)||0," members)")})))),y&&s.createElement("div",{className:"team-meta"},s.createElement("div",null,s.createElement("h3",null,y.name),y.description&&s.createElement("p",null,y.description),s.createElement("p",{className:"team-manager"},"Manager: ",(null===(t=y.manager)||void 0===t?void 0:t.displayName)||"Not assigned")),s.createElement("div",{className:"team-member-count"},s.createElement("div",null,A.length),s.createElement("div",null,"Team Members")))),s.createElement("div",{className:"team-stats-cards"},s.createElement("div",{className:"team-stat-card stat-blue"},s.createElement("span",{className:"team-stat-label"},"Total Requests"),s.createElement("span",{className:"team-stat-value"},_.totalRequests),s.createElement(l.A,{size:20})),s.createElement("div",{className:"team-stat-card stat-green"},s.createElement("span",{className:"team-stat-label"},"Approved"),s.createElement("span",{className:"team-stat-value"},_.approvedRequests),s.createElement(R.A,{size:20})),s.createElement("div",{className:"team-stat-card stat-yellow"},s.createElement("span",{className:"team-stat-label"},"Pending"),s.createElement("span",{className:"team-stat-value"},_.pendingRequests),s.createElement(l.A,{size:20})),s.createElement("div",{className:"team-stat-card stat-purple"},s.createElement("span",{className:"team-stat-label"},"Total Days Off"),s.createElement("span",{className:"team-stat-value"},_.totalDaysOff),s.createElement(m.A,{size:20}))),s.createElement("div",{className:"team-dashboard-panels"},s.createElement("div",{className:"card team-members-panel"},s.createElement("h3",null,"Team Members"),0===A.length?s.createElement("div",{className:"empty-panel"},s.createElement(o.A,{size:24,className:"empty-icon"}),s.createElement("p",null,"No team members")):A.map((e=>{var t;const a=(N||[]).filter((t=>t.requester_id===e.accountId)).filter((e=>"approved"===e.status&&new Date(e.start_date)<=new Date&&new Date(e.end_date)>=new Date));return s.createElement("div",{key:e.accountId,className:"team-member-row"},s.createElement("div",{className:"team-member-avatar"},(null===(t=e.displayName)||void 0===t?void 0:t.charAt(0))||"U"),s.createElement("div",{className:"team-member-details"},s.createElement("div",null,e.displayName||"Unknown"),s.createElement("div",null,e.emailAddress||"")),a.length>0&&s.createElement("div",{className:"on-pto-badge"},"On PTO"))}))),s.createElement("div",{className:"card upcoming-pto-panel"},s.createElement("h3",null,"Upcoming PTO"),0===x.length?s.createElement("div",{className:"empty-panel"},s.createElement(l.A,{size:32,className:"empty-icon"}),s.createElement("p",null,"No upcoming PTO scheduled")):x.map((e=>s.createElement("div",{key:e.id,className:"upcoming-pto-row"},s.createElement("span",{className:"upcoming-pto-emoji"},M(e.leave_type)),s.createElement("div",{className:"upcoming-pto-details"},s.createElement("div",null,e.requester_name),s.createElement("div",null,new Date(e.start_date).toLocaleDateString()," - ",new Date(e.end_date).toLocaleDateString())),s.createElement("div",{className:"upcoming-pto-days"},e.total_days,"d"))))),s.createElement("div",{className:"card quick-actions-panel"},s.createElement("h3",null,"Quick Actions"),s.createElement("button",{className:"btn quick-action-btn",onClick:async()=>{if(y)try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth()+3,0),a=await(0,d.invoke)("getPTOCalendarEvents",{startDate:e.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0]});if(a.success){const e=y.members.map((e=>e.emailAddress)),t=(a.data||[]).filter((t=>{var a;return e.includes(null===(a=t.user)||void 0===a?void 0:a.email)}));D(t),alert("Found ".concat(t.length," team PTO events. (Calendar integration coming soon)"))}}catch(e){alert("Failed to load calendar events")}}},s.createElement(l.A,{size:20}),s.createElement("span",null,"View Team Calendar")),s.createElement("button",{className:"btn quick-action-btn",onClick:()=>{if(y)try{const e=S.map((e=>({"Employee Name":e.requester_name,Email:e.requester_email,"Leave Type":e.leave_type,"Start Date":e.start_date,"End Date":e.end_date,"Total Days":e.total_days,Status:e.status,"Submitted Date":new Date(e.submitted_at).toLocaleDateString(),Reason:e.reason}))),t=Object.keys(e[0]||{}),a=[t.join(","),...e.map((e=>t.map((t=>'"'.concat((e[t]||"").toString().replace(/"/g,'""'),'"'))).join(",")))].join("\n"),s=new Blob([a],{type:"text/csv"}),r=URL.createObjectURL(s),l=document.createElement("a");l.href=r,l.download="team-pto-report-".concat(y.name,"-").concat(c,"-").concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r),alert("Report downloaded successfully!")}catch(e){alert("Failed to generate report")}}},s.createElement(z.A,{size:20}),s.createElement("span",null,"Generate Report")))),s.createElement("div",{className:"card recent-requests-panel"},s.createElement("div",{className:"recent-requests-header"},s.createElement("h3",null,"Recent Team Requests"),s.createElement("div",{className:"recent-requests-filters"},s.createElement("select",{className:"filter-select",value:u,onChange:e=>p(e.target.value)},s.createElement("option",{value:"all"},"All Members"),A.map((e=>s.createElement("option",{key:e.accountId,value:e.accountId},e.displayName)))),s.createElement("select",{className:"filter-select",value:c,onChange:e=>i(e.target.value)},s.createElement("option",{value:"current_month"},"This Month"),s.createElement("option",{value:"next_month"},"Next Month"),s.createElement("option",{value:"next_3_months"},"Next 3 Months"),s.createElement("option",{value:"all"},"All Time")))),0===S.length?s.createElement("div",{className:"empty-panel"},s.createElement(m.A,{size:32,className:"empty-icon"}),s.createElement("p",null,"No requests found for the selected criteria")):S.slice(0,10).map((e=>{var t;return s.createElement("div",{key:e.id,className:"recent-request-row"},s.createElement("div",{className:"recent-request-user"},s.createElement("div",{className:"recent-request-avatar"},(null===(t=e.requester_name)||void 0===t?void 0:t.charAt(0))||s.createElement(o.A,{size:16})),s.createElement("div",null,s.createElement("div",null,e.requester_name),s.createElement("div",null,M(e.leave_type)," ",e.leave_type," • ",e.total_days," days"))),s.createElement("div",{className:"recent-request-info"},s.createElement("div",null,s.createElement("div",null,new Date(e.start_date).toLocaleDateString()),s.createElement("div",null,new Date(e.submitted_at).toLocaleDateString())),s.createElement(L,{status:e.status})))}))))};var Y=a(5627),H=a(697);const B=e=>{let{events:t,onDateSelect:a,selectedDates:r,onSubmitPTO:n,currentUser:c,preselectedTeamId:i=null,preselectedUserId:u=null}=e;const[p,v]=(0,s.useState)(new Date),[E,y]=(0,s.useState)(!1),[N,g]=(0,s.useState)(!1),[f,h]=(0,s.useState)(i||""),[q,w]=(0,s.useState)(u||""),[T,O]=(0,s.useState)(["approved","pending"]),[k,_]=(0,s.useState)([]),[x,S]=(0,s.useState)([]),[A,P]=(0,s.useState)(!1);(0,s.useEffect)((()=>{C()}),[]),(0,s.useEffect)((()=>{i&&(h(i),g(!0)),u&&(w(u),g(!0))}),[i,u]);const C=async()=>{P(!0);try{const e=await(0,d.invoke)("getTeams");e.success&&_(e.data||[]);const t=await(0,d.invoke)("getUsers");t.success&&S(t.data||[])}catch(e){console.error("Error loading filter data:",e)}finally{P(!1)}},j=e=>e.toISOString().split("T")[0],U=e=>{const a=j(e);let s=t.filter((e=>a>=e.start_date&&a<=e.end_date));if(T.length>0&&(s=s.filter((e=>T.includes(e.status)))),f){const e=x.filter((e=>e.team_id===f)).map((e=>e.jira_account_id||e.id));s=s.filter((t=>e.includes(t.requester_id)))}return q&&(s=s.filter((e=>e.requester_id===q))),s},R=e=>{v((t=>{const a=new Date(t);return a.setMonth(t.getMonth()+e),a}))},z=()=>{h(""),w(""),O(["approved","pending"])},F=(e=>{const t=e.getFullYear(),a=e.getMonth(),s=new Date(t,a,1),r=new Date(t,a+1,0).getDate(),l=s.getDay(),n=[];for(let e=0;e<l;e++)n.push(null);for(let e=1;e<=r;e++)n.push(new Date(t,a,e));return n})(p),L=(()=>{let e=0;return f&&e++,q&&e++,T.length<3&&e++,e})();return s.createElement("div",{className:"card calendar-card"},s.createElement("div",{className:"calendar-header"},s.createElement("div",{className:"calendar-header-controls"},s.createElement("button",{onClick:()=>R(-1),className:"calendar-nav-btn"},"←"),s.createElement("h2",{className:"calendar-title"},["January","February","March","April","May","June","July","August","September","October","November","December"][p.getMonth()]," ",p.getFullYear()),s.createElement("button",{onClick:()=>R(1),className:"calendar-nav-btn"},"→")),s.createElement("div",{className:"calendar-actions"},s.createElement("button",{onClick:()=>g(!N),className:"btn ".concat(N?"btn-primary":"btn-secondary"," calendar-filter-btn")},s.createElement(Y.A,{size:16}),s.createElement("span",null,"Filters"),L>0&&s.createElement("span",{className:"filter-badge"},L)),r.length>0&&s.createElement("button",{onClick:()=>y(!0),className:"btn btn-primary calendar-submit-btn"},s.createElement(H.A,{size:16}),s.createElement("span",null,"Request PTO (",r.length," days)")))),L>0&&s.createElement("div",{className:"calendar-active-filters"},s.createElement("div",{className:"active-filters-content"},s.createElement("span",{className:"active-filters-label"},"Active filters:"),s.createElement("div",{className:"active-filters-list"},f&&s.createElement("span",{className:"filter-tag"},s.createElement(m.A,{size:12}),"Team: ",(()=>{const e=k.find((e=>e.id===f));return e?e.name:""})(),s.createElement("button",{onClick:()=>h(""),className:"filter-tag-remove"},s.createElement(b.A,{size:12}))),q&&s.createElement("span",{className:"filter-tag"},s.createElement(o.A,{size:12}),"User: ",(()=>{const e=x.find((e=>(e.jira_account_id||e.id)===q));return e?e.display_name||e.displayName||e.name:""})(),s.createElement("button",{onClick:()=>w(""),className:"filter-tag-remove"},s.createElement(b.A,{size:12}))),T.length<3&&s.createElement("span",{className:"filter-tag"},s.createElement(l.A,{size:12}),"Status: ",T.join(", "),s.createElement("button",{onClick:()=>O(["approved","pending","declined"]),className:"filter-tag-remove"},s.createElement(b.A,{size:12})))),s.createElement("button",{onClick:z,className:"clear-filters-btn"},"Clear all"))),N&&s.createElement("div",{className:"calendar-filters-panel"},s.createElement("div",{className:"filters-content"},s.createElement("h4",null,"Filter Calendar Events"),s.createElement("div",{className:"filters-grid"},s.createElement("div",{className:"filter-group"},s.createElement("label",{className:"filter-label"},s.createElement(m.A,{size:16}),"Filter by Team"),s.createElement("select",{value:f,onChange:e=>{h(e.target.value),e.target.value&&w("")},className:"filter-select",disabled:A},s.createElement("option",{value:""},"All Teams"),k.map((e=>{var t;return s.createElement("option",{key:e.id,value:e.id},e.name," (",(null===(t=e.members)||void 0===t?void 0:t.length)||0," members)")})))),s.createElement("div",{className:"filter-group"},s.createElement("label",{className:"filter-label"},s.createElement(o.A,{size:16}),"Filter by User"),s.createElement("select",{value:q,onChange:e=>{w(e.target.value),e.target.value&&h("")},className:"filter-select",disabled:A},s.createElement("option",{value:""},"All Users"),s.createElement("option",{value:null==c?void 0:c.accountId},"👤 ",null==c?void 0:c.displayName," (Me)"),s.createElement("optgroup",{label:"Team Members"},x.filter((e=>(e.jira_account_id||e.id)!==(null==c?void 0:c.accountId))).sort(((e,t)=>(e.display_name||e.displayName||e.name||"").localeCompare(t.display_name||t.displayName||t.name||""))).map((e=>{var t;return s.createElement("option",{key:e.id,value:e.jira_account_id||e.id},e.display_name||e.displayName||e.name,e.team_id&&k.find((t=>t.id===e.team_id))&&" (".concat(null===(t=k.find((t=>t.id===e.team_id)))||void 0===t?void 0:t.name,")"))}))))),s.createElement("div",{className:"filter-group"},s.createElement("label",{className:"filter-label"},s.createElement(l.A,{size:16}),"Request Status"),s.createElement("div",{className:"status-checkboxes"},["approved","pending","declined"].map((e=>s.createElement("label",{key:e,className:"status-checkbox"},s.createElement("input",{type:"checkbox",checked:T.includes(e),onChange:t=>{t.target.checked?O((t=>[...t,e])):O((t=>t.filter((t=>t!==e))))}}),s.createElement("span",{className:"status-label status-".concat(e)},e.charAt(0).toUpperCase()+e.slice(1)))))))),s.createElement("div",{className:"filters-actions"},s.createElement("button",{onClick:z,className:"btn btn-secondary"},"Clear Filters"),s.createElement("button",{onClick:()=>g(!1),className:"btn btn-primary"},"Apply Filters")))),s.createElement("div",{className:"calendar-info"},s.createElement("p",null,"💡 Click on dates to select them for your PTO request.",L>0&&s.createElement("span",null," Currently showing filtered events (",L," filter",1!==L?"s":""," active)."))),s.createElement("div",{className:"calendar-days-row"},["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>s.createElement("div",{key:e,className:"calendar-day-label"},e)))),s.createElement("div",{className:"calendar-days-row"},F.map(((e,t)=>{if(!e)return s.createElement("div",{key:t,className:"calendar-day calendar-day-empty"});const l=(n=e,r.includes(j(n)));var n;(e=>{U(e).length})(e);const c=U(e),m=e.toDateString()===(new Date).toDateString(),i=e<new Date((new Date).setHours(0,0,0,0));return s.createElement("div",{key:e.toISOString(),onClick:()=>!i&&a(e),className:"calendar-day"+(i?" calendar-day-past":" calendar-day-active")+(l?" calendar-day-selected":"")+(m?" calendar-day-today":"")},s.createElement("div",{className:"calendar-day-inner"},s.createElement("span",{className:"calendar-day-number"+(m?" calendar-day-number-today":"")+(i?" calendar-day-number-past":"")},e.getDate()),s.createElement("div",{className:"calendar-day-events"},c.slice(0,2).map(((e,t)=>s.createElement("div",{key:"".concat(e.id,"-").concat(t),className:"calendar-event"+("approved"===e.status?" calendar-event-approved":"")+("pending"===e.status?" calendar-event-pending":"")+("declined"===e.status?" calendar-event-declined":""),title:"".concat(e.requester_name,": ").concat(e.reason," (").concat(e.status,")")},s.createElement("span",null,M(e.leave_type)),s.createElement("span",{className:"calendar-event-name"},e.requester_name)))),c.length>2&&s.createElement("div",{className:"calendar-event-more"},"+",c.length-2," more"))))}))),s.createElement("div",{className:"calendar-legend"},s.createElement("div",{className:"calendar-legend-item"},s.createElement("span",{className:"calendar-legend-dot calendar-event-approved"}),s.createElement("span",null,"Approved")),s.createElement("div",{className:"calendar-legend-item"},s.createElement("span",{className:"calendar-legend-dot calendar-event-pending"}),s.createElement("span",null,"Pending")),s.createElement("div",{className:"calendar-legend-item"},s.createElement("span",{className:"calendar-legend-dot calendar-event-declined"}),s.createElement("span",null,"Declined")),s.createElement("div",{className:"calendar-legend-item"},s.createElement("span",{className:"calendar-legend-dot calendar-day-selected"}),s.createElement("span",null,"Selected"))),E&&s.createElement(D,{selectedDates:r,onClose:()=>y(!1),onSubmit:e=>{n(e),y(!1)}}))};var V=a(4945),J=a(8188),G=a(9492),Q=a(2708);const K=e=>{let{requests:t,currentUser:a,onEditRequest:r,onCancelRequest:c,onRequestChange:m}=e;const[i,o]=(0,s.useState)("this_month"),[d,u]=(0,s.useState)(""),[p,v]=(0,s.useState)(""),E=(0,s.useMemo)((()=>{const{start:e,end:a}=(()=>{const e=new Date,t=e.getFullYear(),a=e.getMonth();switch(i){case"this_month":return{start:new Date(t,a,1),end:new Date(t,a+1,0)};case"this_quarter":const e=3*Math.floor(a/3);return{start:new Date(t,e,1),end:new Date(t,e+3,0)};case"this_semester":const s=a<6?0:6;return{start:new Date(t,s,1),end:new Date(t,s+6,0)};case"this_year":return{start:new Date(t,0,1),end:new Date(t,11,31)};case"custom_range":return{start:d?new Date(d):new Date(0),end:p?new Date(p):new Date(2099,11,31)};default:return{start:new Date(0),end:new Date(2099,11,31)}}})();return t.filter((t=>{const s=new Date(t.start_date),r=new Date(t.end_date);return s>=e&&s<=a||r>=e&&r<=a||s<=e&&r>=a}))}),[t,i,d,p]),b=(0,s.useMemo)((()=>({pending:E.filter((e=>"pending"===e.status)).length,approved:E.filter((e=>"approved"===e.status)).length,total:E.length,leaveTypeStats:E.reduce(((e,t)=>{const a=t.leave_type||"unknown";return e[a]||(e[a]={count:0,days:0}),e[a].count+=1,e[a].days+=t.total_days||0,e}),{})})),[E]),N=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),g=e=>{const t=new Date(e.start_date),a=new Date;return a.setHours(0,0,0,0),t>=a};return t.length?s.createElement("div",{className:"card requests-card"},s.createElement("div",{className:"requests-header"},s.createElement("h2",{className:"card-title"},"My PTO Requests"),s.createElement("div",{className:"requests-count"},"Showing ",E.length," of ",t.length," requests")),s.createElement("div",{className:"requests-filter-section"},s.createElement("div",{className:"requests-filter-header"},s.createElement(Y.A,{size:20,className:"requests-filter-icon"}),s.createElement("h3",null,"Filter by Date Range")),s.createElement("div",{className:"requests-filter-controls"},s.createElement("select",{value:i,onChange:e=>o(e.target.value),className:"requests-filter-select"},[{value:"this_month",label:"This Month"},{value:"this_quarter",label:"This Quarter"},{value:"this_semester",label:"This Semester"},{value:"this_year",label:"This Year"},{value:"custom_range",label:"Custom Range"}].map((e=>s.createElement("option",{key:e.value,value:e.value},e.label)))),"custom_range"===i&&s.createElement("div",{className:"requests-custom-range"},s.createElement("input",{type:"date",value:d,onChange:e=>u(e.target.value),className:"requests-date-input",placeholder:"Start date"}),s.createElement("span",{className:"requests-date-separator"},"to"),s.createElement("input",{type:"date",value:p,onChange:e=>v(e.target.value),className:"requests-date-input",placeholder:"End date"})))),s.createElement("div",{className:"requests-summary-section"},s.createElement("div",{className:"requests-summary-cards"},s.createElement("div",{className:"requests-summary-card requests-card-pending"},s.createElement("div",{className:"requests-summary-content"},s.createElement("div",{className:"requests-summary-text"},s.createElement("p",{className:"requests-summary-label"},"Pending"),s.createElement("p",{className:"requests-summary-value"},b.pending)),s.createElement(n.A,{className:"requests-summary-icon",size:24}))),s.createElement("div",{className:"requests-summary-card requests-card-approved"},s.createElement("div",{className:"requests-summary-content"},s.createElement("div",{className:"requests-summary-text"},s.createElement("p",{className:"requests-summary-label"},"Approved"),s.createElement("p",{className:"requests-summary-value"},b.approved)),s.createElement(l.A,{className:"requests-summary-icon",size:24}))),s.createElement("div",{className:"requests-summary-card requests-card-total"},s.createElement("div",{className:"requests-summary-content"},s.createElement("div",{className:"requests-summary-text"},s.createElement("p",{className:"requests-summary-label"},"Total"),s.createElement("p",{className:"requests-summary-value"},b.total)),s.createElement(y.A,{className:"requests-summary-icon",size:24}))),s.createElement("div",{className:"requests-summary-card requests-card-chart"},s.createElement("div",{className:"requests-summary-content"},s.createElement("div",{className:"requests-summary-text"},s.createElement("p",{className:"requests-summary-label"},"PTO by Type"),s.createElement(V.A,{className:"requests-summary-icon",size:24}))))),s.createElement("div",{className:"requests-chart-section"},s.createElement("h4",{className:"requests-chart-title"},"PTO Breakdown by Leave Type"),s.createElement("div",{className:"requests-chart-container"},Object.keys(b.leaveTypeStats).length>0?s.createElement("div",{className:"requests-chart-bars"},Object.entries(b.leaveTypeStats).map((e=>{let[t,a]=e;const r=Math.max(...Object.values(b.leaveTypeStats).map((e=>e.count))),l=r>0?a.count/r*100:0;return s.createElement("div",{key:t,className:"requests-chart-bar-item"},s.createElement("div",{className:"requests-chart-bar-header"},s.createElement("span",{className:"requests-chart-bar-emoji"},M(t)),s.createElement("span",{className:"requests-chart-bar-label"},t.charAt(0).toUpperCase()+t.slice(1)),s.createElement("span",{className:"requests-chart-bar-count"},a.count)),s.createElement("div",{className:"requests-chart-bar-container"},s.createElement("div",{className:"requests-chart-bar",style:{width:"".concat(l,"%")}})),s.createElement("div",{className:"requests-chart-bar-details"},a.days," days total"))}))):s.createElement("div",{className:"requests-chart-empty"},s.createElement(V.A,{size:32,className:"requests-chart-empty-icon"}),s.createElement("p",null,"No data available for the selected period"))))),s.createElement("div",{className:"requests-table-section"},s.createElement("h3",{className:"requests-table-title"},"PTO Requests"),0===E.length?s.createElement("div",{className:"requests-table-empty"},s.createElement(l.A,{size:32,className:"requests-table-empty-icon"}),s.createElement("p",null,"No requests found for the selected date range")):s.createElement("div",{className:"requests-table-container"},s.createElement("table",{className:"requests-table"},s.createElement("thead",{className:"requests-table-head"},s.createElement("tr",null,s.createElement("th",{className:"requests-table-header"},"Type"),s.createElement("th",{className:"requests-table-header"},"Date Range"),s.createElement("th",{className:"requests-table-header"},"Duration"),s.createElement("th",{className:"requests-table-header"},"Reason"),s.createElement("th",{className:"requests-table-header"},"Status"),s.createElement("th",{className:"requests-table-header"},"Submitted"),s.createElement("th",{className:"requests-table-header"},"Actions"))),s.createElement("tbody",{className:"requests-table-body"},E.map((e=>{return s.createElement("tr",{key:e.id,className:"requests-table-row"},s.createElement("td",{className:"requests-table-cell"},s.createElement("div",{className:"requests-table-type"},s.createElement("span",{className:"requests-table-emoji"},M(e.leave_type)),s.createElement("span",{className:"requests-table-type-text"},e.leave_type.charAt(0).toUpperCase()+e.leave_type.slice(1)))),s.createElement("td",{className:"requests-table-cell"},s.createElement("div",{className:"requests-table-dates"},s.createElement("div",{className:"requests-table-date-range"},N(e.start_date)," - ",N(e.end_date)))),s.createElement("td",{className:"requests-table-cell"},s.createElement("div",{className:"requests-table-duration"},s.createElement("span",{className:"requests-table-days"},e.total_days," days"),s.createElement("span",{className:"requests-table-hours"},"(",e.total_hours,"h)"))),s.createElement("td",{className:"requests-table-cell"},s.createElement("div",{className:"requests-table-reason",title:e.reason},e.reason)),s.createElement("td",{className:"requests-table-cell"},s.createElement(L,{status:e.status}),"pending"!==e.status&&e.reviewed_at&&s.createElement("div",{className:"requests-table-review-date"},N(e.reviewed_at))),s.createElement("td",{className:"requests-table-cell"},s.createElement("div",{className:"requests-table-submitted"},(t=e.submitted_at,new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})))),s.createElement("td",{className:"requests-table-cell"},s.createElement("div",{className:"requests-table-actions"},g(e)&&(e=>"pending"===e.status&&e.requester_id===a.accountId)(e)&&s.createElement("button",{onClick:()=>r&&r(e),className:"requests-action-btn requests-action-edit",title:"Edit Request"},s.createElement(J.A,{size:14})),g(e)&&(e=>{const t=new Date(e.start_date),s=new Date;return s.setHours(0,0,0,0),"approved"===e.status&&e.requester_id===a.accountId&&t>=s})(e)&&s.createElement("button",{onClick:()=>m&&m(e),className:"requests-action-btn requests-action-change",title:"Request Change"},s.createElement(G.A,{size:14})),g(e)&&(e=>"pending"===e.status&&e.requester_id===a.accountId)(e)&&s.createElement("button",{onClick:()=>c&&c(e),className:"requests-action-btn requests-action-delete",title:"Delete Request"},s.createElement(Q.A,{size:14})))));var t})))))),E.some((e=>e.reviewer_comments&&"pending"!==e.status))&&s.createElement("div",{className:"requests-comments-section"},s.createElement("h4",{className:"requests-comments-title"},"Manager Comments"),s.createElement("div",{className:"requests-comments-list"},E.filter((e=>e.reviewer_comments&&"pending"!==e.status)).map((e=>s.createElement("div",{key:e.id,className:"requests-comment-item"},s.createElement("div",{className:"requests-comment-header"},s.createElement("span",{className:"requests-comment-emoji"},M(e.leave_type)),s.createElement("span",{className:"requests-comment-type"},e.leave_type.charAt(0).toUpperCase()+e.leave_type.slice(1)," Leave"),s.createElement("span",{className:"requests-comment-date"},N(e.start_date)," - ",N(e.end_date)),s.createElement(L,{status:e.status})),s.createElement("div",{className:"requests-comment-text"},e.reviewer_comments))))))):s.createElement("div",{className:"card requests-card"},s.createElement("h2",{className:"card-title"},"My PTO Requests"),s.createElement("div",{className:"requests-empty"},s.createElement(l.A,{size:48,className:"requests-empty-icon"}),s.createElement("h3",{className:"requests-empty-title"},"No PTO requests found"),s.createElement("p",null,"You haven't submitted any PTO requests yet."),s.createElement("p",{className:"requests-empty-desc"},"Go to the Calendar tab to submit your first request!")))};var X=a(7504);function Z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(a),!0).forEach((function(t){ee(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ee(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const te=e=>{let{pendingRequests:t,onApproval:a}=e;const[r,m]=(0,s.useState)({}),[i,d]=(0,s.useState)({}),u=async(e,t)=>{const s=r[e]||"";d((t=>$($({},t),{},{[e]:!0})));try{await a(e,t,s),m((t=>$($({},t),{},{[e]:""})))}finally{d((t=>$($({},t),{},{[e]:!1})))}},p=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return 0===t.length?s.createElement("div",{className:"card approval-card"},s.createElement("h2",{className:"card-title"},"Pending Approvals"),s.createElement("div",{className:"approval-empty"},s.createElement(c.A,{size:48,className:"approval-empty-icon"}),s.createElement("h3",{className:"approval-empty-title"},"All caught up!"),s.createElement("p",{className:"approval-empty-desc"},"There are no pending PTO requests to approve at this time."))):s.createElement("div",{className:"card approval-card"},s.createElement("div",{className:"approval-header"},s.createElement("h2",{className:"card-title"},"Pending Approvals"),s.createElement("div",{className:"approval-pending-count"},t.length," pending")),s.createElement("div",{className:"approval-info"},s.createElement("div",{className:"approval-info-content"},s.createElement(c.A,{className:"approval-info-icon",size:20}),s.createElement("div",{className:"approval-info-text"},s.createElement("p",{className:"approval-info-title"},"Review Team PTO Requests"),s.createElement("p",null,"Review each request carefully and add comments if needed. Your decision will be sent to the employee immediately.")))),s.createElement("div",{className:"approval-list"},t.map((e=>{var t,a;return s.createElement("div",{key:e.id,className:"approval-request"},s.createElement("div",{className:"approval-request-content"},s.createElement("div",{className:"approval-avatar"},(null===(t=e.requester_name)||void 0===t?void 0:t.charAt(0))||s.createElement(o.A,{size:20})),s.createElement("div",{className:"approval-request-main"},s.createElement("div",{className:"approval-request-header"},s.createElement("div",null,s.createElement("h3",{className:"approval-request-name"},e.requester_name),s.createElement("p",{className:"approval-request-email"},e.requester_email)),s.createElement("div",{className:"approval-request-submitted"},s.createElement("div",{className:"approval-request-submitted-label"},"Submitted"),s.createElement("div",{className:"approval-request-submitted-date"},(a=e.submitted_at,new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))))),s.createElement("div",{className:"approval-request-details"},s.createElement("div",{className:"approval-request-detail"},s.createElement("span",{className:"approval-request-emoji"},M(e.leave_type)),s.createElement("div",null,s.createElement("div",{className:"approval-request-type"},e.leave_type," Leave"),s.createElement("div",{className:"approval-request-type-label"},"Type"))),s.createElement("div",{className:"approval-request-detail"},s.createElement(l.A,{className:"approval-request-detail-icon",size:20}),s.createElement("div",null,s.createElement("div",{className:"approval-request-dates"},p(e.start_date)," - ",p(e.end_date)),s.createElement("div",{className:"approval-request-dates-label"},"Date Range"))),s.createElement("div",{className:"approval-request-detail"},s.createElement(n.A,{className:"approval-request-detail-icon",size:20}),s.createElement("div",null,s.createElement("div",{className:"approval-request-duration"},e.total_days," days (",e.total_hours,"h)"),s.createElement("div",{className:"approval-request-duration-label"},"Duration")))),s.createElement("div",{className:"approval-request-reason"},s.createElement("div",{className:"approval-request-reason-content"},s.createElement(X.A,{className:"approval-request-reason-icon",size:16}),s.createElement("div",null,s.createElement("span",{className:"approval-request-reason-label"},"Reason:"),s.createElement("p",{className:"approval-request-reason-text"},e.reason)))),s.createElement("div",{className:"approval-request-comments"},s.createElement("label",{className:"approval-request-comments-label"},"Manager Comments (Optional)"),s.createElement("textarea",{value:r[e.id]||"",onChange:t=>{return a=e.id,s=t.target.value,void m((e=>$($({},e),{},{[a]:s})));var a,s},placeholder:"Add any comments about this request...",className:"approval-request-comments-input",rows:"3"})),s.createElement("div",{className:"approval-request-actions"},s.createElement("button",{onClick:()=>u(e.id,"approved"),disabled:i[e.id],className:"btn btn-primary"},i[e.id]?s.createElement("div",{className:"approval-processing"},s.createElement("div",{className:"approval-processing-spinner"}),s.createElement("span",null,"Processing...")):s.createElement("div",{className:"approval-btn-content"},s.createElement(c.A,{size:16}),s.createElement("span",null,"Approve"))),s.createElement("button",{onClick:()=>u(e.id,"declined"),disabled:i[e.id],className:"btn btn-danger"},i[e.id]?s.createElement("div",{className:"approval-processing"},s.createElement("div",{className:"approval-processing-spinner"}),s.createElement("span",null,"Processing...")):s.createElement("div",{className:"approval-btn-content"},s.createElement("span",null,"✕"),s.createElement("span",null,"Decline")))))))}))),t.length>3&&s.createElement("div",{className:"approval-bulk-message"},s.createElement("div",null,s.createElement("p",null,"Need to approve multiple requests? Bulk actions coming soon!"))))};function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(a),!0).forEach((function(t){re(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function re(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const le=()=>{const[e,t]=(0,s.useState)(null),[a,r]=(0,s.useState)(!0),[l,n]=(0,s.useState)(null),[c,m]=(0,s.useState)(0);(0,s.useEffect)((()=>{i()}),[]);const i=async function(){r(!0),n(null);try{var e;console.log("🔍 Fetching current user...");let a=await(0,d.invoke)("getCurrentUser");if(a.success||"NETWORK_ERROR"!==(null===(e=a.error)||void 0===e?void 0:e.type)||(console.log("🔄 Main method failed, trying fallback..."),a=await(0,d.invoke)("getCurrentUserFallback")),!a.success)throw new Error(a.message||"Failed to fetch current user");{console.log("👤 User data received:",a.data);let e=!1;try{const t=await(0,d.invoke)("checkUserAdminStatus",{accountId:a.data.accountId});e=!!t.success&&t.data.isAdmin}catch(e){console.warn("⚠️ Could not check admin status:",e)}const s=se(se({},a.data),{},{isAdmin:e});console.log("✅ Current user loaded:",s.displayName,"isAdmin:",s.isAdmin),t(s),m(0)}}catch(e){if(console.error("❌ Error fetching current user:",e),n(e.message),e.message.includes("timeout")||e.message.includes("fetch failed")){if(c<3)return console.log("🔄 Auto-retrying in 5 seconds... (attempt ".concat(c+1,"/3)")),void setTimeout((()=>{m((e=>e+1)),i(!0)}),5e3);n("Network connection failed after multiple attempts. Please check your internet connection and refresh the page.")}}finally{r(!1)}};return{currentUser:e,loading:a,error:l,refreshUser:async()=>{m(0),await i()},testConnectivity:async()=>{try{return await(0,d.invoke)("testConnectivity")}catch(e){return{success:!1,message:"Connectivity test failed: "+e.message}}},isAdmin:(null==e?void 0:e.isAdmin)||!1,retryCount:c}};function ne(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function ce(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(a),!0).forEach((function(t){me(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ne(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function me(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const ie=e=>{const[t,a]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),[n,c]=(0,s.useState)(null),m=(0,s.useCallback)((async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e){l(!0),c(null);try{console.log("📋 Fetching PTO requests with filters:",t);const e=await(0,d.invoke)("getPTORequests",t);if(!e.success)throw new Error(e.message||"Failed to fetch PTO requests");var s;a(e.data||[]),console.log("✅ Loaded ".concat((null===(s=e.data)||void 0===s?void 0:s.length)||0," PTO requests"))}catch(e){c(e.message),console.error("❌ Error fetching PTO requests:",e)}finally{l(!1)}}}),[e]),i=(0,s.useCallback)((async e=>{l(!0),c(null);try{console.log("📝 Submitting PTO request:",e);const t=await(0,d.invoke)("storePTORequest",e);if(t.success)return await m(),{success:!0,data:t.data};throw new Error(t.message||"Failed to submit PTO request")}catch(e){return c(e.message),console.error("❌ Error submitting PTO request:",e),{success:!1,message:e.message}}finally{l(!1)}}),[m]),o=(0,s.useCallback)((async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";l(!0),c(null);try{console.log("✅ Updating PTO request ".concat(e," to ").concat(t));const r=await(0,d.invoke)("updatePTORequest",{requestId:e,status:t,comment:s});if(r.success)return a((a=>a.map((a=>a.id===e?ce(ce({},a),{},{status:t,reviewer_comments:s,reviewed_at:(new Date).toISOString()}):a)))),{success:!0};throw new Error(r.message||"Failed to update PTO request")}catch(e){return c(e.message),console.error("❌ Error updating PTO request:",e),{success:!1,message:e.message}}finally{l(!1)}}),[]),u=(0,s.useCallback)((async e=>{l(!0),c(null);try{console.log("🗑️ Cancelling PTO request ".concat(e));const t=await(0,d.invoke)("updatePTORequest",{requestId:e,status:"cancelled",comment:"Cancelled by user"});if(t.success)return a((t=>t.filter((t=>t.id!==e)))),{success:!0};throw new Error(t.message||"Failed to cancel PTO request")}catch(e){return c(e.message),console.error("❌ Error cancelling PTO request:",e),{success:!1,message:e.message}}finally{l(!1)}}),[]),p=(0,s.useCallback)((e=>t.filter((t=>t.requester_id===e))),[t]),v=(0,s.useCallback)((()=>t.filter((e=>"pending"===e.status))),[t]),E=(0,s.useCallback)((e=>t.filter((t=>t.status===e))),[t]),y=(0,s.useCallback)(((e,a)=>t.filter((t=>{const s=new Date(t.start_date),r=new Date(t.end_date),l=new Date(e),n=new Date(a);return s>=l&&s<=n||r>=l&&r<=n||s<=l&&r>=n}))),[t]),b=(0,s.useCallback)((async()=>{if(null==e||!e.emailAddress)return[];try{console.log("📋 Fetching pending requests for manager:",e.emailAddress);const t=await(0,d.invoke)("getPendingRequests",{managerEmail:e.emailAddress});return t.success?t.data||[]:(console.error("Failed to fetch pending requests:",t.message),[])}catch(e){return console.error("❌ Error fetching pending requests for manager:",e),[]}}),[e]);return(0,s.useEffect)((()=>{e&&m()}),[e,m]),{requests:t,loading:r,error:n,fetchRequests:m,submitRequest:i,updateRequestStatus:o,cancelRequest:u,getUserRequests:p,getPendingRequests:v,getRequestsByStatus:E,getRequestsByDateRange:y,getPendingRequestsForManager:b}},oe=()=>{var e;const[t,a]=(0,s.useState)("calendar"),[r,p]=(0,s.useState)([]),[v,E]=(0,s.useState)(null),[y,b]=(0,s.useState)(!0),[N,g]=(0,s.useState)([]),[f,h]=(0,s.useState)(null),{currentUser:q,loading:w,error:T,isAdmin:D}=le(),{requests:O,loading:k,error:_,submitRequest:x,updateRequestStatus:S,cancelRequest:A,fetchRequests:P,getUserRequests:C,getPendingRequests:j}=ie(q);(0,s.useEffect)((()=>{(async()=>{if(q)try{const e=await(0,d.invoke)("getUserTeams",{userId:q.accountId});e.success&&g(e.data||[])}catch(e){console.error("Error loading user teams:",e)}})()}),[q]),(0,s.useEffect)((()=>{y&&(async()=>{b(!0),h(null);try{console.log("🔧 Initializing PTO App...");const e=await(0,d.invoke)("initializePTODatabase");if(!e.success)throw new Error(e.message||"Failed to initialize database");console.log("✅ Basic PTO database initialized");try{const e=await(0,d.invoke)("initializeTeamUserService");e.success?console.log("✅ Team user service initialized"):console.warn("⚠️ Team service initialization failed:",e.message)}catch(e){console.warn("⚠️ Team service not available:",e.message)}if(null!=q&&q.accountId)try{const e=await(0,d.invoke)("setupDefaultAdmin");e.success?console.log("✅ Admin setup completed"):console.warn("⚠️ Admin setup failed:",e.message)}catch(e){console.warn("⚠️ Admin setup not available:",e.message)}console.log("✅ PTO App initialization complete")}catch(e){console.error("❌ App initialization failed:",e),h(e.message),R("Failed to initialize app: "+e.message,"error")}finally{b(!1)}})()}),[]);const R=function(e){E({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout((()=>E(null)),5e3)},z=[{id:"calendar",label:"Calendar",icon:l.A,description:"View and create PTO requests"},{id:"requests",label:"My Requests",icon:n.A,description:"View your PTO request history"},{id:"approvals",label:"Approvals",icon:c.A,description:"Approve team PTO requests"},{id:"team",label:"Team",icon:m.A,description:"Team dashboard and analytics"},...D?[{id:"admin",label:"Admin",icon:i.A,description:"Administrative functions"}]:[]],F=C(null==q?void 0:q.accountId),L=j().filter((e=>e.requester_id!==(null==q?void 0:q.accountId)));return y||w?s.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},s.createElement("div",{className:"text-center"},s.createElement("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),s.createElement("h2",{className:"text-xl font-semibold text-gray-900 mb-2"},"Initializing PTO Management"),s.createElement("p",{className:"text-gray-600"},"Setting up database and user services..."),f&&s.createElement("div",{className:"mt-4 p-3 bg-red-100 border border-red-300 rounded-md"},s.createElement("p",{className:"text-red-700 text-sm"},"Error: ",f),s.createElement("button",{onClick:()=>window.location.reload(),className:"mt-2 px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600"},"Retry")))):T?s.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},s.createElement("div",{className:"text-center p-8 bg-white rounded-lg shadow-md"},s.createElement("div",{className:"text-red-500 mb-4"},s.createElement("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"}))),s.createElement("h2",{className:"text-xl font-semibold text-gray-900 mb-2"},"Authentication Error"),s.createElement("p",{className:"text-gray-600 mb-4"},"Failed to load user information: ",T),s.createElement("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600"},"Retry"))):q?s.createElement("div",{className:"min-h-screen bg-gray-50"},s.createElement("header",{className:"bg-white shadow-sm border-b"},s.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},s.createElement("div",{className:"flex justify-between items-center h-16"},s.createElement("div",{className:"flex items-center space-x-3"},s.createElement("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center"},s.createElement(l.A,{size:20,className:"text-white"})),s.createElement("div",null,s.createElement("h1",{className:"text-xl font-semibold text-gray-900"},"PTO Management"))),s.createElement("div",{className:"flex items-center space-x-4"},s.createElement("div",{className:"hidden md:flex items-center space-x-4 text-sm text-gray-600"},s.createElement("div",{className:"flex items-center space-x-1"},s.createElement("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),s.createElement("span",null,L.length," pending")),s.createElement("div",{className:"flex items-center space-x-1"},s.createElement("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),s.createElement("span",null,F.filter((e=>"approved"===e.status)).length," approved")),N.length>0&&s.createElement("div",{className:"flex items-center space-x-1"},s.createElement("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),s.createElement("span",null,N.length," teams"))),s.createElement("div",{className:"flex items-center space-x-2"},s.createElement("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-semibold relative"},(null===(e=q.displayName)||void 0===e?void 0:e.charAt(0))||s.createElement(o.A,{size:16}),D&&s.createElement("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-purple-500 rounded-full flex items-center justify-center"},s.createElement(i.A,{size:8,className:"text-white"}))),s.createElement("div",{className:"hidden sm:block"},s.createElement("div",{className:"text-sm font-medium text-gray-700 flex items-center space-x-1"},s.createElement("span",null,q.displayName),D&&s.createElement(i.A,{size:12,className:"text-purple-600"})),s.createElement("div",{className:"text-xs text-gray-500"},q.emailAddress))))))),s.createElement("nav",{className:"bg-white border-b"},s.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},s.createElement("div",{className:"flex space-x-8"},z.map((e=>{const r=e.icon,l=t===e.id;return s.createElement("button",{key:e.id,onClick:()=>a(e.id),className:"flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(l?"admin"===e.id?"border-purple-500 text-purple-600":"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),title:e.description},s.createElement(r,{size:16}),s.createElement("span",null,e.label),"approvals"===e.id&&L.length>0&&s.createElement("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 min-w-[20px] text-center"},L.length),"admin"===e.id&&s.createElement("span",{className:"bg-purple-100 text-purple-600 text-xs rounded-full px-2 py-0.5"},"Admin"))}))))),s.createElement("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},"calendar"===t&&s.createElement(B,{events:O,onDateSelect:e=>{const t=e.toISOString().split("T")[0];p((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t].sort()))},selectedDates:r,onSubmitPTO:async e=>{try{const t={reporter:q,manager:e.manager||{accountId:"manager-default",displayName:"Manager",emailAddress:"manager@company.com"},startDate:r[0],endDate:r[r.length-1],leaveType:e.leaveType,reason:e.reason,dailySchedules:e.dailySchedules},a=await x(t);a.success?(p([]),R("PTO request submitted successfully!")):R(a.message||"Failed to submit PTO request","error")}catch(e){console.error("Error submitting PTO request:",e),R("Failed to submit PTO request","error")}}}),"requests"===t&&s.createElement(K,{requests:F,currentUser:q,onEditRequest:e=>{R("Edit functionality will be implemented soon!")},onCancelRequest:async e=>{if(window.confirm("Are you sure you want to cancel this PTO request?"))try{const t=await A(e.id);t.success?R("PTO request cancelled successfully!"):R(t.message||"Failed to cancel PTO request","error")}catch(e){console.error("Error cancelling PTO request:",e),R("Failed to cancel PTO request","error")}}}),"approvals"===t&&s.createElement(te,{pendingRequests:L,onApproval:async(e,t,a)=>{try{const s=await S(e,t,a);s.success?R("Request ".concat(t," successfully!")):R(s.message||"Failed to ".concat(t," request"),"error")}catch(e){console.error("Error updating PTO request:",e),R("Failed to ".concat(t," request"),"error")}}}),"team"===t&&s.createElement(W,{teamData:{teams:N},requests:O,currentUser:q}),"admin"===t&&D&&s.createElement(U,{currentUser:q,showNotification:R})),k&&s.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-25 flex items-center justify-center z-50"},s.createElement("div",{className:"bg-white rounded-lg p-6 flex items-center space-x-3"},s.createElement("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),s.createElement("span",{className:"text-gray-700"},"Processing..."))),v&&s.createElement(u,{message:v.message,type:v.type,onClose:()=>E(null)})):s.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},s.createElement("div",{className:"text-center"},s.createElement("div",{className:"w-16 h-16 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),s.createElement("p",{className:"text-gray-600"},"Loading user information...")))};console.log("PTO app initializing...");const de=async()=>{const e=document.getElementById("root");if(!e)return void console.error('Root element not found! Make sure there is a div with id="root" in your HTML.');(0,r.H)(e).render(s.createElement(s.StrictMode,null,s.createElement(oe,null))),console.log("App rendered successfully");try{await d.view.resize(),console.log("Forge iframe resized")}catch(e){console.warn("Unable to resize Forge iframe:",e)}};"complete"===document.readyState||"interactive"===document.readyState?de():document.addEventListener("DOMContentLoaded",de)}},a={};function s(e){var r=a[e];if(void 0!==r)return r.exports;var l=a[e]={exports:{}};return t[e](l,l.exports,s),l.exports}s.m=t,e=[],s.O=(t,a,r,l)=>{if(!a){var n=1/0;for(o=0;o<e.length;o++){a=e[o][0],r=e[o][1],l=e[o][2];for(var c=!0,m=0;m<a.length;m++)(!1&l||n>=l)&&Object.keys(s.O).every((e=>s.O[e](a[m])))?a.splice(m--,1):(c=!1,l<n&&(n=l));if(c){e.splice(o--,1);var i=r();void 0!==i&&(t=i)}}return t}l=l||0;for(var o=e.length;o>0&&e[o-1][2]>l;o--)e[o]=e[o-1];e[o]=[a,r,l]},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var r,l,n=a[0],c=a[1],m=a[2],i=0;if(n.some((t=>0!==e[t]))){for(r in c)s.o(c,r)&&(s.m[r]=c[r]);if(m)var o=m(s)}for(t&&t(a);i<n.length;i++)l=n[i],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(o)},a=self.webpackChunkpto_request_app=self.webpackChunkpto_request_app||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var r=s.O(void 0,[96],(()=>s(6564)));r=s.O(r)})();