(()=>{"use strict";var e,t={6564:(e,t,a)=>{var r=a(6540),l=a(5338),n=a(2307),s=a(7235),c=a(4471),m=a(3893),i=a(2492),o=a(8686),d=a(2321);const u=e=>{let{message:t,type:a,onClose:l}=e;return r.createElement("div",{className:"fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ".concat("success"===a?"bg-green-500 text-white":"bg-red-500 text-white")},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("span",null,t),r.createElement("button",{onClick:l,className:"ml-4 text-white hover:text-gray-200"},"×")))};var p=a(7623),v=a(2762),y=a(8697),E=a(8445);const g=e=>{var t;let{selectedUser:a,onSelect:l,placeholder:n="Search for a user",disabled:s=!1,required:c=!1,error:m=null}=e;const[i,u]=(0,r.useState)(!1),[p,v]=(0,r.useState)(""),[g,b]=(0,r.useState)([]),[f,N]=(0,r.useState)(!1),[h,w]=(0,r.useState)(null),q=(0,r.useRef)(null),D=(0,r.useRef)(null),O=(0,r.useCallback)(function(e,t){let a;return function(){for(var r=arguments.length,l=new Array(r),n=0;n<r;n++)l[n]=arguments[n];const s=()=>{clearTimeout(a),e(...l)};clearTimeout(a),a=setTimeout(s,t)}}((async e=>{if(e.length<2)b([]);else{N(!0),w(null);try{console.log("🔍 Searching users:",e);const t=await(0,d.invoke)("getJiraUsers",{query:e});if(!t.success)throw new Error(t.message||"Failed to search users");b(t.data||[])}catch(e){console.error("❌ Error searching users:",e),w(e.message),b([])}finally{N(!1)}}}),300),[]);return(0,r.useEffect)((()=>{const e=e=>{q.current&&!q.current.contains(e.target)&&(u(!1),v(""),b([]))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,r.useEffect)((()=>{const e=e=>{"Escape"===e.key&&i&&(u(!1),v(""),b([]))};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[i]),r.createElement("div",{className:"relative",ref:q},r.createElement("div",{onClick:()=>{s||(u(!0),setTimeout((()=>{var e;null===(e=D.current)||void 0===e||e.focus()}),100))},className:"flex items-center justify-between p-3 border rounded-md cursor-pointer transition-colors ".concat(s?"bg-gray-100 cursor-not-allowed border-gray-200":i?"border-blue-500 ring-2 ring-blue-200":m?"border-red-300 hover:border-red-400":"border-gray-300 hover:border-gray-400")},a?r.createElement("div",{className:"flex items-center space-x-3 flex-1"},r.createElement("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-semibold"},a.avatarUrl?r.createElement("img",{src:a.avatarUrl,alt:a.displayName,className:"w-8 h-8 rounded-full"}):(null===(t=a.displayName)||void 0===t?void 0:t.charAt(0))||r.createElement(o.A,{size:16})),r.createElement("div",{className:"flex-1"},r.createElement("div",{className:"font-medium text-gray-900"},a.displayName),r.createElement("div",{className:"text-sm text-gray-600"},a.emailAddress)),!s&&r.createElement("button",{onClick:e=>{e.stopPropagation(),l(null)},className:"p-1 hover:bg-gray-100 rounded transition-colors"},r.createElement(y.A,{size:16,className:"text-gray-400"}))):r.createElement("div",{className:"flex items-center space-x-3 text-gray-500"},r.createElement(E.A,{size:16}),r.createElement("span",null,n),c&&r.createElement("span",{className:"text-red-500"},"*"))),m&&r.createElement("div",{className:"mt-1 text-sm text-red-600"},m),i&&r.createElement("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 max-h-80 overflow-hidden"},r.createElement("div",{className:"p-3 border-b border-gray-200"},r.createElement("div",{className:"relative"},r.createElement(E.A,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),r.createElement("input",{ref:D,type:"text",value:p,onChange:e=>{const t=e.target.value;v(t),O(t)},placeholder:"Type to search users...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),r.createElement("div",{className:"max-h-60 overflow-y-auto"},f?r.createElement("div",{className:"p-4 text-center text-gray-500"},r.createElement("div",{className:"flex items-center justify-center space-x-2"},r.createElement("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin"}),r.createElement("span",null,"Searching..."))):h?r.createElement("div",{className:"p-4 text-center text-red-600"},r.createElement("div",{className:"text-sm"},"Error: ",h)):p.length<2?r.createElement("div",{className:"p-4 text-center text-gray-500"},r.createElement("div",{className:"text-sm"},"Type at least 2 characters to search")):0===g.length?r.createElement("div",{className:"p-4 text-center text-gray-500"},r.createElement("div",{className:"text-sm"},"No users found")):r.createElement("div",{className:"divide-y divide-gray-100"},g.map((e=>{var t;return r.createElement("div",{key:e.accountId,onClick:()=>(e=>{l(e),u(!1),v(""),b([])})(e),className:"p-3 hover:bg-gray-50 cursor-pointer transition-colors"},r.createElement("div",{className:"flex items-center space-x-3"},r.createElement("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-semibold"},e.avatarUrl?r.createElement("img",{src:e.avatarUrl,alt:e.displayName,className:"w-8 h-8 rounded-full"}):(null===(t=e.displayName)||void 0===t?void 0:t.charAt(0))||r.createElement(o.A,{size:16})),r.createElement("div",{className:"flex-1"},r.createElement("div",{className:"font-medium text-gray-900"},e.displayName),r.createElement("div",{className:"text-sm text-gray-600"},e.emailAddress))))}))))))};function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){N(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function N(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const h=e=>{var t;let{selectedDates:a=[],onClose:l,onSubmit:s,isAdminMode:c=!1,targetUser:m=null,allUsers:i=[],allTeams:o=[],allRequests:d=[]}=e;const[u,p]=(0,r.useState)({leaveType:"",reason:"",manager:null,startDate:"",endDate:"",dailySchedules:[]}),[v,E]=(0,r.useState)({}),[b,N]=(0,r.useState)([]),[h,w]=(0,r.useState)(m||null);(0,r.useEffect)((()=>{if(c&&h){const e=function(e,t,a){if(!e||null==a||!a.length||null==t||!t.length)return null;const r=a.find((t=>t.id===e.team_id||t.id===e.teamId));return r?r.manager?"object"==typeof r.manager?r.manager:t.find((e=>e.accountId===r.manager||e.id===r.manager)):r.team_lead?t.find((e=>e.accountId===r.team_lead||e.displayName===r.team_lead)):null:null}(h,i,o);p((t=>f(f({},t),{},{manager:e})))}}),[c,h,i,o]),(0,r.useEffect)((()=>{p(c?e=>f(f({},e),{},{dailySchedules:b.map((e=>({date:e,type:"FULL_DAY"})))}):e=>f(f({},e),{},{dailySchedules:a.map((e=>({date:e,type:"FULL_DAY"})))}))}),[c,b,a]),(0,r.useEffect)((()=>{if(c&&u.startDate&&u.endDate){const e=new Date(u.startDate),t=new Date(u.endDate),a=[];for(let r=new Date(e);r<=t;r.setDate(r.getDate()+1))a.push(r.toISOString().split("T")[0]);N(a)}}),[u.startDate,u.endDate,c]);const q=c?b:a;return r.createElement("div",{className:"modal-overlay"},r.createElement("div",{className:"modal-content",style:{maxWidth:"600px",width:"100%"}},r.createElement("div",{className:"modal-header"},r.createElement("h3",{className:"modal-title"},r.createElement(n.A,{size:22,style:{marginRight:8,marginBottom:-3}}),c?h?"Create PTO for ".concat(h.displayName):"Create PTO Request (Select User)":"Submit PTO Request"),r.createElement("button",{onClick:l,className:"modal-close"},r.createElement(y.A,{size:24}))),r.createElement("div",{className:"modal-body"},c&&r.createElement("div",{className:"mb-4"},r.createElement("label",{className:"form-label"},"User *"),r.createElement(g,{selectedUser:h,onSelect:w,placeholder:"Search and select user",required:!0,disabled:!!m}),v.adminUser&&r.createElement("div",{className:"error-text"},v.adminUser)),c&&h&&r.createElement("div",{className:"bg-purple-50 mb-4"},r.createElement("div",{style:{display:"flex",alignItems:"center",gap:14}},r.createElement("div",{style:{width:40,height:40,borderRadius:12,background:"linear-gradient(120deg,#e9d5ff 60%,#ede9fe 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#fff"}},(null===(t=h.displayName)||void 0===t?void 0:t.charAt(0))||"?"),r.createElement("div",null,r.createElement("div",{style:{fontWeight:600,color:"#6d28d9"}},"PTO for:"),r.createElement("div",{style:{fontSize:14,color:"#6d28d9"}},h.displayName," (",h.emailAddress,")")))),c&&r.createElement("div",{className:"mb-4",style:{display:"flex",gap:18}},r.createElement("div",{style:{flex:1}},r.createElement("label",{className:"form-label"},"Start Date *"),r.createElement("input",{type:"date",value:u.startDate,onChange:e=>p((t=>f(f({},t),{},{startDate:e.target.value}))),className:"form-control".concat(v.startDate?" error":""),min:(new Date).toISOString().split("T")[0],disabled:!h}),v.startDate&&r.createElement("div",{className:"error-text"},v.startDate)),r.createElement("div",{style:{flex:1}},r.createElement("label",{className:"form-label"},"End Date *"),r.createElement("input",{type:"date",value:u.endDate,onChange:e=>p((t=>f(f({},t),{},{endDate:e.target.value}))),className:"form-control".concat(v.endDate?" error":""),min:u.startDate||(new Date).toISOString().split("T")[0],disabled:!h}),v.endDate&&r.createElement("div",{className:"error-text"},v.endDate))),!c&&r.createElement("div",{className:"mb-4"},r.createElement("label",{className:"form-label"},"Manager *",r.createElement("span",{style:{color:"#6b7280",fontSize:13,marginLeft:6}},"(Required for approval)")),r.createElement(g,{selectedUser:u.manager,onSelect:e=>p((t=>f(f({},t),{},{manager:e}))),placeholder:"Search and select your manager",required:!0,error:v.manager}),v.manager&&r.createElement("div",{className:"error-text"},v.manager)),r.createElement("div",{className:"mb-4"},r.createElement("label",{className:"form-label"},"Leave Type *"),r.createElement("select",{value:u.leaveType,onChange:e=>p((t=>f(f({},t),{},{leaveType:e.target.value}))),className:"form-control".concat(v.leaveType?" error":""),required:!0,disabled:c&&!h},r.createElement("option",{value:""},"Select leave type"),[{value:"vacation",label:"🏖️ Vacation"},{value:"sick",label:"🤒 Sick Leave"},{value:"personal",label:"👤 Personal Day"},{value:"holiday",label:"🎉 Holiday"}].map((e=>r.createElement("option",{key:e.value,value:e.value},e.label)))),v.leaveType&&r.createElement("div",{className:"error-text"},v.leaveType)),r.createElement("div",{className:"mb-4"},r.createElement("label",{className:"form-label"},"Reason *"),r.createElement("textarea",{value:u.reason,onChange:e=>p((t=>f(f({},t),{},{reason:e.target.value}))),className:"form-control".concat(v.reason?" error":""),rows:"3",placeholder:"Please provide a detailed reason for your PTO request",required:!0,disabled:c&&!h}),v.reason&&r.createElement("div",{className:"error-text"},v.reason)),q.length>0&&r.createElement("div",{className:"mb-4"},r.createElement("label",{className:"form-label"},"Daily Schedule"),r.createElement("div",{style:{background:"#f3f4f6",borderRadius:10,padding:16}},r.createElement("div",{style:{display:"grid",gap:10,maxHeight:170,overflowY:"auto"}},u.dailySchedules.map((e=>r.createElement("div",{key:e.date,style:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#fff",borderRadius:8,border:"1px solid #e5e7eb",padding:"10px 16px"}},r.createElement("div",{style:{fontWeight:500}},new Date(e.date).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})),r.createElement("select",{value:e.type,onChange:t=>{return a=e.date,r=t.target.value,void p((e=>f(f({},e),{},{dailySchedules:e.dailySchedules.map((e=>e.date===a?f(f({},e),{},{type:r}):e))})));var a,r},className:"form-control",style:{width:150}},r.createElement("option",{value:"FULL_DAY"},"Full Day (8h)"),r.createElement("option",{value:"HALF_DAY_MORNING"},"Morning Half (4h)"),r.createElement("option",{value:"HALF_DAY_AFTERNOON"},"Afternoon Half (4h)")))))))),q.length>0&&r.createElement("div",{className:"bg-blue-50 mb-4"},r.createElement("h4",{style:{fontWeight:600,color:"#1e40af",marginBottom:6}},"Request Summary"),r.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,fontSize:15,color:"#1e40af"}},r.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.createElement("span",null,"Total Days:"),r.createElement("span",{style:{fontWeight:600}},u.dailySchedules.reduce(((e,t)=>e+("FULL_DAY"===t.type?1:.5)),0))),r.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.createElement("span",null,"Total Hours:"),r.createElement("span",{style:{fontWeight:600}},u.dailySchedules.reduce(((e,t)=>e+("FULL_DAY"===t.type?8:4)),0),"h")),r.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.createElement("span",null,"Date Range:"),r.createElement("span",{style:{fontWeight:600}},q.length>0&&"".concat(new Date(q[0]).toLocaleDateString()," - ").concat(new Date(q[q.length-1]).toLocaleDateString()))),r.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.createElement("span",null,c?"For User:":"Manager:"),r.createElement("span",{style:{fontWeight:600}},c?(null==h?void 0:h.displayName)||"N/A":u.manager?u.manager.displayName:"Not selected")))),v.duplicate&&r.createElement("div",{className:"bg-red-50 error-text",style:{marginBottom:14}},v.duplicate),v.dates&&r.createElement("div",{className:"bg-red-50 error-text",style:{marginBottom:14}},v.dates),r.createElement("div",{style:{display:"flex",gap:14,marginTop:12}},r.createElement("button",{type:"button",onClick:l,className:"btn",style:{flex:1}},"Cancel"),r.createElement("button",{type:"button",onClick:()=>{if(!(()=>{var e,t;const r={};c?(h||(r.adminUser="User is required"),u.startDate||(r.startDate="Start date is required"),u.endDate||(r.endDate="End date is required"),u.startDate&&u.endDate&&new Date(u.startDate)>new Date(u.endDate)&&(r.endDate="End date must be after start date")):(0===a.length&&(r.dates="Please select at least one date"),u.manager||(r.manager="Manager selection is required")),u.leaveType||(r.leaveType="Leave type is required"),u.reason.trim()||(r.reason="Reason is required");const l=c?(null==h?void 0:h.id)||(null==h?void 0:h.accountId):(null===(e=u.manager)||void 0===e?void 0:e.id)||(null===(t=u.manager)||void 0===t?void 0:t.accountId);return function(e){let{allRequests:t,userId:a,dates:r}=e;return!!(a&&null!=r&&r.length&&null!=t&&t.length)&&t.filter((e=>!!e&&(e.userId===a||e.accountId===a||e.requester_id===a||e.targetUser&&(e.targetUser.id===a||e.targetUser.accountId===a)))).some((e=>{var t;return null===(t=e.dailySchedules)||void 0===t?void 0:t.some((e=>r.includes(e.date)))}))}({allRequests:d,userId:l,dates:c?b:a})&&(r.duplicate="This user already has a PTO request for one or more of these dates."),E(r),0===Object.keys(r).length})())return;const e=u.dailySchedules.reduce(((e,t)=>e+("FULL_DAY"===t.type?1:.5)),0),t=u.dailySchedules.reduce(((e,t)=>e+("FULL_DAY"===t.type?8:4)),0),r=f(f({},u),{},{totalDays:e,totalHours:t},c&&{targetUser:h,startDate:u.startDate,endDate:u.endDate});s(r)},disabled:c?!(h&&u.leaveType&&u.reason.trim()&&u.startDate&&u.endDate&&0!==q.length&&!v.duplicate):!(u.leaveType&&u.reason.trim()&&u.manager&&0!==q.length&&!v.duplicate),className:"btn btn-primary",style:{flex:1}},c?"Create PTO Request":"Submit Request")),c&&r.createElement("div",{className:"bg-yellow-50",style:{marginTop:16}},r.createElement("div",{style:{fontSize:15}},r.createElement("strong",null,"Admin Mode:")," This PTO request will be automatically approved and created on behalf of the selected user.")),!c&&0===a.length&&r.createElement("div",{className:"bg-blue-50",style:{marginTop:14}},r.createElement("div",{style:{fontSize:15}},r.createElement("strong",null,"Tip:"),' Please select dates on the calendar first, then click "Request PTO" to open this form.')))))};function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){D(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const O=function(e){let{isOpen:t,onClose:a,teams:l,users:n,onSaveTeam:s,onDeleteTeam:c,onSaveUser:m,onDeleteUser:i,showNotification:o,onRefresh:d}=e;const[u,p]=(0,r.useState)("teams"),[v,y]=(0,r.useState)("list"),[E,g]=(0,r.useState)(null),[b,f]=(0,r.useState)(null),[N,h]=(0,r.useState)(!1),[w,D]=(0,r.useState)({name:"",description:"",teamLead:"",department:"",color:"#667eea"}),[O,T]=(0,r.useState)({firstName:"",lastName:"",displayName:"",jiraAccountId:"",employmentType:"full-time",hireDate:"",teamId:"",capacity:40}),[x,k]=(0,r.useState)([{dayOfWeek:1,dayName:"Monday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:2,dayName:"Tuesday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:3,dayName:"Wednesday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:4,dayName:"Thursday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:5,dayName:"Friday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:6,dayName:"Saturday",isWorkingDay:!1,startTime:"",endTime:"",hoursPerDay:0},{dayOfWeek:7,dayName:"Sunday",isWorkingDay:!1,startTime:"",endTime:"",hoursPerDay:0}]),[S,P]=(0,r.useState)({}),A=()=>{D({name:"",description:"",teamLead:"",department:"",color:"#667eea"}),P({}),g(null)},C=()=>{T({firstName:"",lastName:"",displayName:"",jiraAccountId:"",employmentType:"full-time",hireDate:"",teamId:"",capacity:40}),k([{dayOfWeek:1,dayName:"Monday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:2,dayName:"Tuesday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:3,dayName:"Wednesday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:4,dayName:"Thursday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:5,dayName:"Friday",isWorkingDay:!0,startTime:"09:00",endTime:"17:00",hoursPerDay:8},{dayOfWeek:6,dayName:"Saturday",isWorkingDay:!1,startTime:"",endTime:"",hoursPerDay:0},{dayOfWeek:7,dayName:"Sunday",isWorkingDay:!1,startTime:"",endTime:"",hoursPerDay:0}]),P({}),f(null)};(0,r.useEffect)((()=>{(O.firstName||O.lastName)&&T((e=>q(q({},e),{},{displayName:"".concat(O.firstName," ").concat(O.lastName).trim()})))}),[O.firstName,O.lastName]),(0,r.useEffect)((()=>{const e=x.reduce(((e,t)=>e+(t.isWorkingDay?t.hoursPerDay:0)),0);T((t=>q(q({},t),{},{capacity:e})))}),[x]);const _=(e,t)=>{D((a=>q(q({},a),{},{[e]:t}))),S[e]&&P((t=>q(q({},t),{},{[e]:null})))},j=e=>{f(e),T({firstName:e.first_name||e.firstName||"",lastName:e.last_name||e.lastName||"",displayName:e.display_name||e.displayName||"",jiraAccountId:e.jira_account_id||e.accountId||"",employmentType:e.employment_type||e.employmentType||"full-time",hireDate:e.hire_date||e.hireDate||"",teamId:e.team_id||e.teamId||"",capacity:e.capacity||40}),e.availability&&Array.isArray(e.availability)&&k(e.availability),p("users"),y("form")},U=(e,t)=>{T((a=>q(q({},a),{},{[e]:t}))),S[e]&&P((t=>q(q({},t),{},{[e]:null})))},R=(e,t,a)=>{k((r=>{const l=[...r];if(l[e]=q(q({},l[e]),{},{[t]:a}),"startTime"===t||"endTime"===t){const t=l[e];if(t.startTime&&t.endTime&&t.isWorkingDay){const a=new Date("2000-01-01T".concat(t.startTime)),r=(new Date("2000-01-01T".concat(t.endTime))-a)/36e5;l[e].hoursPerDay=Math.max(0,r)}}return"isWorkingDay"!==t||a||(l[e].startTime="",l[e].endTime="",l[e].hoursPerDay=0),l}))},F=async(e,t)=>{if(window.confirm('Are you sure you want to delete the user "'.concat(t,'"? This action cannot be undone.'))){h(!0);try{await i(e),o("User deleted successfully"),d&&d()}catch(e){o("Failed to delete user","error")}finally{h(!1)}}},I=e=>n.filter((t=>t.team_id===e||t.teamId===e)),L=()=>n.filter((e=>!e.team_id&&!e.teamId));return t?r.createElement("div",{className:"modal-overlay"},r.createElement("div",{className:"modal-content team-management-modal"},r.createElement("div",{className:"modal-header"},r.createElement("h3",null,"Team & User Management"),r.createElement("button",{className:"modal-close",onClick:a},"×")),r.createElement("div",{className:"modal-body"},r.createElement("div",{className:"main-tab-navigation"},r.createElement("button",{className:"main-tab-btn ".concat("teams"===u?"active":""),onClick:()=>{p("teams"),y("list"),A(),C()}},"👥 Teams (",l.length,")"),r.createElement("button",{className:"main-tab-btn ".concat("users"===u?"active":""),onClick:()=>{p("users"),y("list"),A(),C()}},"👤 Users (",n.length,")")),"teams"===u&&r.createElement(r.Fragment,null,r.createElement("div",{className:"sub-tab-navigation"},r.createElement("button",{className:"tab-btn ".concat("list"===v?"active":""),onClick:()=>y("list")},"Teams List"),r.createElement("button",{className:"tab-btn ".concat("form"===v?"active":""),onClick:()=>{y("form"),A()}},E?"Edit Team":"Add New Team")),"list"===v&&r.createElement("div",{className:"teams-section"},0===l.length?r.createElement("div",{className:"empty-state"},r.createElement("div",{className:"empty-icon"},"👥"),r.createElement("h4",null,"No Teams Created"),r.createElement("p",null,"Create your first team to organize your resources"),r.createElement("button",{className:"btn btn-primary",onClick:()=>{A(),y("form")}},"Create First Team")):r.createElement("div",{className:"teams-grid"},l.map((e=>{var t,a;const l=I(e.id);return r.createElement("div",{key:e.id,className:"team-card",style:{borderLeftColor:e.color}},r.createElement("div",{className:"team-header"},r.createElement("h4",null,e.name),r.createElement("div",{className:"team-actions"},r.createElement("button",{className:"btn btn-sm btn-secondary",onClick:()=>(e=>{var t;g(e),D({name:e.name||"",description:e.description||"",teamLead:e.team_lead||(null===(t=e.manager)||void 0===t?void 0:t.displayName)||"",department:e.department||"",color:e.color||"#667eea"}),y("form")})(e),disabled:N},"Edit"),r.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async(e,t)=>{if(window.confirm('Are you sure you want to delete the team "'.concat(t,'"? This action cannot be undone.'))){h(!0);try{await c(e),o("Team deleted successfully"),d&&d()}catch(e){o("Failed to delete team","error")}finally{h(!1)}}})(e.id,e.name),disabled:N},"Delete"))),e.description&&r.createElement("p",{className:"team-description"},e.description),r.createElement("div",{className:"team-meta"},e.department&&r.createElement("span",{className:"team-department"},"📁 ",e.department),(e.team_lead||(null===(t=e.manager)||void 0===t?void 0:t.displayName))&&r.createElement("span",{className:"team-lead"},"👤 ",e.team_lead||(null===(a=e.manager)||void 0===a?void 0:a.displayName)),r.createElement("span",{className:"member-count"},l.length," members")),l.length>0&&r.createElement("div",{className:"team-members-preview"},r.createElement("h5",null,"Members:"),r.createElement("div",{className:"members-list"},l.slice(0,3).map((e=>{var t;return r.createElement("div",{key:e.id,className:"member-preview"},r.createElement("div",{className:"member-avatar-small"},e.avatar_url||e.avatarUrl?r.createElement("img",{src:e.avatar_url||e.avatarUrl,alt:e.display_name||e.displayName}):r.createElement("div",{className:"avatar-placeholder-small"},(null===(t=e.display_name||e.displayName||e.name)||void 0===t?void 0:t.charAt(0))||"?")),r.createElement("span",{className:"member-name-small"},e.display_name||e.displayName||e.name))})),l.length>3&&r.createElement("div",{className:"more-members"},"+",l.length-3," more"))))})))),"form"===v&&r.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return w.name.trim()||(e.name="Team name is required"),P(e),0===Object.keys(e).length})()){h(!0);try{const e={id:null==E?void 0:E.id,name:w.name,description:w.description,team_lead:w.teamLead,department:w.department,color:w.color,manager:(null==E?void 0:E.manager)||null,members:(null==E?void 0:E.members)||[]};await s(e),o(E?"Team updated successfully":"Team created successfully"),A(),y("list"),d&&d()}catch(e){o("Failed to save team","error")}finally{h(!1)}}},className:"team-form"},r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"team-name"},"Team Name *"),r.createElement("input",{type:"text",id:"team-name",className:"form-control ".concat(S.name?"error":""),value:w.name,onChange:e=>_("name",e.target.value),placeholder:"Enter team name",disabled:N}),S.name&&r.createElement("span",{className:"error-text"},S.name)),r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"team-description"},"Description"),r.createElement("textarea",{id:"team-description",className:"form-control",value:w.description,onChange:e=>_("description",e.target.value),placeholder:"Brief description of the team's purpose",rows:"3",disabled:N})),r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"team-lead"},"Team Lead"),r.createElement("input",{type:"text",id:"team-lead",className:"form-control",value:w.teamLead,onChange:e=>_("teamLead",e.target.value),placeholder:"Team lead name",disabled:N})),r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"department"},"Department"),r.createElement("select",{id:"department",className:"form-control",value:w.department,onChange:e=>_("department",e.target.value),disabled:N},r.createElement("option",{value:""},"Select Department"),r.createElement("option",{value:"Engineering"},"Engineering"),r.createElement("option",{value:"Product"},"Product"),r.createElement("option",{value:"Design"},"Design"),r.createElement("option",{value:"Marketing"},"Marketing"),r.createElement("option",{value:"Sales"},"Sales"),r.createElement("option",{value:"HR"},"Human Resources"),r.createElement("option",{value:"Finance"},"Finance"),r.createElement("option",{value:"Operations"},"Operations"),r.createElement("option",{value:"Customer Success"},"Customer Success"),r.createElement("option",{value:"QA"},"Quality Assurance")))),r.createElement("div",{className:"form-group"},r.createElement("label",null,"Team Color"),r.createElement("div",{className:"color-options"},["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#ffecd2","#fcb69f"].map((e=>r.createElement("div",{key:e,className:"color-option ".concat(w.color===e?"selected":""),style:{backgroundColor:e},onClick:()=>!N&&_("color",e)}))))),r.createElement("div",{className:"form-actions"},r.createElement("button",{type:"submit",className:"btn btn-primary",disabled:N},N?"Saving...":E?"Update Team":"Create Team"),r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{A(),y("list")},disabled:N},"Cancel")))),"users"===u&&r.createElement(r.Fragment,null,r.createElement("div",{className:"sub-tab-navigation"},r.createElement("button",{className:"tab-btn ".concat("list"===v?"active":""),onClick:()=>y("list")},"Users List"),r.createElement("button",{className:"tab-btn ".concat("form"===v?"active":""),onClick:()=>{y("form"),C()}},b?"Edit User":"Add New User")),"list"===v&&r.createElement("div",{className:"users-section"},0===n.length?r.createElement("div",{className:"empty-state"},r.createElement("div",{className:"empty-icon"},"👤"),r.createElement("h4",null,"No Users Created"),r.createElement("p",null,"Add your first team member to get started"),r.createElement("button",{className:"btn btn-primary",onClick:()=>{C(),y("form")}},"Add First User")):r.createElement(r.Fragment,null,l.map((e=>{const t=I(e.id);return 0===t.length?null:r.createElement("div",{key:e.id,className:"team-users-section"},r.createElement("h4",{style:{color:e.color}},e.name," (",t.length," members)"),r.createElement("div",{className:"users-grid"},t.map((e=>{var t,a;return r.createElement("div",{key:e.id,className:"user-card"},r.createElement("div",{className:"user-avatar"},e.avatar_url||e.avatarUrl?r.createElement("img",{src:e.avatar_url||e.avatarUrl,alt:e.display_name||e.displayName}):r.createElement("div",{className:"avatar-placeholder"},(null===(t=e.display_name||e.displayName||e.name)||void 0===t?void 0:t.charAt(0))||"?")),r.createElement("div",{className:"user-info"},r.createElement("h5",null,e.display_name||e.displayName||e.name),r.createElement("p",{className:"user-role"},null===(a=e.employment_type||e.employmentType)||void 0===a?void 0:a.replace("-"," ")),r.createElement("div",{className:"user-capacity"},e.capacity||40,"h/week capacity")),r.createElement("div",{className:"user-actions"},r.createElement("button",{className:"btn btn-sm btn-secondary",onClick:()=>j(e),disabled:N},"Edit"),r.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>F(e.id,e.display_name||e.displayName||e.name),disabled:N},"Delete")))}))))})),L().length>0&&r.createElement("div",{className:"team-users-section"},r.createElement("h4",{style:{color:"#6c757d"}},"Unassigned Users (",L().length,")"),r.createElement("div",{className:"users-grid"},L().map((e=>{var t,a;return r.createElement("div",{key:e.id,className:"user-card"},r.createElement("div",{className:"user-avatar"},e.avatar_url||e.avatarUrl?r.createElement("img",{src:e.avatar_url||e.avatarUrl,alt:e.display_name||e.displayName}):r.createElement("div",{className:"avatar-placeholder"},(null===(t=e.display_name||e.displayName||e.name)||void 0===t?void 0:t.charAt(0))||"?")),r.createElement("div",{className:"user-info"},r.createElement("h5",null,e.display_name||e.displayName||e.name),r.createElement("p",{className:"user-role"},null===(a=e.employment_type||e.employmentType)||void 0===a?void 0:a.replace("-"," ")),r.createElement("div",{className:"user-capacity"},e.capacity||40,"h/week capacity")),r.createElement("div",{className:"user-actions"},r.createElement("button",{className:"btn btn-sm btn-secondary",onClick:()=>j(e),disabled:N},"Edit"),r.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>F(e.id,e.display_name||e.displayName||e.name),disabled:N},"Delete")))})))))),"form"===v&&r.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return O.firstName.trim()||(e.firstName="First name is required"),O.lastName.trim()||(e.lastName="Last name is required"),P(e),0===Object.keys(e).length})()){h(!0);try{const e={id:null==b?void 0:b.id,first_name:O.firstName,last_name:O.lastName,display_name:O.displayName,jira_account_id:O.jiraAccountId,employment_type:O.employmentType,hire_date:O.hireDate,team_id:O.teamId,capacity:O.capacity,availability:x};await m(e),o(b?"User updated successfully":"User created successfully"),C(),y("list"),d&&d()}catch(e){o("Failed to save user","error")}finally{h(!1)}}},className:"user-form"},r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"firstName"},"First Name *"),r.createElement("input",{type:"text",id:"firstName",className:"form-control ".concat(S.firstName?"error":""),value:O.firstName,onChange:e=>U("firstName",e.target.value),placeholder:"Enter first name",disabled:N}),S.firstName&&r.createElement("span",{className:"error-text"},S.firstName)),r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"lastName"},"Last Name *"),r.createElement("input",{type:"text",id:"lastName",className:"form-control ".concat(S.lastName?"error":""),value:O.lastName,onChange:e=>U("lastName",e.target.value),placeholder:"Enter last name",disabled:N}),S.lastName&&r.createElement("span",{className:"error-text"},S.lastName))),r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"displayName"},"Display Name"),r.createElement("input",{type:"text",id:"displayName",className:"form-control",value:O.displayName,onChange:e=>U("displayName",e.target.value),placeholder:"Display name (auto-generated from first/last name)",disabled:N})),r.createElement("div",{className:"form-row"},r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"employmentType"},"Employment Type"),r.createElement("select",{id:"employmentType",className:"form-control",value:O.employmentType,onChange:e=>U("employmentType",e.target.value),disabled:N},r.createElement("option",{value:"full-time"},"Full-time"),r.createElement("option",{value:"part-time"},"Part-time"),r.createElement("option",{value:"contractor"},"Contractor"))),r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"hireDate"},"Hire Date"),r.createElement("input",{type:"date",id:"hireDate",className:"form-control",value:O.hireDate,onChange:e=>U("hireDate",e.target.value),disabled:N}))),r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"teamId"},"Team"),r.createElement("select",{id:"teamId",className:"form-control",value:O.teamId||"",onChange:e=>U("teamId",e.target.value),disabled:N},r.createElement("option",{value:""},"Select a team (optional)"),l.map((e=>r.createElement("option",{key:e.id,value:e.id},e.name))))),r.createElement("div",{className:"form-group"},r.createElement("label",{htmlFor:"jiraAccountId"},"Jira Account ID"),r.createElement("input",{type:"text",id:"jiraAccountId",className:"form-control",value:O.jiraAccountId,onChange:e=>U("jiraAccountId",e.target.value),placeholder:"Optional: Link to Jira account",disabled:N})),r.createElement("div",{className:"availability-section"},r.createElement("h4",null,"Working Schedule"),r.createElement("p",{className:"help-text"},"Set the default working hours for this team member."),r.createElement("div",{className:"availability-grid"},x.map(((e,t)=>r.createElement("div",{key:e.dayOfWeek,className:"availability-day"},r.createElement("div",{className:"day-header"},r.createElement("label",{className:"checkbox-label"},r.createElement("input",{type:"checkbox",checked:e.isWorkingDay,onChange:e=>R(t,"isWorkingDay",e.target.checked),disabled:N}),r.createElement("span",{className:"day-name"},e.dayName))),e.isWorkingDay&&r.createElement("div",{className:"day-details"},r.createElement("div",{className:"time-inputs"},r.createElement("input",{type:"time",value:e.startTime,onChange:e=>R(t,"startTime",e.target.value),className:"form-control input-small",disabled:N}),r.createElement("span",null,"to"),r.createElement("input",{type:"time",value:e.endTime,onChange:e=>R(t,"endTime",e.target.value),className:"form-control input-small",disabled:N})),r.createElement("div",{className:"hours-display"},e.hoursPerDay.toFixed(1)," hours")))))),r.createElement("div",{className:"availability-summary"},r.createElement("strong",null,"Total weekly capacity: "),x.reduce(((e,t)=>e+(t.isWorkingDay?t.hoursPerDay:0)),0).toFixed(1)," hours")),r.createElement("div",{className:"form-actions"},r.createElement("button",{type:"submit",className:"btn btn-primary",disabled:N},N?"Saving...":b?"Update User":"Create User"),r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:()=>{C(),y("list")},disabled:N},"Cancel"))))),r.createElement("div",{className:"modal-footer"},r.createElement("button",{className:"btn btn-secondary",onClick:a,disabled:N},"Close")))):null};function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){k(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function k(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function S(e){let{title:t,value:a,color:l,icon:n}=e;return r.createElement("div",{className:"summary-card summary-card-".concat(l)},r.createElement("div",{className:"summary-card-icon"},n),r.createElement("div",{className:"summary-card-content"},r.createElement("div",{className:"summary-card-title"},t),r.createElement("div",{className:"summary-card-value"},a)))}function P(e){let{title:t,children:a,onClose:l}=e;return r.createElement("div",{className:"modal-overlay"},r.createElement("div",{className:"modal-content",style:{maxWidth:500}},r.createElement("div",{className:"modal-header"},r.createElement("h3",null,t),r.createElement("button",{className:"modal-close",onClick:l},r.createElement(y.A,{size:24}))),r.createElement("div",{className:"modal-body"},a)))}const A=e=>{let{currentUser:t,showNotification:a}=e;const[l,s]=(0,r.useState)("overview"),[c,o]=(0,r.useState)(!1),[u,y]=(0,r.useState)([]),[E,b]=(0,r.useState)([]),[f,N]=(0,r.useState)([]),[w,q]=(0,r.useState)([]),[D,T]=(0,r.useState)(!1),[k,A]=(0,r.useState)(!1),[C,_]=(0,r.useState)(!1),[j,U]=(0,r.useState)(null);(0,r.useEffect)((()=>{R()}),[]);const R=async()=>{o(!0);try{await Promise.all([F(),I(),L(),z()])}catch(e){a("Failed to load admin data","error")}finally{o(!1)}},F=async()=>{try{const e=await(0,d.invoke)("getAdminUsers");e.success&&y(e.data||[])}catch(e){}},I=async()=>{try{const e=await(0,d.invoke)("getTeams");e.success&&b(e.data||[])}catch(e){}},L=async()=>{try{const e=await(0,d.invoke)("getUsers");e.success&&N(e.data||[])}catch(e){}},z=async()=>{try{const e=await(0,d.invoke)("getPTORequests");e.success&&q(e.data||[])}catch(e){}},W={totalAdmins:u.length,totalTeams:E.length,totalUsers:f.length,totalRequests:w.length,pendingRequests:w.filter((e=>"pending"===e.status)).length,approvedRequests:w.filter((e=>"approved"===e.status)).length};return r.createElement("div",{className:"dashboard"},r.createElement("div",{className:"main-tabs"},r.createElement("button",{className:"tab-btn".concat("overview"===l?" active":""),onClick:()=>s("overview")},"Overview"),r.createElement("button",{className:"tab-btn".concat("analytics"===l?" active":""),onClick:()=>s("analytics")},"Analytics")),"overview"===l&&r.createElement("div",{className:"dashboard-section"},r.createElement("div",{className:"dashboard-cards"},r.createElement(S,{title:"Admin Users",value:W.totalAdmins,color:"purple",icon:r.createElement(i.A,{size:24})}),r.createElement(S,{title:"Teams",value:W.totalTeams,color:"blue",icon:r.createElement(m.A,{size:24})}),r.createElement(S,{title:"Total Users",value:W.totalUsers,color:"emerald",icon:r.createElement(p.A,{size:24})}),r.createElement(S,{title:"PTO Requests",value:W.totalRequests,color:"orange",icon:r.createElement(n.A,{size:24})}),r.createElement(S,{title:"Pending",value:W.pendingRequests,color:"yellow",icon:r.createElement(n.A,{size:24})}),r.createElement(S,{title:"Approved",value:W.approvedRequests,color:"green",icon:r.createElement(n.A,{size:24})})),r.createElement("div",{className:"card"},r.createElement("div",{className:"card-header"},"Quick Actions"),r.createElement("div",{className:"quick-actions"},r.createElement("button",{onClick:()=>A(!0),className:"action-btn"},r.createElement("div",{className:"action-icon bg-blue"},r.createElement(v.A,{size:20})),r.createElement("div",null,r.createElement("div",{className:"action-title"},"Manage Teams & Users"),r.createElement("div",{className:"action-desc"},"Advanced team and user management"))),r.createElement("button",{onClick:()=>T(!0),className:"action-btn"},r.createElement("div",{className:"action-icon bg-purple"},r.createElement(i.A,{size:20})),r.createElement("div",null,r.createElement("div",{className:"action-title"},"Add Admin"),r.createElement("div",{className:"action-desc"},"Grant admin privileges"))),r.createElement("button",{onClick:()=>_(!0),className:"action-btn"},r.createElement("div",{className:"action-icon bg-green"},r.createElement(n.A,{size:20})),r.createElement("div",null,r.createElement("div",{className:"action-title"},"Create PTO"),r.createElement("div",{className:"action-desc"},"Create PTO for users"))))),r.createElement("div",{className:"card"},r.createElement("div",{className:"card-header"},"Recent PTO Requests"),r.createElement("div",{className:"card-body"},w.slice(0,5).map((e=>{var t;return r.createElement("div",{key:e.id,className:"request-row"},r.createElement("div",{className:"request-avatar"},(null===(t=e.requester_name)||void 0===t?void 0:t.charAt(0))||"?"),r.createElement("div",{className:"request-info"},r.createElement("span",{className:"request-user"},e.requester_name),r.createElement("span",{className:"request-type"},"requested ",e.leave_type),r.createElement("div",{className:"request-date"},new Date(e.start_date).toLocaleDateString())),r.createElement("span",{className:"status-badge status-".concat(e.status)},e.status))}))))),"analytics"===l&&r.createElement("div",{className:"dashboard-section"},r.createElement("div",{className:"card"},r.createElement("div",{className:"card-header"},"PTO Requests by Status"),r.createElement("div",{className:"card-body"},r.createElement("table",{className:"dashboard-table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Status"),r.createElement("th",null,"Count"))),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,"Approved"),r.createElement("td",null,W.approvedRequests)),r.createElement("tr",null,r.createElement("td",null,"Pending"),r.createElement("td",null,W.pendingRequests)),r.createElement("tr",null,r.createElement("td",null,"Total"),r.createElement("td",null,W.totalRequests))))))),D&&r.createElement(P,{title:"Add Admin User",onClose:()=>T(!1)},r.createElement(g,{selectedUser:null,onSelect:async e=>{if(e)try{const r=await(0,d.invoke)("addAdminUser",{accountId:e.accountId,addedBy:t.accountId});r.success?(a("".concat(e.displayName," added as admin")),T(!1),F()):a(r.message||"Failed to add admin","error")}catch(e){a("Failed to add admin user","error")}},placeholder:"Search and select user to grant admin privileges",required:!0}),r.createElement("button",{className:"btn btn-link",onClick:()=>T(!1)},"Close")),k&&r.createElement(O,{isOpen:k,onClose:()=>A(!1),teams:E,users:f,onSaveTeam:async e=>{E.some((t=>t.name.trim().toLowerCase()===e.name.trim().toLowerCase()&&t.id!==e.id))?a("A team with this name already exists.","error"):(await(0,d.invoke)(e.id?"updateTeam":"createTeam",e),I())},onDeleteTeam:async e=>{await(0,d.invoke)("deleteTeam",{teamId:e,deletedBy:t.accountId}),I()},onSaveUser:async e=>{f.some((t=>{var a,r;return((null===(a=t.email)||void 0===a?void 0:a.toLowerCase())===(null===(r=e.email)||void 0===r?void 0:r.toLowerCase())||t.accountId===e.accountId)&&t.id!==e.id}))?a("A user with this email or account already exists.","error"):(await(0,d.invoke)(e.id?"updateUser":"createUser",e),L())},onDeleteUser:async e=>{await(0,d.invoke)("deleteUser",{userId:e,deletedBy:t.accountId}),L()},showNotification:a,onRefresh:R}),C&&r.createElement(h,{isAdminMode:!0,onClose:()=>{_(!1),U(null)},onSubmit:async e=>{if(null!=e&&e.targetUser)try{const r=await(0,d.invoke)("submitPTOForUser",x(x({},e),{},{submittedBy:t.accountId}));r.success?(a("PTO request created for ".concat(e.targetUser.displayName)),_(!1),U(null),z()):a(r.message||"Failed to create PTO request","error")}catch(e){a("Failed to create PTO request","error")}else a("Please select a user for PTO","error")},targetUser:j,allUsers:f,allTeams:E,allRequests:w}))};var C=a(6316),_=a(8309),j=a(7946),U=a(180);const R=e=>{let{status:t}=e;const a=(e=>{const t={pending:{bg:"bg-yellow-100",text:"text-yellow-800",icon:j.A,label:"Pending"},approved:{bg:"bg-green-100",text:"text-green-800",icon:c.A,label:"Approved"},declined:{bg:"bg-red-100",text:"text-red-800",icon:U.A,label:"Declined"}};return t[e.toLowerCase()]||t.pending})(t),l=a.icon;return r.createElement("span",{className:"inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ".concat(a.bg," ").concat(a.text)},r.createElement(l,{size:12}),r.createElement("span",null,a.label))},F={vacation:{id:"vacation",label:"🏖️ Vacation",emoji:"🏖️",color:"bg-blue-100 text-blue-800"},sick:{id:"sick",label:"🤒 Sick Leave",emoji:"🤒",color:"bg-red-100 text-red-800"},personal:{id:"personal",label:"👤 Personal Day",emoji:"👤",color:"bg-purple-100 text-purple-800"},holiday:{id:"holiday",label:"🎉 Holiday",emoji:"🎉",color:"bg-green-100 text-green-800"}},I=e=>{var t;return(null===(t=F[e.toLowerCase()])||void 0===t?void 0:t.emoji)||"📅"},L=e=>{var t;let{teamData:a,requests:l,currentUser:s}=e;const[c,i]=(0,r.useState)("current_month"),[u,p]=(0,r.useState)("all"),[v,y]=(0,r.useState)([]),[E,g]=(0,r.useState)(null),[b,f]=(0,r.useState)([]),[N,h]=(0,r.useState)(!0),[w,q]=(0,r.useState)(""),[D,O]=(0,r.useState)([]);(0,r.useEffect)((()=>{s&&T()}),[s]),(0,r.useEffect)((()=>{E&&x()}),[E,c]);const T=async()=>{h(!0);try{const e=await(0,d.invoke)("getTeams");if(!e.success)throw new Error(e.message||"Failed to load teams");{const t=e.data||[];y(t);const a=t.find((e=>{var t,a;return(null===(t=e.manager)||void 0===t?void 0:t.accountId)===s.accountId||(null===(a=e.members)||void 0===a?void 0:a.some((e=>e.accountId===s.accountId)))}));g(a||t[0]||null)}}catch(e){q("Failed to load teams: "+e.message)}finally{h(!1)}},x=async()=>{if(E)try{const e=await(0,d.invoke)("getTeamPTORequests",{teamId:E.id,dateRange:c});f(e.success&&e.data||[])}catch(e){f([])}},k=(()=>{const e=b||[];return{totalRequests:e.length,approvedRequests:e.filter((e=>"approved"===e.status)).length,pendingRequests:e.filter((e=>"pending"===e.status)).length,totalDaysOff:e.filter((e=>"approved"===e.status)).reduce(((e,t)=>e+(t.total_days||0)),0)}})(),S=(()=>{const e=new Date;return(b||[]).filter((t=>"approved"===t.status&&new Date(t.start_date)>=e)).sort(((e,t)=>new Date(e.start_date)-new Date(t.start_date))).slice(0,5)})(),P=(()=>{let e=b||[];return"all"!==u&&(e=e.filter((e=>e.requester_id===u))),e.sort(((e,t)=>new Date(t.submitted_at)-new Date(e.submitted_at)))})(),A=(null==E?void 0:E.members)||[];return N?r.createElement("div",{className:"loading-container"},r.createElement("div",{className:"loading-spinner"}),r.createElement("p",null,"Loading team information...")):w?r.createElement("div",{className:"error-container"},r.createElement("div",{className:"error-icon"},"⚠️"),r.createElement("h3",{className:"error-title"},"Error Loading Teams"),r.createElement("p",{className:"error-desc"},w),r.createElement("button",{className:"btn btn-primary",onClick:T},"Retry")):0===v.length?r.createElement("div",{className:"empty-state-card"},r.createElement(m.A,{size:48,className:"empty-icon"}),r.createElement("h3",null,"No Teams Found"),r.createElement("p",null,"You don't have access to any teams yet. Contact your administrator to be added to a team.")):r.createElement("div",{className:"team-dashboard"},r.createElement("div",{className:"card team-header-card"},r.createElement("div",{className:"team-header"},r.createElement("div",{className:"team-header-title"},r.createElement("div",{className:"team-header-icon"},r.createElement(m.A,{size:20})),r.createElement("div",null,r.createElement("h1",null,"Team Dashboard"),r.createElement("p",null,"Manage and overview team PTO requests"))),r.createElement("select",{className:"team-select",value:(null==E?void 0:E.id)||"",onChange:e=>g(v.find((t=>t.id===e.target.value)))},v.map((e=>{var t;return r.createElement("option",{key:e.id,value:e.id},e.name," (",(null===(t=e.members)||void 0===t?void 0:t.length)||0," members)")})))),E&&r.createElement("div",{className:"team-meta"},r.createElement("div",null,r.createElement("h3",null,E.name),E.description&&r.createElement("p",null,E.description),r.createElement("p",{className:"team-manager"},"Manager: ",(null===(t=E.manager)||void 0===t?void 0:t.displayName)||"Not assigned")),r.createElement("div",{className:"team-member-count"},r.createElement("div",null,A.length),r.createElement("div",null,"Team Members")))),r.createElement("div",{className:"team-stats-cards"},r.createElement("div",{className:"team-stat-card stat-blue"},r.createElement("span",{className:"team-stat-label"},"Total Requests"),r.createElement("span",{className:"team-stat-value"},k.totalRequests),r.createElement(n.A,{size:20})),r.createElement("div",{className:"team-stat-card stat-green"},r.createElement("span",{className:"team-stat-label"},"Approved"),r.createElement("span",{className:"team-stat-value"},k.approvedRequests),r.createElement(C.A,{size:20})),r.createElement("div",{className:"team-stat-card stat-yellow"},r.createElement("span",{className:"team-stat-label"},"Pending"),r.createElement("span",{className:"team-stat-value"},k.pendingRequests),r.createElement(n.A,{size:20})),r.createElement("div",{className:"team-stat-card stat-purple"},r.createElement("span",{className:"team-stat-label"},"Total Days Off"),r.createElement("span",{className:"team-stat-value"},k.totalDaysOff),r.createElement(m.A,{size:20}))),r.createElement("div",{className:"team-dashboard-panels"},r.createElement("div",{className:"card team-members-panel"},r.createElement("h3",null,"Team Members"),0===A.length?r.createElement("div",{className:"empty-panel"},r.createElement(o.A,{size:24,className:"empty-icon"}),r.createElement("p",null,"No team members")):A.map((e=>{var t;const a=(b||[]).filter((t=>t.requester_id===e.accountId)).filter((e=>"approved"===e.status&&new Date(e.start_date)<=new Date&&new Date(e.end_date)>=new Date));return r.createElement("div",{key:e.accountId,className:"team-member-row"},r.createElement("div",{className:"team-member-avatar"},(null===(t=e.displayName)||void 0===t?void 0:t.charAt(0))||"U"),r.createElement("div",{className:"team-member-details"},r.createElement("div",null,e.displayName||"Unknown"),r.createElement("div",null,e.emailAddress||"")),a.length>0&&r.createElement("div",{className:"on-pto-badge"},"On PTO"))}))),r.createElement("div",{className:"card upcoming-pto-panel"},r.createElement("h3",null,"Upcoming PTO"),0===S.length?r.createElement("div",{className:"empty-panel"},r.createElement(n.A,{size:32,className:"empty-icon"}),r.createElement("p",null,"No upcoming PTO scheduled")):S.map((e=>r.createElement("div",{key:e.id,className:"upcoming-pto-row"},r.createElement("span",{className:"upcoming-pto-emoji"},I(e.leave_type)),r.createElement("div",{className:"upcoming-pto-details"},r.createElement("div",null,e.requester_name),r.createElement("div",null,new Date(e.start_date).toLocaleDateString()," - ",new Date(e.end_date).toLocaleDateString())),r.createElement("div",{className:"upcoming-pto-days"},e.total_days,"d"))))),r.createElement("div",{className:"card quick-actions-panel"},r.createElement("h3",null,"Quick Actions"),r.createElement("button",{className:"btn quick-action-btn",onClick:async()=>{if(E)try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth()+3,0),a=await(0,d.invoke)("getPTOCalendarEvents",{startDate:e.toISOString().split("T")[0],endDate:t.toISOString().split("T")[0]});if(a.success){const e=E.members.map((e=>e.emailAddress)),t=(a.data||[]).filter((t=>{var a;return e.includes(null===(a=t.user)||void 0===a?void 0:a.email)}));O(t),alert("Found ".concat(t.length," team PTO events. (Calendar integration coming soon)"))}}catch(e){alert("Failed to load calendar events")}}},r.createElement(n.A,{size:20}),r.createElement("span",null,"View Team Calendar")),r.createElement("button",{className:"btn quick-action-btn",onClick:()=>{if(E)try{const e=P.map((e=>({"Employee Name":e.requester_name,Email:e.requester_email,"Leave Type":e.leave_type,"Start Date":e.start_date,"End Date":e.end_date,"Total Days":e.total_days,Status:e.status,"Submitted Date":new Date(e.submitted_at).toLocaleDateString(),Reason:e.reason}))),t=Object.keys(e[0]||{}),a=[t.join(","),...e.map((e=>t.map((t=>'"'.concat((e[t]||"").toString().replace(/"/g,'""'),'"'))).join(",")))].join("\n"),r=new Blob([a],{type:"text/csv"}),l=URL.createObjectURL(r),n=document.createElement("a");n.href=l,n.download="team-pto-report-".concat(E.name,"-").concat(c,"-").concat((new Date).toISOString().split("T")[0],".csv"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l),alert("Report downloaded successfully!")}catch(e){alert("Failed to generate report")}}},r.createElement(_.A,{size:20}),r.createElement("span",null,"Generate Report")))),r.createElement("div",{className:"card recent-requests-panel"},r.createElement("div",{className:"recent-requests-header"},r.createElement("h3",null,"Recent Team Requests"),r.createElement("div",{className:"recent-requests-filters"},r.createElement("select",{className:"filter-select",value:u,onChange:e=>p(e.target.value)},r.createElement("option",{value:"all"},"All Members"),A.map((e=>r.createElement("option",{key:e.accountId,value:e.accountId},e.displayName)))),r.createElement("select",{className:"filter-select",value:c,onChange:e=>i(e.target.value)},r.createElement("option",{value:"current_month"},"This Month"),r.createElement("option",{value:"next_month"},"Next Month"),r.createElement("option",{value:"next_3_months"},"Next 3 Months"),r.createElement("option",{value:"all"},"All Time")))),0===P.length?r.createElement("div",{className:"empty-panel"},r.createElement(m.A,{size:32,className:"empty-icon"}),r.createElement("p",null,"No requests found for the selected criteria")):P.slice(0,10).map((e=>{var t;return r.createElement("div",{key:e.id,className:"recent-request-row"},r.createElement("div",{className:"recent-request-user"},r.createElement("div",{className:"recent-request-avatar"},(null===(t=e.requester_name)||void 0===t?void 0:t.charAt(0))||r.createElement(o.A,{size:16})),r.createElement("div",null,r.createElement("div",null,e.requester_name),r.createElement("div",null,I(e.leave_type)," ",e.leave_type," • ",e.total_days," days"))),r.createElement("div",{className:"recent-request-info"},r.createElement("div",null,r.createElement("div",null,new Date(e.start_date).toLocaleDateString()),r.createElement("div",null,new Date(e.submitted_at).toLocaleDateString())),r.createElement(R,{status:e.status})))}))))};var z=a(697);const W=e=>{let{events:t,onDateSelect:a,selectedDates:l,onSubmitPTO:n}=e;const[s,c]=(0,r.useState)(new Date),[m,i]=(0,r.useState)(!1),o=e=>e.toISOString().split("T")[0],d=e=>{c((t=>{const a=new Date(t);return a.setMonth(t.getMonth()+e),a}))},u=(e=>{const t=e.getFullYear(),a=e.getMonth(),r=new Date(t,a,1),l=new Date(t,a+1,0).getDate(),n=r.getDay(),s=[];for(let e=0;e<n;e++)s.push(null);for(let e=1;e<=l;e++)s.push(new Date(t,a,e));return s})(s);return r.createElement("div",{className:"card calendar-card"},r.createElement("div",{className:"calendar-header"},r.createElement("div",{className:"calendar-header-controls"},r.createElement("button",{onClick:()=>d(-1),className:"calendar-nav-btn"},"←"),r.createElement("h2",{className:"calendar-title"},["January","February","March","April","May","June","July","August","September","October","November","December"][s.getMonth()]," ",s.getFullYear()),r.createElement("button",{onClick:()=>d(1),className:"calendar-nav-btn"},"→")),l.length>0&&r.createElement("button",{onClick:()=>i(!0),className:"btn btn-primary calendar-submit-btn"},r.createElement(z.A,{size:16}),r.createElement("span",null,"Request PTO (",l.length," days)"))),r.createElement("div",{className:"calendar-info"},r.createElement("p",null,"💡 Click on dates to select them for your PTO request. Selected dates will be highlighted in blue.")),r.createElement("div",{className:"calendar-days-row"},["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>r.createElement("div",{key:e,className:"calendar-day-label"},e)))),r.createElement("div",{className:"calendar-days-row"},u.map(((e,n)=>{if(!e)return r.createElement("div",{key:n,className:"calendar-day calendar-day-empty"});const s=(c=e,l.includes(o(c)));var c;(e=>{const a=o(e);t.some((e=>a>=e.start_date&&a<=e.end_date))})(e);const m=(e=>{const a=o(e);return t.filter((e=>a>=e.start_date&&a<=e.end_date))})(e),i=e.toDateString()===(new Date).toDateString(),d=e<new Date((new Date).setHours(0,0,0,0));return r.createElement("div",{key:e.toISOString(),onClick:()=>!d&&a(e),className:"calendar-day"+(d?" calendar-day-past":" calendar-day-active")+(s?" calendar-day-selected":"")+(i?" calendar-day-today":"")},r.createElement("div",{className:"calendar-day-inner"},r.createElement("span",{className:"calendar-day-number"+(i?" calendar-day-number-today":"")+(d?" calendar-day-number-past":"")},e.getDate()),r.createElement("div",{className:"calendar-day-events"},m.slice(0,2).map(((e,t)=>r.createElement("div",{key:"".concat(e.id,"-").concat(t),className:"calendar-event"+("approved"===e.status?" calendar-event-approved":"")+("pending"===e.status?" calendar-event-pending":"")+("declined"===e.status?" calendar-event-declined":""),title:"".concat(e.requester_name,": ").concat(e.reason)},r.createElement("span",null,I(e.leave_type)),r.createElement("span",{className:"calendar-event-name"},e.requester_name)))),m.length>2&&r.createElement("div",{className:"calendar-event-more"},"+",m.length-2," more"))))}))),r.createElement("div",{className:"calendar-legend"},r.createElement("div",{className:"calendar-legend-item"},r.createElement("span",{className:"calendar-legend-dot calendar-event-approved"}),r.createElement("span",null,"Approved")),r.createElement("div",{className:"calendar-legend-item"},r.createElement("span",{className:"calendar-legend-dot calendar-event-pending"}),r.createElement("span",null,"Pending")),r.createElement("div",{className:"calendar-legend-item"},r.createElement("span",{className:"calendar-legend-dot calendar-event-declined"}),r.createElement("span",null,"Declined")),r.createElement("div",{className:"calendar-legend-item"},r.createElement("span",{className:"calendar-legend-dot calendar-day-selected"}),r.createElement("span",null,"Selected"))),m&&r.createElement(h,{selectedDates:l,onClose:()=>i(!1),onSubmit:e=>{n(e),i(!1)}}))};var M=a(3160),Y=a(8188),B=a(2708);const H=e=>{let{requests:t,currentUser:a,onEditRequest:l,onCancelRequest:c}=e;const m=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return t.length?r.createElement("div",{className:"card requests-card"},r.createElement("div",{className:"requests-header"},r.createElement("h2",{className:"card-title"},"My PTO Requests"),r.createElement("div",{className:"requests-count"},"Total requests: ",t.length)),r.createElement("div",{className:"requests-summary-cards"},r.createElement("div",{className:"requests-summary-card stat-yellow"},r.createElement("div",{className:"requests-summary-content"},r.createElement("div",null,r.createElement("p",{className:"requests-summary-label"},"Pending"),r.createElement("p",{className:"requests-summary-value"},t.filter((e=>"pending"===e.status)).length)),r.createElement(s.A,{className:"requests-summary-icon",size:24}))),r.createElement("div",{className:"requests-summary-card stat-green"},r.createElement("div",{className:"requests-summary-content"},r.createElement("div",null,r.createElement("p",{className:"requests-summary-label"},"Approved"),r.createElement("p",{className:"requests-summary-value"},t.filter((e=>"approved"===e.status)).length)),r.createElement(n.A,{className:"requests-summary-icon",size:24}))),r.createElement("div",{className:"requests-summary-card stat-blue"},r.createElement("div",{className:"requests-summary-content"},r.createElement("div",null,r.createElement("p",{className:"requests-summary-label"},"Total Days"),r.createElement("p",{className:"requests-summary-value"},t.reduce(((e,t)=>e+t.total_days),0))),r.createElement(M.A,{className:"requests-summary-icon",size:24})))),r.createElement("div",{className:"requests-list"},t.map((e=>{return r.createElement("div",{key:e.id,className:"request-row"},r.createElement("div",{className:"request-row-content"},r.createElement("div",{className:"request-main"},r.createElement("div",{className:"request-type-row"},r.createElement("span",{className:"request-type-emoji"},I(e.leave_type)),r.createElement("div",null,r.createElement("h3",{className:"request-type-title"},e.leave_type.charAt(0).toUpperCase()+e.leave_type.slice(1)," Leave"),r.createElement("p",{className:"request-type-reason"},e.reason))),r.createElement("div",{className:"request-details-row"},r.createElement("div",{className:"request-detail"},r.createElement(n.A,{size:14,className:"request-detail-icon"}),r.createElement("div",null,r.createElement("div",{className:"request-detail-label"},"Date Range"),r.createElement("div",null,m(e.start_date)," - ",m(e.end_date)))),r.createElement("div",{className:"request-detail"},r.createElement(s.A,{size:14,className:"request-detail-icon"}),r.createElement("div",null,r.createElement("div",{className:"request-detail-label"},"Duration"),r.createElement("div",null,e.total_days," days (",e.total_hours,"h)"))),r.createElement("div",{className:"request-detail"},r.createElement(M.A,{size:14,className:"request-detail-icon"}),r.createElement("div",null,r.createElement("div",{className:"request-detail-label"},"Submitted"),r.createElement("div",null,(t=e.submitted_at,new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})))))),"pending"!==e.status&&r.createElement("div",{className:"request-review-info"},r.createElement("div",null,r.createElement("span",{className:"request-review-label"},"approved"===e.status?"Approved":"Declined",e.reviewed_at&&" on ".concat(m(e.reviewed_at))),e.reviewer_comments&&r.createElement("div",{className:"request-review-comments"},r.createElement("span",{className:"request-review-comments-label"},"Manager Comments:")," ",e.reviewer_comments)))),r.createElement("div",{className:"request-actions"},r.createElement(R,{status:e.status}),r.createElement("div",{className:"request-actions-btns"},(e=>"pending"===e.status&&e.requester_id===a.accountId)(e)&&r.createElement("button",{onClick:()=>l&&l(e),className:"btn btn-ghost btn-edit",title:"Edit Request"},r.createElement(Y.A,{size:16})),(e=>("pending"===e.status||"approved"===e.status)&&e.requester_id===a.accountId)(e)&&r.createElement("button",{onClick:()=>c&&c(e),className:"btn btn-ghost btn-cancel",title:"Cancel Request"},r.createElement(B.A,{size:16}))))));var t})))):r.createElement("div",{className:"card requests-card"},r.createElement("h2",{className:"card-title"},"My PTO Requests"),r.createElement("div",{className:"requests-empty"},r.createElement(n.A,{size:48,className:"requests-empty-icon"}),r.createElement("h3",{className:"requests-empty-title"},"No PTO requests found"),r.createElement("p",null,"You haven't submitted any PTO requests yet."),r.createElement("p",{className:"requests-empty-desc"},"Go to the Calendar tab to submit your first request!")))};var J=a(7504);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function G(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){Q(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Q(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const K=e=>{let{pendingRequests:t,onApproval:a}=e;const[l,m]=(0,r.useState)({}),[i,d]=(0,r.useState)({}),u=async(e,t)=>{const r=l[e]||"";d((t=>G(G({},t),{},{[e]:!0})));try{await a(e,t,r),m((t=>G(G({},t),{},{[e]:""})))}finally{d((t=>G(G({},t),{},{[e]:!1})))}},p=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return 0===t.length?r.createElement("div",{className:"card approval-card"},r.createElement("h2",{className:"card-title"},"Pending Approvals"),r.createElement("div",{className:"approval-empty"},r.createElement(c.A,{size:48,className:"approval-empty-icon"}),r.createElement("h3",{className:"approval-empty-title"},"All caught up!"),r.createElement("p",{className:"approval-empty-desc"},"There are no pending PTO requests to approve at this time."))):r.createElement("div",{className:"card approval-card"},r.createElement("div",{className:"approval-header"},r.createElement("h2",{className:"card-title"},"Pending Approvals"),r.createElement("div",{className:"approval-pending-count"},t.length," pending")),r.createElement("div",{className:"approval-info"},r.createElement("div",{className:"approval-info-content"},r.createElement(c.A,{className:"approval-info-icon",size:20}),r.createElement("div",{className:"approval-info-text"},r.createElement("p",{className:"approval-info-title"},"Review Team PTO Requests"),r.createElement("p",null,"Review each request carefully and add comments if needed. Your decision will be sent to the employee immediately.")))),r.createElement("div",{className:"approval-list"},t.map((e=>{var t,a;return r.createElement("div",{key:e.id,className:"approval-request"},r.createElement("div",{className:"approval-request-content"},r.createElement("div",{className:"approval-avatar"},(null===(t=e.requester_name)||void 0===t?void 0:t.charAt(0))||r.createElement(o.A,{size:20})),r.createElement("div",{className:"approval-request-main"},r.createElement("div",{className:"approval-request-header"},r.createElement("div",null,r.createElement("h3",{className:"approval-request-name"},e.requester_name),r.createElement("p",{className:"approval-request-email"},e.requester_email)),r.createElement("div",{className:"approval-request-submitted"},r.createElement("div",{className:"approval-request-submitted-label"},"Submitted"),r.createElement("div",{className:"approval-request-submitted-date"},(a=e.submitted_at,new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))))),r.createElement("div",{className:"approval-request-details"},r.createElement("div",{className:"approval-request-detail"},r.createElement("span",{className:"approval-request-emoji"},I(e.leave_type)),r.createElement("div",null,r.createElement("div",{className:"approval-request-type"},e.leave_type," Leave"),r.createElement("div",{className:"approval-request-type-label"},"Type"))),r.createElement("div",{className:"approval-request-detail"},r.createElement(n.A,{className:"approval-request-detail-icon",size:20}),r.createElement("div",null,r.createElement("div",{className:"approval-request-dates"},p(e.start_date)," - ",p(e.end_date)),r.createElement("div",{className:"approval-request-dates-label"},"Date Range"))),r.createElement("div",{className:"approval-request-detail"},r.createElement(s.A,{className:"approval-request-detail-icon",size:20}),r.createElement("div",null,r.createElement("div",{className:"approval-request-duration"},e.total_days," days (",e.total_hours,"h)"),r.createElement("div",{className:"approval-request-duration-label"},"Duration")))),r.createElement("div",{className:"approval-request-reason"},r.createElement("div",{className:"approval-request-reason-content"},r.createElement(J.A,{className:"approval-request-reason-icon",size:16}),r.createElement("div",null,r.createElement("span",{className:"approval-request-reason-label"},"Reason:"),r.createElement("p",{className:"approval-request-reason-text"},e.reason)))),r.createElement("div",{className:"approval-request-comments"},r.createElement("label",{className:"approval-request-comments-label"},"Manager Comments (Optional)"),r.createElement("textarea",{value:l[e.id]||"",onChange:t=>{return a=e.id,r=t.target.value,void m((e=>G(G({},e),{},{[a]:r})));var a,r},placeholder:"Add any comments about this request...",className:"approval-request-comments-input",rows:"3"})),r.createElement("div",{className:"approval-request-actions"},r.createElement("button",{onClick:()=>u(e.id,"approved"),disabled:i[e.id],className:"btn btn-primary"},i[e.id]?r.createElement("div",{className:"approval-processing"},r.createElement("div",{className:"approval-processing-spinner"}),r.createElement("span",null,"Processing...")):r.createElement("div",{className:"approval-btn-content"},r.createElement(c.A,{size:16}),r.createElement("span",null,"Approve"))),r.createElement("button",{onClick:()=>u(e.id,"declined"),disabled:i[e.id],className:"btn btn-danger"},i[e.id]?r.createElement("div",{className:"approval-processing"},r.createElement("div",{className:"approval-processing-spinner"}),r.createElement("span",null,"Processing...")):r.createElement("div",{className:"approval-btn-content"},r.createElement("span",null,"✕"),r.createElement("span",null,"Decline")))))))}))),t.length>3&&r.createElement("div",{className:"approval-bulk-message"},r.createElement("div",null,r.createElement("p",null,"Need to approve multiple requests? Bulk actions coming soon!"))))};function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(Object(a),!0).forEach((function(t){$(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function $(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const ee=()=>{const[e,t]=(0,r.useState)(null),[a,l]=(0,r.useState)(!0),[n,s]=(0,r.useState)(null);(0,r.useEffect)((()=>{(async()=>{l(!0),s(null);try{console.log("🔍 Fetching current user...");const e=await(0,d.invoke)("getCurrentUser");if(!e.success)throw new Error(e.message||"Failed to fetch current user");{console.log("👤 User data received:",e.data);const a=await c(e.data.accountId);console.log("🛡️ Admin status check result:",a);const r=Z(Z({},e.data),{},{isAdmin:a});console.log("✅ Final user data:",r),t(r),console.log("✅ Current user loaded:",r.displayName,"isAdmin:",r.isAdmin)}}catch(e){console.error("❌ Error fetching current user:",e),s(e.message)}finally{l(!1)}})()}),[]);const c=async e=>{try{console.log("🔍 Checking admin status for account:",e);const t=await(0,d.invoke)("checkUserAdminStatus",{accountId:e});return console.log("🛡️ Admin check response:",t),t.success?(console.log("✅ Admin status result:",t.data.isAdmin),t.data.isAdmin):(console.warn("⚠️ Admin check failed:",t.message),!1)}catch(e){return console.warn("❌ Could not check admin status:",e),!1}};return{currentUser:e,loading:a,error:n,refreshUser:async()=>{l(!0);try{const e=await(0,d.invoke)("getCurrentUser");if(e.success){const a=await c(e.data.accountId),r=Z(Z({},e.data),{},{isAdmin:a});t(r),console.log("🔄 User refreshed:",r)}}catch(e){s(e.message)}finally{l(!1)}},isAdmin:(null==e?void 0:e.isAdmin)||!1}};function te(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ae(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?te(Object(a),!0).forEach((function(t){re(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):te(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function re(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const le=e=>{const[t,a]=(0,r.useState)([]),[l,n]=(0,r.useState)(!0),[s,c]=(0,r.useState)(null),m=(0,r.useCallback)((async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e){n(!0),c(null);try{console.log("📋 Fetching PTO requests with filters:",t);const e=await(0,d.invoke)("getPTORequests",t);if(!e.success)throw new Error(e.message||"Failed to fetch PTO requests");var r;a(e.data||[]),console.log("✅ Loaded ".concat((null===(r=e.data)||void 0===r?void 0:r.length)||0," PTO requests"))}catch(e){c(e.message),console.error("❌ Error fetching PTO requests:",e)}finally{n(!1)}}}),[e]),i=(0,r.useCallback)((async e=>{n(!0),c(null);try{console.log("📝 Submitting PTO request:",e);const t=await(0,d.invoke)("storePTORequest",e);if(t.success)return await m(),{success:!0,data:t.data};throw new Error(t.message||"Failed to submit PTO request")}catch(e){return c(e.message),console.error("❌ Error submitting PTO request:",e),{success:!1,message:e.message}}finally{n(!1)}}),[m]),o=(0,r.useCallback)((async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n(!0),c(null);try{console.log("✅ Updating PTO request ".concat(e," to ").concat(t));const l=await(0,d.invoke)("updatePTORequest",{requestId:e,status:t,comment:r});if(l.success)return a((a=>a.map((a=>a.id===e?ae(ae({},a),{},{status:t,reviewer_comments:r,reviewed_at:(new Date).toISOString()}):a)))),{success:!0};throw new Error(l.message||"Failed to update PTO request")}catch(e){return c(e.message),console.error("❌ Error updating PTO request:",e),{success:!1,message:e.message}}finally{n(!1)}}),[]),u=(0,r.useCallback)((async e=>{n(!0),c(null);try{console.log("🗑️ Cancelling PTO request ".concat(e));const t=await(0,d.invoke)("updatePTORequest",{requestId:e,status:"cancelled",comment:"Cancelled by user"});if(t.success)return a((t=>t.filter((t=>t.id!==e)))),{success:!0};throw new Error(t.message||"Failed to cancel PTO request")}catch(e){return c(e.message),console.error("❌ Error cancelling PTO request:",e),{success:!1,message:e.message}}finally{n(!1)}}),[]),p=(0,r.useCallback)((e=>t.filter((t=>t.requester_id===e))),[t]),v=(0,r.useCallback)((()=>t.filter((e=>"pending"===e.status))),[t]),y=(0,r.useCallback)((e=>t.filter((t=>t.status===e))),[t]),E=(0,r.useCallback)(((e,a)=>t.filter((t=>{const r=new Date(t.start_date),l=new Date(t.end_date),n=new Date(e),s=new Date(a);return r>=n&&r<=s||l>=n&&l<=s||r<=n&&l>=s}))),[t]),g=(0,r.useCallback)((async()=>{if(null==e||!e.emailAddress)return[];try{console.log("📋 Fetching pending requests for manager:",e.emailAddress);const t=await(0,d.invoke)("getPendingRequests",{managerEmail:e.emailAddress});return t.success?t.data||[]:(console.error("Failed to fetch pending requests:",t.message),[])}catch(e){return console.error("❌ Error fetching pending requests for manager:",e),[]}}),[e]);return(0,r.useEffect)((()=>{e&&m()}),[e,m]),{requests:t,loading:l,error:s,fetchRequests:m,submitRequest:i,updateRequestStatus:o,cancelRequest:u,getUserRequests:p,getPendingRequests:v,getRequestsByStatus:y,getRequestsByDateRange:E,getPendingRequestsForManager:g}},ne=()=>{var e;const[t,a]=(0,r.useState)("calendar"),[l,p]=(0,r.useState)([]),[v,y]=(0,r.useState)(null),[E,g]=(0,r.useState)(!0),[b,f]=(0,r.useState)([]),{currentUser:N,loading:h,error:w,isAdmin:q}=ee(),{requests:D,loading:O,error:T,submitRequest:x,updateRequestStatus:k,cancelRequest:S,fetchRequests:P,getUserRequests:C,getPendingRequests:_}=le(N);(0,r.useEffect)((()=>{(async()=>{if(N)try{const e=await(0,d.invoke)("getUserTeams",{userId:N.accountId});e.success&&f(e.data||[])}catch(e){console.error("Error loading user teams:",e)}})()}),[N]),(0,r.useEffect)((()=>{(async()=>{g(!0);try{console.log("🔧 Initializing PTO App with Admin Setup...");const e=await(0,d.invoke)("initializePTODatabaseWithTeamManagement");if(e.success)console.log("✅ PTO App and Admin initialized:",e.data);else{console.warn("Admin setup failed, trying regular init:",e.message);const t=await(0,d.invoke)("initializePTODatabase");if(!t.success)throw new Error(t.message)}console.log("✅ PTO App initialization complete")}catch(e){console.error("❌ App initialization failed:",e),j("Failed to initialize app: "+e.message,"error")}finally{g(!1)}})()}),[]);const j=function(e){y({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success"}),setTimeout((()=>y(null)),5e3)},U=[{id:"calendar",label:"Calendar",icon:n.A,description:"View and create PTO requests"},{id:"requests",label:"My Requests",icon:s.A,description:"View your PTO request history"},{id:"approvals",label:"Approvals",icon:c.A,description:"Approve team PTO requests"},{id:"team",label:"Team",icon:m.A,description:"Team dashboard and analytics"},...q?[{id:"admin",label:"Admin",icon:i.A,description:"Administrative functions"}]:[]],R=C(null==N?void 0:N.accountId),F=_().filter((e=>e.requester_id!==(null==N?void 0:N.accountId)));return E||h?r.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},r.createElement("div",{className:"text-center"},r.createElement("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),r.createElement("h2",{className:"text-xl font-semibold text-gray-900 mb-2"},"Initializing PTO Management"),r.createElement("p",{className:"text-gray-600"},"Setting up database and admin users..."))):w?r.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},r.createElement("div",{className:"text-center p-8 bg-white rounded-lg shadow-md"},r.createElement("div",{className:"text-red-500 mb-4"},r.createElement("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 18.5c-.77.833.192 2.5 1.732 2.5z"}))),r.createElement("h2",{className:"text-xl font-semibold text-gray-900 mb-2"},"Authentication Error"),r.createElement("p",{className:"text-gray-600 mb-4"},"Failed to load user information: ",w),r.createElement("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600"},"Retry"))):N?r.createElement("div",{className:"min-h-screen bg-gray-50"},r.createElement("header",{className:"bg-white shadow-sm border-b"},r.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},r.createElement("div",{className:"flex justify-between items-center h-16"},r.createElement("div",{className:"flex items-center space-x-3"},r.createElement("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center"},r.createElement(n.A,{size:20,className:"text-white"})),r.createElement("div",null,r.createElement("h1",{className:"text-xl font-semibold text-gray-900"},"PTO Management"))),r.createElement("div",{className:"flex items-center space-x-4"},r.createElement("div",{className:"hidden md:flex items-center space-x-4 text-sm text-gray-600"},r.createElement("div",{className:"flex items-center space-x-1"},r.createElement("div",{className:"w-2 h-2 bg-yellow-400 rounded-full"}),r.createElement("span",null,F.length," pending")),r.createElement("div",{className:"flex items-center space-x-1"},r.createElement("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),r.createElement("span",null,R.filter((e=>"approved"===e.status)).length," approved")),b.length>0&&r.createElement("div",{className:"flex items-center space-x-1"},r.createElement("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),r.createElement("span",null,b.length," teams"))),r.createElement("div",{className:"flex items-center space-x-2"},r.createElement("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-semibold relative"},(null===(e=N.displayName)||void 0===e?void 0:e.charAt(0))||r.createElement(o.A,{size:16}),q&&r.createElement("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-purple-500 rounded-full flex items-center justify-center"},r.createElement(i.A,{size:8,className:"text-white"}))),r.createElement("div",{className:"hidden sm:block"},r.createElement("div",{className:"text-sm font-medium text-gray-700 flex items-center space-x-1"},r.createElement("span",null,N.displayName),q&&r.createElement(i.A,{size:12,className:"text-purple-600"})),r.createElement("div",{className:"text-xs text-gray-500"},N.emailAddress))))))),r.createElement("nav",{className:"bg-white border-b"},r.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},r.createElement("div",{className:"flex space-x-8"},U.map((e=>{const l=e.icon,n=t===e.id;return r.createElement("button",{key:e.id,onClick:()=>a(e.id),className:"flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat(n?"admin"===e.id?"border-purple-500 text-purple-600":"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),title:e.description},r.createElement(l,{size:16}),r.createElement("span",null,e.label),"approvals"===e.id&&F.length>0&&r.createElement("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-0.5 min-w-[20px] text-center"},F.length),"admin"===e.id&&r.createElement("span",{className:"bg-purple-100 text-purple-600 text-xs rounded-full px-2 py-0.5"},"Admin"))}))))),r.createElement("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},"calendar"===t&&r.createElement(W,{events:D,onDateSelect:e=>{const t=e.toISOString().split("T")[0];p((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t].sort()))},selectedDates:l,onSubmitPTO:async e=>{try{const t={reporter:N,manager:e.manager||{accountId:"manager-default",displayName:"Manager",emailAddress:"manager@company.com"},startDate:l[0],endDate:l[l.length-1],leaveType:e.leaveType,reason:e.reason,dailySchedules:e.dailySchedules},a=await x(t);a.success?(p([]),j("PTO request submitted successfully!")):j(a.message||"Failed to submit PTO request","error")}catch(e){console.error("Error submitting PTO request:",e),j("Failed to submit PTO request","error")}}}),"requests"===t&&r.createElement(H,{requests:R,currentUser:N,onEditRequest:e=>{j("Edit functionality will be implemented soon!")},onCancelRequest:async e=>{if(window.confirm("Are you sure you want to cancel this PTO request?"))try{const t=await S(e.id);t.success?j("PTO request cancelled successfully!"):j(t.message||"Failed to cancel PTO request","error")}catch(e){console.error("Error cancelling PTO request:",e),j("Failed to cancel PTO request","error")}}}),"approvals"===t&&r.createElement(K,{pendingRequests:F,onApproval:async(e,t,a)=>{try{const r=await k(e,t,a);r.success?j("Request ".concat(t," successfully!")):j(r.message||"Failed to ".concat(t," request"),"error")}catch(e){console.error("Error updating PTO request:",e),j("Failed to ".concat(t," request"),"error")}}}),"team"===t&&r.createElement(L,{teamData:{teams:b},requests:D,currentUser:N}),"admin"===t&&q&&r.createElement(A,{currentUser:N,showNotification:j})),(O||E)&&r.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-25 flex items-center justify-center z-50"},r.createElement("div",{className:"bg-white rounded-lg p-6 flex items-center space-x-3"},r.createElement("div",{className:"w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),r.createElement("span",{className:"text-gray-700"},"Processing..."))),v&&r.createElement(u,{message:v.message,type:v.type,onClose:()=>y(null)})):r.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},r.createElement("div",{className:"text-center"},r.createElement("div",{className:"w-16 h-16 border-4 border-gray-300 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),r.createElement("p",{className:"text-gray-600"},"Loading user information...")))};console.log("PTO app initializing...");const se=async()=>{const e=document.getElementById("root");if(!e)return void console.error('Root element not found! Make sure there is a div with id="root" in your HTML.');(0,l.H)(e).render(r.createElement(r.StrictMode,null,r.createElement(ne,null))),console.log("App rendered successfully");try{await d.view.resize(),console.log("Forge iframe resized")}catch(e){console.warn("Unable to resize Forge iframe:",e)}};"complete"===document.readyState||"interactive"===document.readyState?se():document.addEventListener("DOMContentLoaded",se)}},a={};function r(e){var l=a[e];if(void 0!==l)return l.exports;var n=a[e]={exports:{}};return t[e](n,n.exports,r),n.exports}r.m=t,e=[],r.O=(t,a,l,n)=>{if(!a){var s=1/0;for(o=0;o<e.length;o++){a=e[o][0],l=e[o][1],n=e[o][2];for(var c=!0,m=0;m<a.length;m++)(!1&n||s>=n)&&Object.keys(r.O).every((e=>r.O[e](a[m])))?a.splice(m--,1):(c=!1,n<s&&(s=n));if(c){e.splice(o--,1);var i=l();void 0!==i&&(t=i)}}return t}n=n||0;for(var o=e.length;o>0&&e[o-1][2]>n;o--)e[o]=e[o-1];e[o]=[a,l,n]},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var l,n,s=a[0],c=a[1],m=a[2],i=0;if(s.some((t=>0!==e[t]))){for(l in c)r.o(c,l)&&(r.m[l]=c[l]);if(m)var o=m(r)}for(t&&t(a);i<s.length;i++)n=s[i],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(o)},a=self.webpackChunkpto_request_app=self.webpackChunkpto_request_app||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var l=r.O(void 0,[96],(()=>r(6564)));l=r.O(l)})();